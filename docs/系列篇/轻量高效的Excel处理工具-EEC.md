# ğŸš› è½»é‡é«˜æ•ˆçš„Excelå¤„ç†å·¥å…·-EEC

**è®©JAVAæ“ä½œexcelæ›´ç®€å•**

## ä»‹ç»

EECçš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è§£å†³Apache POIé«˜å†…å­˜ä¸”APIè‡ƒè‚¿çš„è¯Ÿç—…ï¼ŒEECçš„åº•å±‚å¹¶ä¸ä¾èµ–POIåŒ…ï¼Œæ‰€æœ‰çš„åº•å±‚ä»£ç å‡è‡ªå·±å®ç°ï¼Œä½¿ç”¨EECåŸºæœ¬å¯ä»¥åšåˆ°ä¸€è¡Œä»£ç å®ŒæˆExcelæ–‡ä»¶çš„è¯»å’Œå†™æ“ä½œææ˜“ä¸Šæ‰‹ã€‚

EECçš„æœ€å¤§ç‰¹ç‚¹æ˜¯**â€œè½»é‡â€**å’Œ**â€œé«˜æ•ˆ**â€ï¼Œè½»é‡ä½“ç°åœ¨åŒ…ä½“å°ã€æ¥å…¥ä»£ç é‡å°‘ä»¥åŠè¿è¡Œæ—¶æ¶ˆè€—èµ„æºå°‘ä¸‰ä¸ªæ–¹é¢ï¼Œé«˜æ•ˆæŒ‡è¿è¡Œæ•ˆç‡é«˜

+ åŒ…ä½“å°ï¼šEECå’Œå¿…è¦ä¾èµ–åŒ…å…±çº¦900K
+ æ¥å…¥ä»£ç é‡å°‘ï¼šæ— è®ºè¯»å†™å‡å¯ä»¥ä¸€è¡Œä»£ç å®ç°
+ æ¶ˆè€—èµ„æºå°‘ï¼šå•çº¿ç¨‹è®¾è®¡ï¼Œæé™è¿è¡Œå†…å­˜å°äº10M

æ ¸å¿ƒåŸç†ï¼š

+ å¯¼å‡ºå¤§æ•°æ®æ—¶ä½¿ç”¨åˆ†ç‰‡å¤„ç†
+ å•å…ƒæ ¼æ ·å¼ä»…ä½¿ç”¨ä¸€ä¸ªintå€¼æ¥ä¿å­˜ï¼Œæå¤§ç¼©å°å†…å­˜ä½¿ç”¨
+ ä½¿ç”¨è¿­ä»£æ¨¡å¼è¯»å–è¡Œå†…å®¹ï¼Œä¸ä¼šå°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥åˆ°å†…å­˜

ä¸‹é¢æ˜¯è¿­ä»£æ¨¡å¼è¯»å–æ–‡ä»¶çš„ç¤ºæ„å›¾

![68747470733a2f2f7777772e74747a65726f2e6f72672f696d616765732f706f7374732f6565632545382541372541332545362539452539302545352539422542452545372541342542412e706e67](./img/7urPzaZk-WufFtAp/68747470733a2f2f7777772e74747a65726f2e6f72672f696d616765732f706f7374732f6565632545382541372541332545-553554.png)

é‡‡ç”¨â€œpullâ€æ–¹å¼çš„å¥½å¤„æ˜¯å½“ç”¨æˆ·éœ€è¦æŸè¡Œæ•°æ®æ—¶æ‰å»è§£æå®ƒä»¬æ¥å®ç°å»¶è¿Ÿè¯»å–ã€‚

-------------------------------------------------------------------------------------------------------------------------

EECæå¤§çš„ç®€åŒ–äº†javaå¤„ç†excelæ–‡ä»¶çš„å¤æ‚æ€§ï¼Œæ— è®ºæ˜¯è¯»è¿˜æ˜¯å†™éƒ½å¯ä»¥ä½¿ç”¨ä¸€è¡Œä»£ç å®Œæˆï¼Œä½ å¯ä»¥éå¸¸å¿«é€Ÿçš„ä»POIæˆ–easyexcelåˆ‡æ¢åˆ°EECï¼Œæ¥ä¸‹æ¥å°†ä»‹ç»å¦‚ä½•å¿«é€Ÿé›†æˆEECã€‚

eecæ”¯æŒxlsxæ ¼å¼è¯»å’Œå†™ï¼Œeec-e3-supportæ”¯æŒxlsæ ¼å¼è¯»ï¼Œè¯·æŒ‰éœ€å¼•ç”¨ã€‚_å¦å¤–eec-e3-supportæ— æ³•å•ç‹¬å¼•ç”¨ï¼Œå®ƒä¾èµ–äºeec_

+ å¦‚æœä½ ä½¿ç”¨mavenæˆ–gradleç­‰ç®¡ç†å·¥å…·ï¼Œä½ å¯ä»¥åœ¨****[**<u>Search Maven</u>**](https://search.maven.org/search?q=org.ttzero) æœç´¢å…³é”®è¯`org.ttzero`æˆ–è€…`eec`æ¥æŸ¥æ‰¾æ‰€æœ‰ç‰ˆæœ¬çš„eecå’Œeec-e3-supportï¼Œå»ºè®®ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬ã€‚
+ å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ç®¡ç†å·¥å…·ï¼Œé‚£ä¹ˆä½ å¯ä»¥ [ç‚¹å‡»æ­¤å¤„](https://github.com/wangguanquan/eec/releases) ä¸‹è½½jaråŒ…ï¼Œç„¶åæ·»åŠ åˆ°classpathæ¥ä½¿ç”¨ã€‚

eecä¸eec-e3-supportç‰ˆæœ¬å…¼å®¹æ€§å¯¹ç…§å‚è€ƒ [**<u>è¿™é‡Œ</u>**](https://github.com/wangguanquan/eec/wiki/EEC%E4%B8%8EE3-support%E5%85%BC%E5%AE%B9%E6%80%A7%E5%AF%B9%E7%85%A7%E8%A1%A8)

## å¿«é€Ÿå¼€å§‹

åˆ›å»ºä¸€ä¸ª SpringBoot3 é¡¹ç›®ï¼Œ**æœ¬æ–‡ç¯å¢ƒ**ï¼šIDEA2023.1+JDK17+SpringBoot3.4.0+Maven

### å¯¼å…¥ä¾èµ–

```java
<!-- æ³¨æ„ä¸¤ä¸ªä¾èµ–çš„ç‰ˆæœ¬å¯¹ç…§å…³ç³» -->
<!-- https://mvnrepository.com/artifact/org.ttzero/eec -->
<!-- xlsxæ ¼å¼è¯»å’Œå†™ -->
<dependency>
    <groupId>org.ttzero</groupId>
    <artifactId>eec</artifactId>
    <version>0.5.20</version>
</dependency>

<!-- https://mvnrepository.com/artifact/org.ttzero/eec-e3-support -->
<!-- xlsæ ¼å¼è¯»å’Œå†™ -->
<dependency>
    <groupId>org.ttzero</groupId>
    <artifactId>eec-e3-support</artifactId>
    <version>0.5.19</version>
</dependency>
```

### hello World

```java
/**
 * å†™æ–‡ä»¶
 * ä¸€è¡Œä»£ç å®ç°excelæ–‡ä»¶çš„å†™å…¥
 * åœ¨D:\baili\test\excelæ–‡ä»¶å¤¹ä¸‹ç”Ÿæˆä¸€ä¸ªåä¸º<æ–°å»ºæ–‡ä»¶.xlsx>çš„excelæ–‡ä»¶
 * å…¶ä¸­æ·»åŠ äº†ä¸€ä¸ªç©ºçš„Sheeté¡µï¼ˆEmptySheetï¼‰
 * @throws IOException
 */
@Test
void excelRead01() throws IOException {
    String path = "D:\\baili\\test\\excel";
    new Workbook().addSheet(new EmptySheet()).writeTo(Paths.get(path));
}

/**
 * è¯»æ–‡ä»¶
 * ä¸€è¡Œä»£ç å®ç°excelæ–‡ä»¶çš„è¯»å–
 * è¯»å–D:\baili\test\excel\æ–°å»ºæ–‡ä»¶.xlsxæ–‡ä»¶
 */
@Test
void excelWrite01() {
    String path = "D:\\baili\\test\\excel\\";
    String fileName = "æ–°å»ºæ–‡ä»¶.xlsx";
    try (ExcelReader reader = ExcelReader.read(Paths.get(path.concat(fileName)))) {
        reader.sheets().flatMap(org.ttzero.excel.reader.Sheet::rows).forEach(System.out::println);
    } catch (IOException e) {
        e.printStackTrace();
    }
}
```

## å¯¼å‡ºExcel

EECç›®å‰æ”¯æŒ`SimpleSheet`ï¼Œ `ListSheet`ï¼Œ`ListMapSheet`ï¼Œ`TemplateSheet`ï¼Œ`StatementSheet`ï¼Œ`ResultSetSheet`ï¼Œ`CSVSheet`å’Œ`EmptySheet`å‡ ç§å†…ç½®çš„Worksheetï¼Œå¦‚æœä¸èƒ½æ»¡è¶³éœ€æ±‚ä½ ä¹Ÿå¯ä»¥ç»§æ‰¿å·²æœ‰çš„Worksheetæ¥æ‰©å±•ï¼Œæœ€å¸¸è§çš„å°±æ˜¯å¯¹äºå¤§æ•°æ®é‡å†™å…¥æ—¶çš„åˆ†ç‰‡å¤„ç†ï¼Œè¿™ä¸ªåœ¨åé¢ä¼šè®²åˆ°ï¼Œç›®å‰è¿˜æ˜¯ä»æœ€ç®€å•çš„ListSheetå‡ºå‘ã€‚

### å°†æ•°æ®å¯¼å‡ºåˆ°excel

æ•°æ®å¯¼å‡ºåº”è¯¥æ˜¯å¼€å‘è¿‡ç¨‹ä¸­æ¯”è¾ƒå¸¸è§çš„åŠŸèƒ½ï¼Œå¯å°±æ˜¯è¿™ç§ç®€å•åŠŸèƒ½å¦‚æœä½¿ç”¨Apache POIæ¥å¼€å‘å¯ä¸æ˜¯ä¸€ä»¶è½»æ¾çš„æ´»ï¼Œå¹¸å¥½EECå·²ç»ä¸ºæˆ‘ä»¬åšäº†å¤§é‡çš„å°è£…ï¼Œä½¿æˆ‘ä»¬å¯ä»¥åšåˆ°å¼€ç®±å³ç”¨ï¼Œä¸‹é¢ä»£ç å±•ç¤ºå¦‚ä½•å¼€å‘ç®€å•çš„å¯¹è±¡æ•°ç»„å¯¼å‡ºåŠŸèƒ½

```java
/**
 * å¯¼å‡ºå­¦ç”Ÿä¿¡æ¯
 */
public void exportStudent(List<Student> students) throws IOException {
    new Workbook("äºŒå¹´çº§å­¦ç”Ÿè¡¨") // æ–°å¢ä¸€ä¸ªWorkbookå¹¶æŒ‡å®šåç§°ï¼Œä¹Ÿå°±æ˜¯Excelæ–‡ä»¶å
    .addSheet(new ListSheet<>(students)) // æ·»åŠ ä¸€ä¸ªSheeté¡µï¼Œå¹¶æŒ‡å®šå¯¼å‡ºæ•°æ®
    .writeTo(Paths.get("F:/excel")); // æŒ‡å®šå¯¼å‡ºä½ç½®
}
```

ä»¥ä¸Š`writeTo`æ–¹æ³•æŒ‡å®šä¸€ä¸ªè¾“å‡ºä½ç½®ï¼Œä¸éœ€è¦æŒ‡å®šå…·ä½“æ–‡ä»¶åç§°ï¼Œåç§°åœ¨å®ä¾‹åŒ–Workbookæ—¶æŒ‡å®šï¼Œå¦‚æœæœªæŒ‡å®šåˆ™é»˜è®¤ä½¿ç”¨â€œæ–°å»ºæ–‡ä»¶â€åšä¸ºæ–‡ä»¶åï¼Œå¦‚æœæŒ‡å®šåˆ°å…·ä½“æ–‡ä»¶è€Œä¸æ˜¯æ–‡ä»¶å¤¹åˆ™æ›¿æ¢åŸæœ‰æ–‡ä»¶ï¼Œæ²¡æœ‰æƒé™åˆ™ä¼šæŠ›å¼‚å¸¸ã€‚å¦å¤–`writeTo`æ˜¯**ç»ˆæ­¢ç¬¦**ï¼Œè°ƒç”¨è¯¥æ–¹æ³•å°†è§¦å‘å†™æ“ä½œï¼Œåœ¨å…¶åè®¾ç½®çš„æ‰€æœ‰å±æ€§å°†ä¸ç”Ÿæ•ˆã€‚

å¦‚æœæ˜¯åšwebå¼€å‘åˆ™å¯ä»¥å°†writeToç›´æ¥è¾“å‡ºåˆ°Responseçš„Outputstreamä¸­ï¼Œå¦‚ä¸‹ä»£ç 

```java
/**
 * ç›´æ¥å°†excelè¾“å‡ºåˆ°æµ
 */
@GetMapping("/download")
public void download(HttpServletResponse response) throws IOException {
    String fileName = java.net.URLEncoder.encode("æ–°å»ºæ–‡ä»¶.xlsx", "UTF-8");
    response.setHeader(HttpHeaders.CONTENT_DISPOSITION, "attachment; filename=\"" + fileName + "\"; filename*=utf-8''" + fileName);
    // æŸ¥è¯¢æ•°æ®
    List<Student> students = studentService.list();

    new Workbook().addSheet(new ListSheet<>(students)).writeTo(response.getOutputStream()); // <- ç›´æ¥å†™åˆ°Responseæµ
}
```

### æ·»åŠ å¤šä¸ªWorksheet

EECæ˜¯é€šè¿‡`Workbook#addSheet`æ–¹æ³•æ·»åŠ Worksheetï¼Œæ·»åŠ çš„æ—¶å€™ä½ å¯ä»¥æŒ‡å®šSheetçš„åç§°ï¼Œå¦‚æœä¸æŒ‡å®šåˆ™é»˜è®¤ä½¿ç”¨`Sheet {N}`å‘½åã€‚å¯¹äºå¯¼å‡ºå¤šä¸ªSheeté¡µåªéœ€è¦å¤šè°ƒç”¨å‡ æ¬¡addSheetæ–¹æ³•å³å¯ï¼Œéå¸¸æ–¹ä¾¿ã€‚ å¦å¤–ï¼Œæ·»åŠ é¡ºåºå†³å®šå¯¼å‡ºæ—¶å„Sheeté¡ºåºï¼Œå¦‚æœæƒ³è°ƒæ•´æ­¤é¡ºåºå¯ä»¥è°ƒç”¨`Workbook#insertSheet`æ–¹æ³•æ’å…¥åˆ°æŒ‡å®šä¸‹æ ‡ï¼ˆä»0å¼€å§‹ï¼‰ï¼Œä¸æ™®é€šçš„Arrayæ“ä½œä¸€æ ·ã€‚

ä¸‹é¢ä»£ç æ¼”ç¤ºç”Ÿæˆå¤šä¸ªWorksheet

```java
new Workbook("multi-sheets")
.addSheet(new ListSheet<>("å¸å•è¡¨").setData(checksTestData()))
.addSheet(new ListSheet<>("å®¢æˆ·è¡¨").setData(customersTestData()))
.addSheet(new ListSheet<>("ç”¨æˆ·å®¢æˆ·å…³ç³»è¡¨").setData(c2CSTestData()))
.writeTo(Paths.get("F:/excel"));
```

å¯¼å‡ºæ–‡ä»¶å¦‚ä¸‹ï¼š

![1733725762457-160e4ca9-d4d3-4e87-9387-255f0c85e30b.png](./img/7urPzaZk-WufFtAp/1733725762457-160e4ca9-d4d3-4e87-9387-255f0c85e30b-237171.png)

### éšè—Sheet

å‡ºäºæŸäº›å®‰å…¨è€ƒè™‘éœ€è¦éšè—æŸä¸ªæˆ–å¤šä¸ªSheeté¡µè¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯åªéœ€è¦åœ¨å¯¹åº”çš„Sheetä¸Šè°ƒç”¨`#hidden()`æ–¹æ³•ã€‚è°ƒç”¨è¯¥æ–¹æ³•åæ•°æ®ä¾ç„¶ä¼šæ­£å¸¸å†™å‡ºï¼Œåªæ˜¯è¯¥é¡µè¢«éšè—ã€‚

ä¸‹é¢ä»£ç æ¼”ç¤ºéšè—æŸä¸ªWorksheet

```java
new Workbook("multiSheet")
.addSheet(new ListSheet<>("å¸å•è¡¨").setData(checksTestData()))
.addSheet(new ListSheet<>("å®¢æˆ·è¡¨").setData(customersTestData()).hidden()) // <- éšè—è¯¥Sheet
.addSheet(new ListSheet<>("ç”¨æˆ·å®¢æˆ·å…³ç³»è¡¨").setData(c2CSTestData()))
.writeTo(Paths.get("F:/excel"));
```

å¯¼å‡ºæ–‡ä»¶å¦‚ä¸‹ï¼Œç‚¹å‡»å³é”®é€‰æ‹©â€œå–æ¶ˆéšè—â€å°±å¯ä»¥è¿˜åŸäº†ã€‚

![1733725753850-266a098f-d109-4d2b-83e5-31d749b2d684.png](./img/7urPzaZk-WufFtAp/1733725753850-266a098f-d109-4d2b-83e5-31d749b2d684-671949.png)

### å¼ºåˆ¶å¯¼å‡ºForceExport

_ä¸ºäº†æ•°æ®å®‰å…¨_EECé»˜è®¤åªä¼šå¯¼å‡ºæ ‡è®°æœ‰`@ExcelColumn`çš„å±æ€§ï¼Œä½†æŸäº›æƒ…å†µä¸æ–¹ä¾¿åœ¨å®ä½“ä¸­åŠ å…¥æ³¨è§£æ­¤æ—¶å°±å¯ä»¥è°ƒç”¨`forceExport`æ–¹æ³•å…¨å­—æ®µå¯¼å‡ºï¼ˆæ ‡è®°äº†`@IgnroeExport`æ³¨è§£é™¤å¤–ï¼‰ã€‚

Force Exportä¼šå°†å®ä½“ä¸­æ‰€æœ‰å­—æ®µå¯¼å‡ºï¼Œè¿™æ˜¯éå¸¸å±é™©çš„åšæ³•**ä¸å»ºè®®ä½¿ç”¨**ã€‚å¦‚æœå…¶å®ƒå¼€å‘è€…æ–°å¢äº†ä¸€äº›å±æ€§ä¸”æœªæ„è¯†åˆ°forceExportåˆ™ä¼šå‡ºç°æ•°æ®æ³„æ¼é£é™©ï¼Œ**ä¸ºé˜²æ­¢æ•°æ®æ³„éœ²æ¨èæ‰‹åŠ¨æŒ‡å®šColumnï¼Œè¿™æ ·çš„è¯å³ä½¿å¯¹è±¡è¢«æ·»åŠ äº†æ•æ„Ÿå­—æ®µä¹Ÿä¸ä¼šè¢«è‡ªåŠ¨å¯¼å‡ºï¼Œé™ä½ä¸å¯é¢„æœŸé£é™©å‘ç”Ÿã€‚**

ç¤ºä¾‹ä»£ç å¦‚ä¸‹

```java
// æ‰‹åŠ¨æŒ‡å®šColumn
new Workbook().addSheet(new ListSheet<>(
    new Column("å­¦å·", "id") // "å­¦å·"ä¸ºåˆ«åå³Excelå‘ˆç°çš„è¡¨å¤´,"id"ä¸ºStudentå®ä½“ä¸­çš„å­—æ®µ
    , new Column("å§“å", "name")
    , new Column("æˆç»©", "score")
).setData(Student.randomTestData()))
.writeTo(Paths.get("F:/excel"));
```

### å…³äºè‡ªåŠ¨åˆ†é¡µ

å•ä¸ªworksheeté¡µæœ‰è¡Œæ•°ä¸Šé™ï¼Œxlsä¸Šé™ä¸º65,536ï¼Œxlsxä¸Šé™ä¸º1,048,576ï¼Œå¦‚æœæ•°æ®è¶…è¿‡è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Œéœ€è¦æ‰‹åŠ¨è¿›è¡Œæˆªå–ä¹ˆï¼Œè¿˜æ˜¯æŠ›å¼‚å¸¸ï¼Ÿ

EECæ˜¯ä¸ºå¤§æ•°æ®é‡è€Œç”Ÿï¼Œæ‰€ä»¥è‡ªç„¶è€ƒè™‘åˆ°äº†è¿™ç§æƒ…å†µï¼Œå½“æ•°æ®é‡è¶…è¿‡å•sheetä¸Šé™æ—¶ä¼šè‡ªåŠ¨è¿›è¡Œåˆ†é¡µå¤„ç†ï¼Œæ— é¡»ç”¨æˆ·é¢å¤–å¤„ç†ï¼Œè€Œå¤§å¤šæ•°åŒç±»å·¥å…·å‡æ˜¯ç›´æ¥æŠ›å¼‚å¸¸ã€‚

è‡ªåŠ¨åˆ†é¡µéƒ¨åˆ†ä»£ç è§£æ

```java
/**
 * Split worksheet data
 */
@Override
protected void paging() {
    // dataSize()æ˜¯å½“å‰ä¸€ç»„æ•°æ®å—çš„å¤§å°ï¼Œlimitæ˜¯è·å–å•ä¸ªworksheetçš„è¡Œä¸Šé™
    int len = dataSize(), limit = getRowLimit();
    // paging
    if (len + rows > limit) {
        // Reset current index
        end = limit - rows + start; // endæ˜¯æ ‡è®°dataSizeçš„æœ€åä½ç½®ï¼Œå› ä¸ºå·²ç»è¶…é™äº†æ‰€ä»¥å½“å‰é¡µåªä¼šå–æœªè¶…é™çš„æ•°æ®
        shouldClose = false;
        eof = true;
        size = limit;

        int n = id;
        for (int i = end; i < len; ) {
            @SuppressWarnings("unchecked")
            ListSheet<T> copy = getClass().cast(clone()); // å¤åˆ¶ä¸€ä¸ªæ–°çš„worksheet
            copy.start = i;
            copy.end = (i = Math.min(i + limit, len));
            copy.size = copy.end - copy.start;
            copy.eof = copy.size == limit;
            workbook.insertSheet(n++, copy); // æ’å…¥åˆ°å½“å‰worksheetåé¢
        }
        // Close on the last copy worksheet
        workbook.getSheetAt(n - 1).shouldClose = true; // å¦‚æœæ˜¯æœ€åä¸€ä¸ªåˆ†é¡µåˆ™å…³é—­
    } else {
        end = len;
        size += len;
    }
}
```

å¤§æ•°æ®é‡å¯¼å‡ºè¯·å‚è€ƒ [å¤§æ•°æ®é‡å¯¼å‡º](https://github.com/wangguanquan/eec/wiki/3-%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%87%8F%E5%AF%BC%E5%87%BA)

### å¤šè¡Œè¡¨å¤´

å¤šè¡Œè¡¨å¤´è¯·å‚è€ƒ [å¦‚ä½•è®¾ç½®å¤šè¡Œè¡¨å¤´](https://github.com/wangguanquan/eec/wiki/%E5%A6%82%E4%BD%95%E8%AE%BE%E7%BD%AE%E5%A4%9A%E8%A1%8C%E8%A1%A8%E5%A4%B4)

### å¿½ç•¥è¡¨å¤´

EECæä¾›`Sheet#ignoreHeader`æ–¹æ³•æ¥å¿½ç•¥è¡¨å¤´è¾“å‡ºï¼Œå½“ç„¶ä½ åœ¨è¡¨å¤´ä¸Šè®¾ç½®çš„ä»»ä½•ä¿¡æ¯ä¾ç„¶æœ‰æ•ˆï¼Œåªåœ¨è¾“å‡ºçš„æ—¶å€™è·³è¿‡è¡¨å¤´ï¼Œ**æ³¨æ„è¿™é‡Œæ˜¯å¿½ç•¥è¡¨å¤´ä¸æ˜¯éšè—**

```java
new Workbook("Ignore header")
.addSheet(new ListSheet<>(randomTestData()).ignoreHeader()) // <- ä½¿ç”¨#ignoreHeaderå¿½ç•¥è¡¨å¤´è¾“å‡º
.writeTo(Paths.get("F:/excel"));
```

### ç®€å•æ•°æ®ç±»å‹å¯¼å‡º

æœ‰æ—¶å€™ä»…ä»…æƒ³å¯¼å‡ºæœ€ç®€å•çš„æ•°æ®ç±»å‹ï¼Œæ¯”å¦‚Integer,Stringï¼Œå¦‚æœå®šä¹‰å®ä½“å°±æ˜¾å¾—è¿‡åº¦è®¾è®¡ï¼Œæ­¤æ—¶å¯ä»¥åƒä¸‹é¢ç¤ºä¾‹ä¸€æ ·å¯¼å…¥ç®€å•ç±»å‹

```java
List<Integer> list = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 0);
new Workbook("Integer array")
.addSheet(new SimpleSheet<>(list))
.writeTo(Paths.get("F:/excel"));
```

### æœªçŸ¥çš„æ•°æ®ç±»å‹

EECå†…ç½®å¤„ç†å¦‚ä¸‹ç±»å‹ï¼Œå¹¶æŒ‰ç…§æ–‡æœ¬å±…å·¦ï¼Œæ•°å­—å±…å³ï¼Œæ—¥æœŸ/bool/charå±…ä¸­è¾“å‡º

| String | CharSequence | int | Integer | short | Short |
| --- | --- | --- | --- | --- | --- |
| byte | Byte | long | Long | float | Float |
| double | Double | BigDecimal | boolean | Boolean | char |
| Character | java.util.Date | java.sql.Date | java.sql.Timestamp | java.sql.Time | java.time.LocalDate |
| java.time.LocalDateTime | java.time.LocalTime | | | | |

å…¶ä½™ç±»å‹å‡é»˜è®¤è°ƒç”¨`toString`æ–¹æ³•è¾“å…¥ï¼Œå¦‚æœéœ€è¦ç‰¹æ®Šå¤„ç†åˆ™å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰`ICellValueAndStyle`ç±»å¹¶è¦†å†™`unknownType`æ–¹æ³•ï¼Œç¤ºä¾‹å¦‚ä¸‹

```java
public class MyXMLCellValueAndStyle extends XMLCellValueAndStyle {

    @Override
    public void unknownType(Row row, Cell cell, Object e, Column hc, Class<?> clazz) {
        // å¦‚æœè®¤åˆ«åˆ°è‡ªå®šä¹‰æšä¸¾åˆ™è¾“å‡ºæšä¸¾descå­—æ®µ
        if (clazz == PlatformEnum.class) {
            cell.setSv(((PlatformEnum) e).getDesc());
        }
            // å…¶å®ƒæƒ…å†µé»˜è®¤å¤„ç†
        else {
            super.unknownType(row, cell, e, hc, clazz);
        }
    }
}

// æ·»åŠ Worksheetæ—¶æŒ‡å®šè‡ªå®šè®¤MyXMLCellValueAndStyleå³å¯
new Workbook()
.addSheet(new ListSheet<>(data).setCellValueAndStyle(new MyXMLCellValueAndStyle()))
.writeTo(Paths.get("F:/excel"));
```

ä»¥ä¸Šä»£ç å±•ç¤ºäº†è‡ªå®šä¹‰æšä¸¾ç±»å‹çš„ç‰¹æ®Šå¤„ç†ï¼Œå¯¹äºæ²¡æœ‰æƒé™ä¿®æ”¹(å¦‚å¯¹è±¡æ”¾åœ¨å…¬å…±çš„jaråŒ…ä¸­æˆ–è€…å¤šä¸ªå›¢é˜Ÿå…±åŒä½¿ç”¨ä¸èƒ½ä¿®æ”¹)çš„æƒ…å†µä¸‹è‡ªå®šä¹‰`ICellValueAndStyle`å°±æ˜¾å¾—ç‰¹åˆ«é‡è¦äº†ï¼Œå½“ç„¶å¦‚æœæœ‰æƒé™çš„è¯ä½ ä¹Ÿå¯ä»¥ç›´æ¥åœ¨PlatformEnumæšä¸¾å†…æ·»åŠ toStringå¹¶è¿”å›descå±æ€§ï¼Œä½†å¹¶ä¸å»ºè®®æ­¤ç±»åšæ³•

_unknownTypeçš„ä¼˜å…ˆçº§æœ€ä½_ï¼Œæ‰€ä»¥æ— æ³•åœ¨`unknownType`æ–¹æ³•ä¸­å¤„ç†Stringç­‰å†…ç½®ç±»å‹ï¼Œå¦‚æœéœ€è¦åˆ™å¯ä»¥è¦†å†™`reset`æ–¹æ³•ï¼Œåƒä¸‹é¢ç¤ºä¾‹ä¸€æ ·

```java
public class MyXMLCellValueAndStyle extends XMLCellValueAndStyle {
    @Override
    public void reset(Row row, Cell cell, Object e, Column hc) {
        // è°ƒç”¨é¢„å¤„ç†æ–¹æ³•
        preCellValue(row, cell, e, hc, hc.getClazz(), hc.processor != null);
        if (hc.processor == null) {
            cell.xf = getStyleIndex(row, hc, e);
        }
    }

    void preCellValue(Row row, Cell cell, Object e, Column hc, Class<?> clazz, boolean hasProcessor) {
        // TODO å‰ç½®å¤„ç†å†…ç½®ç±»å‹
        if (isString(clazz)) {
            cell.setSv("##" + e + "##");
            return;
        }
        // å…¶å®ƒç±»å‹èµ°åŸæ–¹æ³•
        setCellValue(row, cell, e, hc, clazz, hasProcessor);
    }
}
```

### å¯¼å‡ºå›¾ç‰‡

é»˜è®¤æƒ…å†µä¸‹EECæ€»æ˜¯ä»¥"å€¼"çš„å½¢å¼å¯¼å‡ºï¼Œå³ä½¿æ˜¯`byte[]`ä¹Ÿå°†è¿›è¡ŒtoStringåå¯¼å‡ºï¼Œæ‰€ä»¥EECæ˜¯å®‰å…¨çš„ã€‚

ä»v0.5.10å¼€å§‹æ”¯æŒå¯¼å‡ºå›¾ç‰‡ï¼ŒEECä½¿ç”¨ä»¥ä¸‹åŒæ£€æŸ¥ä»¥ä¿è¯å®‰å…¨ï¼Œé¿å…å¯æ‰§è¡Œæ–‡ä»¶ã€æœ¨é©¬ç—…æ¯’å†™å…¥Excel

1. æ£€æŸ¥åˆ—æ˜¯å¦ä»¥`Media`æ ¼å¼å¯¼å‡ºï¼Œç”¨æˆ·å¿…é¡»æ˜¾ç¤ºçš„è°ƒç”¨`writeAsMedia`æ–¹æ³•æŒ‡å®š
2. æ£€æŸ¥FILE SIGNATURESæ˜¯å¦ä¸ºç™½åå•ä¸­çš„å›¾ç‰‡æ ¼å¼ï¼Œåªæœ‰è¯†åˆ«åˆ°ç™½åå•çš„Signaturesæ‰ä¼šå†™å‡ºåˆ°excel

è¿™é‡Œçš„file signaturesæ£€æŸ¥å¹¶éç®€å•çš„æ‰©å±•ååŒ¹é…ï¼Œè€Œæ˜¯å°è¯•è§£ææ–‡ä»¶å¤´çš„å°‘é‡å­—èŠ‚è¿›è¡ŒsignaturesåŒ¹é…ï¼Œæ›´å®‰å…¨çš„é™¤äº†æ–‡ä»¶å¤´è¿˜éœ€è¦åŒ¹é…æ–‡ä»¶å°¾ï¼Œä½†å›¾ç‰‡ä¸€èˆ¬éƒ½å‡ ç™¾Kbç”šè‡³å‡ Mbä¸ºäº†æ€§èƒ½EECç‰ºç‰²äº†ç»å¯¹çš„å®‰å…¨

é»˜è®¤FILE SIGNATURESç™½åå•æ ¼å¼å¦‚ä¸‹

| æ‰©å±•å | Content-type |
| --- | --- |
| .png | image/png |
| .jpg | image/jpg |
| .gif | image/gif |
| .tiff | image/tiff |
| .bmp | image/bmp |
| .ico | image/x-ico |
| .emf | image/x-emf |
| .wmf | image/x-wmf |
| .webp | image/webp |

EECæ”¯æŒ`Path`ï¼Œ `File`ï¼Œ `URL`ï¼Œ `byte[]`ï¼Œ `ByteBuffer`ï¼Œ `InputStream`ï¼Œ `base64 image string`7ç§ç±»å‹çš„Mediaï¼Œä½ å¯ä»¥ä½¿ç”¨`Column#writeAsMedia()`æˆ–è€…`@MediaColumn`æ³¨è§£æ¥æŒ‡å®šå½“å‰åˆ—ç±»å‹ä¸º`Media`ï¼Œæ­¤æ³¨è§£è¿˜é™„åŠ äº†ä¸€ä¸ªå±æ€§`presetEffect`ç”¨äºé¢„è®¾å›¾ç‰‡æ ·å¼

ç®€å•ç¤ºä¾‹ä»£ç å¦‚ä¸‹

```java
public static class Pic {
    @ExcelColumn("åœ°å€")
    private String addr;
    @MediaColumn // æŒ‡å®šä»¥Mediaå½¢å¼å¯¼å‡º
    private String url;
}

new Workbook()
.addSheet(new ListSheet<>(randomTestData()).setRowHeight(100))
.writeTo(Paths.get("F:/excel"));
```

![1733725697312-3ed64c30-12ea-43ce-a5e7-5e5cbee47d92.png](./img/7urPzaZk-WufFtAp/1733725697312-3ed64c30-12ea-43ce-a5e7-5e5cbee47d92-284021.png)

EECæ”¯æŒExcelå†…ç½®çš„28ç§é¢„è®¾å›¾ç‰‡æ ·å¼ï¼Œå†…ç½®æ ·å¼ä½¿ç”¨`PresetPictureEffect`æšä¸¾ç±»å‹è·å–ï¼Œæšä¸¾çš„é¡ºåºä¸Excelä¸­çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œé¢„è®¾æ ·å¼å¦‚ä¸‹ï¼š

![1733725709609-bce1e9b8-a6f5-44d5-8a91-3999faed1830.png](./img/7urPzaZk-WufFtAp/1733725709609-bce1e9b8-a6f5-44d5-8a91-3999faed1830-591019.png)

ä½¿ç”¨`presetEffect`æŒ‡å®šé¢„è®¾æ ·å¼

```java
public static class Pic {
    @ExcelColumn("åœ°å€")
    private String addr;
    @MediaColumn(presetEffect = PresetPictureEffect.Rotated_White) // æŒ‡å®šä»¥Mediaå½¢å¼å¯¼å‡ºå¹¶æ·»åŠ å›¾ç‰‡æ•ˆæœ
    private String url;
}
```

![1733725723557-1463f895-a43f-4d1c-a755-9d129b092b91.png](./img/7urPzaZk-WufFtAp/1733725723557-1463f895-a43f-4d1c-a755-9d129b092b91-710192.png)

ä»¥ä¸Šæ˜¯ä¸ºæ•´åˆ—è®¾ç½®æ ·åŒçš„å›¾ç‰‡æ ·å¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰`XMLWorksheetWriter`ä¸ºæ¯åˆ—è®¾ç½®ä¸åŒæ ·å¼

```java
new Workbook()
.addSheet(new ListSheet<>(randomTestData())
          .setRowHeight(217.5).autoSize().setSheetWriter(new XMLWorksheetWriter() {
              @Override
              protected Picture createPicture(int column, int row) {
                  Picture picture = super.createPicture(column, row);
                  // æŸäº›æ•ˆæœä¼šåŠ è¾¹æ¡†ã€å€’å½±æˆ–è€…æ—‹è½¬æ‰€ä»¥è¿™é‡Œå¢åŠ paddingçš„å¤§å°ä»¥æ˜¾ç¤ºå®Œæ•´çš„æ•ˆæœ
                  picture.padding = 15 << 24 | 15 << 16 | 35 << 8 | 15;
                  PresetPictureEffect[] effects = PresetPictureEffect.values();
                  // æ·»åŠ æ•ˆæœ
                  picture.effect = effects[row - 2].getEffect();
                  return picture;
              }
          })).writeTo(Paths.get("F:/excel"));
```

å¦‚ä¸‹å›¾å±•ç¤º Aåˆ—æ˜¯æšä¸¾å€¼ï¼ŒBåˆ—æ˜¯å¯¹åº”çš„æ•ˆæœ

![1733725734160-24b896e2-e21e-493e-bce2-ff788964bcca.png](./img/7urPzaZk-WufFtAp/1733725734160-24b896e2-e21e-493e-bce2-ff788964bcca-953760.png)

PresetPictureEffectæšä¸¾ä¸­è‹±æ–‡å¯¹ç…§è¡¨

| ä¸­æ–‡ | æšä¸¾å€¼ |
| --- | --- |
| æ—  | None |
| ç®€å•æ¡†æ¶ï¼Œç™½è‰² | SimpleFrame_White |
| æ£±å°äºšå…‰ï¼Œç™½è‰² | BeveledMatte |
| é‡‘å±æ¡†æ¶ | MetalFrame |
| çŸ©å½¢æŠ•å½± | DropShadowRectangle |
| æ˜ åƒåœ†è§’çŸ©å½¢ | ReflectedRoundedRectangle |
| æŸ”åŒ–è¾¹ç¼˜çŸ©å½¢ | SoftEdgeRectangle |
| åŒæ¡†æ¶ï¼Œé»‘è‰² | DoubleFrame |
| åšé‡äºšå…‰ï¼Œé»‘è‰² | ThickMatte |
| ç®€å•æ¡†æ¶ï¼Œé»‘è‰² | SimpleFrame_Black |
| æ£±å°å½¢æ¤­åœ†ï¼Œé»‘è‰² | BeveledOval |
| å¤æ‚æ¡†æ¶ï¼Œé»‘è‰² | CompoundFrame |
| ä¸­ç­‰å¤æ‚æ¡†æ¶ï¼Œé»‘è‰² | ModerateFrame |
| å±…ä¸­çŸ©å½¢é˜´å½± | CenterShadowRectangle |
| åœ†å½¢å¯¹è§’ï¼Œç™½è‰² | RoundedDiagonalCorner |
| å‰ªå»å¯¹è§’ï¼Œç™½è‰² | SnipDiagonalCorner |
| ä¸­ç­‰å¤æ‚æ¡†æ¶ï¼Œç™½è‰² | ModerateFrame |
| æ—‹è½¬ï¼Œç™½è‰² | Rotated |
| é€è§†é˜´å½±ï¼Œç™½è‰² | PerspectiveShadow |
| æ¾æ•£é€è§†ï¼Œç™½è‰² | RelaxedPerspective |
| æŸ”åŒ–è¾¹ç¼˜æ¤­åœ† | SoftEdgeOval |
| æ£±å°çŸ©å½¢ | BevelRectangle |
| æ£±å°é€è§† | BevelPerspective |
| æ˜ åƒå³é€è§† | ReflectedPerpsectiveRight |
| æ£±å°å·¦é€è§†ï¼Œç™½è‰² | BevelPerspectiveLeft |
| æ˜ åƒæ£±å°ï¼Œé»‘è‰² | ReflectedBevel |
| æ˜ åƒæ£±å°ï¼Œç™½è‰² | ReflectedBevel_White |
| é‡‘å±åœ†è§’çŸ©å½¢ | MetalRoundedRectangle |
| é‡‘å±æ¤­åœ† | MetalOval |

**æ³¨æ„ï¼šè‡ªé€‚åº”åˆ—å®½å¯¹**`**Media**`**åˆ—æ— æ•ˆï¼Œå®ƒæ€»æ˜¯ä»¥å›ºå®šå®½åº¦æ˜¾ç¤º**

#### å…³äºå›¾ç‰‡ä¸‹è½½

è™½ç„¶EECæ”¯æŒè¿œç¨‹å›¾ç‰‡ä¸‹è½½ä½†èƒ½åŠ›è¾ƒå¼±ï¼Œå†…ç½®ä¸‹è½½å·¥å…·ä»…ä½¿ç”¨`java.net.HttpURLConnection`ç±»ï¼Œå®ƒä¸ä¼šä½¿ç”¨è¿æ¥æ± ä¹Ÿæ²¡æœ‰æ”¯æŒftpä»¥åŠèº«ä»½é‰´æƒï¼Œ æ‰€ä»¥åœ¨é›†æˆçš„è¿‡ç¨‹ä¸­å¦‚æœæœ‰å›¾ç‰‡ä¸‹è½½çš„è¯æœ€å¥½ä½¿ç”¨å·²æœ‰ä¸‹è½½å™¨ï¼Œç„¶åä½¿ç”¨InputStream,byte[]æˆ–è€…ByteBufferä¼ å…¥EECï¼Œè¿™æ ·çš„è¯ä½ å¯èƒ½éœ€è¦ä¿®æ”¹å®ä½“å¯¹ä»£ç æœ‰ä¸€å®šçš„ç ´åæ€§ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰XMLWorksheetWriter å°†ä¸‹è½½å™¨é›†æˆè¿›EECï¼Œè¿™æ ·å°±ä¸éœ€è¦ä¿®æ”¹å·²æœ‰Javaå¯¹è±¡äº†ã€‚

ä¸‹é¢å±•ç¤ºä¸€æ®µä½¿ç”¨OkHttpåšä¸ºä¸‹è½½å™¨æ›¿æ¢`java.net.HttpURLConnection`çš„ç¤ºä¾‹ï¼Œä½ å¯ä»¥ä½¿ç”¨å·²æœ‰ä»»ä½•å·¥å…·æ›¿æ¢

```java
new Workbook().addSheet(new ListSheet<>(getRemoteUrls())
            .setColumns(new Column().setWidth(20).writeAsMedia()).setRowHeight(100)
            .setSheetWriter(new XMLWorksheetWriter() {
                @Override public void downloadRemoteResource(Picture picture, String uri) throws IOException {
                    // http or https
                    if (uri.startsWith("http")) {
                        try (Response response = OkHttpClientUtil.client().newCall(new Request.Builder().url(uri).get().build()).execute()) {
                            ResponseBody body;
                            if (response.isSuccessful() && (body = response.body()) != null) {
                                downloadCompleted(picture, body.bytes());
                            }
                        } catch (IOException ex) {
                            downloadCompleted(picture, null);
                        }
                    }
                        // ftp or ftps
                    else if (uri.startsWith("ftp")) {
                        // TODO download from ftp server
                    }
                }
            })).writeTo(Paths.get("F:/excel"));
```

é€šè¿‡downloadCompletedæ–¹æ³•å‘Šè¯‰EECå›¾ç‰‡æ•°æ®å·²å‡†å¤‡å¥½ï¼Œæ­¤æ–¹æ³•ä¼šè¿›è¡Œæ–‡ä»¶ç­¾åæ£€æŸ¥é€šè¿‡åæ‰ä¼šå°†å›¾ç‰‡æ•°æ®å†™åˆ°excelä¸­å»ï¼Œåœ¨æ•è·å¼‚å¸¸ä»£ç å—ä¸­ä¼ å…¥nullå‘Šè¯‰EECä¸‹è½½å¤±è´¥ã€‚

ä¸Šé¢ä»£ç å¯ä»¥çœ‹åˆ°åªéœ€è¦åœ¨å®Œæˆä¸‹è½½åè°ƒç”¨downloadCompletedæ–¹æ³•é€šçŸ¥EECï¼Œé‚£æ˜¯å¦å¯ä»¥æ›¿æ¢ä¸ºå¼‚æ­¥ä¸‹è½½å‘¢ï¼Ÿç­”æ¡ˆæ˜¯"YES"ã€‚ä»¥ä¸Šä»£ç åªéœ€è¦å°†`#execute()`æ”¹ä¸º`#enqueue(new Callback() {}`å¹¶åœ¨onResponseå’ŒonFailureæ–¹æ³•ä¸­è°ƒç”¨downloadCompletedå³å¯å®ç°å¼‚æ­¥ä¸‹è½½ã€‚

**æ³¨æ„ï¼šç›®å‰æ¥è¯´å¼‚æ­¥ä¸‹è½½å¹¶æœªé€šè¿‡å……åˆ†æµ‹è¯•å’Œä¼˜åŒ–ï¼Œè‡³å°‘v0.5.10ç‰ˆæœ¬ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨**

## è¯»å– Excel

### åƒTXTæ–‡ä»¶ä¸€æ ·è¯»Excel

ä½¿ç”¨EECè¯»å–Excelå’Œè¯»å–æ–‡æœ¬æ–‡ä»¶ä¸€æ ·ç®€å•ï¼Œå…¶è®¾è®¡æ€è·¯å’Œ`Files.lines(Path)`ä¸€æ ·ï¼ŒEECä½¿ç”¨`ExcelReader#read`é™æ€æ–¹æ³•è¯»æ–‡ä»¶ï¼Œå…¶å†…éƒ¨é‡‡ç”¨æµå¼æ“ä½œï¼Œå½“ä½¿ç”¨æŸä¸€è¡Œæ•°æ®æ—¶æ‰ä¼šçœŸæ­£è¯»å…¥å†…å­˜ï¼Œæ‰€ä»¥å³ä½¿æ˜¯GBçº§åˆ«çš„Excelæ–‡ä»¶ä¹Ÿåªå ç”¨å°‘é‡å†…å­˜ã€‚

æˆ‘ä»¬å¯ä»¥å†™ä¸€æ®µç®€å•ç¤ºä¾‹æ¥æ¯”è¾ƒè¯»TXTæ–‡ä»¶å’ŒExcelçš„åŒºåˆ«

```java
// è¯»å–TXTæ–‡ä»¶
@Test 
public void testReadText() {
    try (Stream<String> line = Files.lines(Paths.get("F:/excel/1.txt"))) {
        // æŒ‰è¡Œè¯»å–å¹¶æ‰“å°
        line.forEach(System.out::println);
    } catch (IOException ex) {
        ex.printStackTrace();
    }
}
// è¯»å–Excel
@Test 
public void testReadExcel() {
    try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/1.xlsx"))) {
        // æŒ‰è¡Œè¯»å–ç¬¬1ä¸ªSheetå¹¶æ‰“å°
        reader.sheet(0).rows().forEach(System.out::println);
    } catch (IOException ex) {
        ex.printStackTrace();
    }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œä¸¤æ®µä»£ç å‡ ä¹ä¸€è‡´ï¼Œå¹¶ä¸”åŠŸèƒ½ä¹Ÿä¸€æ ·ï¼Œéƒ½æ˜¯æŒ‰è¡Œè¯»å–æ•°æ®å¹¶è¾“å‡ºã€‚

å¤§å¤šæ•°åœºæ™¯éƒ½éœ€è¦å°†è¡Œæ•°æ®è½¬ä¸ºå¯¹è±¡ç„¶åè¿›è¡Œå…¶å®ƒé€»è¾‘ï¼Œå…¸å‹çš„å¤„ç†æµç¨‹å¯èƒ½å¦‚ä¸‹å›¾

```plain
+------+     +--------+       +--------+      +---------+
| è¯»å–  | ->  | è¿‡æ»¤å™¨1 |  ->   | è¿‡æ»¤å™¨2 |  ->  | é€»è¾‘å¤„ç† |
+------+     +--------+       +--------+      +---------+
```

åƒè¿™ç§åœºæ™¯ä½¿ç”¨EECå°†éå¸¸è´´åˆï¼Œå› ä¸ºExcelReaderæä¾›äº†æ ‡å‡†çš„Streamæµï¼Œç¬¬ä¸€å±‚æ˜¯`Stream<Sheet>`ï¼Œç¬¬äºŒå±‚æ˜¯`Stream<Row>`ï¼Œæµå¤„ç†çš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯å°†å¤§ä»»åŠ¡æ‹†åˆ†æˆå‡ ä¸ªå°ä»»åŠ¡ã€‚

æˆ‘ä»¬å‡å®šä¸€ä¸ªåœºæ™¯ï¼Œå®ç°ä¸€ä¸ªæä¾›æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å…è®¸ç”¨æˆ·ä¸Šä¼ å•†å“æ•°æ®ï¼Œç¨‹åºè¯»å–æ–‡ä»¶åè¿›è¡Œå†…å®¹æ£€æŸ¥ï¼ˆæˆ‘å¯ä¸å¸Œæœ›ä¸Šä¼ ä¸€äº›è¿è§„çš„å†…å®¹æ±¡æŸ“æœåŠ¡å™¨ï¼‰ï¼Œæœ€åå°†æ£€æŸ¥é€šè¿‡çš„å•†å“é€šè¿‡å•†å“ä¸­å°è¿›è¡Œå•†å“ä¸Šæ¶ã€‚

è¿™æ ·çš„ç»å…¸åœºæ™¯å¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç å®ç°

```java
// å‡å®šå·²å°†æ–‡ä»¶å†™åˆ°æŸå°æœåŠ¡å™¨æˆ–OSSæœåŠ¡å™¨
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/goods.xlsx"))) {
    reader.sheet(0).dataRows()
    // å°†è¡Œæ•°æ®è½¬ä¸ºGoodså¯¹è±¡
    .map(row -> row.too(Goods.class))

    // æœ¬åœ°çš„ä¸€äº›æ£€æŸ¥ï¼Œæ£€æŸ¥ä¸€äº›å¿…å¡«é¡¹
    .filter(this::validateGoods)

    // åˆè§„æ£€æŸ¥ï¼Œæ£€æŸ¥æ–‡æœ¬æˆ–è€…å›¾ç‰‡æ˜¯å¦è¿è§„
    .filter(g -> redLineDetectService.checkText(g.getGoodsName()) && redLineDetectService.checkImage(g.getImage()))

    // è°ƒç”¨å•†å“ä¸­å°ä¸Šæ¶
    .forEach(goodsService::publish);
} catch (IOException ex) {
    ex.printStackTrace();
}
```

ä¸Šé¢ç¤ºä¾‹å±•ç¤ºäº†ä¸€ä¸ªå®Œæ•´çš„ä»è¯»å–åˆ°è¿‡æ»¤åˆ°é€»è¾‘å¤„ç†åœºæ™¯ï¼Œå…¶ä¸­çš„`sheet(0)`è¡¨ç¤ºè¯»å–ç¬¬ä¸€ä¸ªSheeté¡µï¼Œ`dataRows()`ä¼šè¯»å–ç¬¬ä¸€ä¸ªéç©ºè¡Œåšä¸ºè¡¨å¤´è§£æã€‚

### æ‰¹é‡å¤„ç†è¡Œé€»è¾‘

ä¸Šé¢çš„åœºæ™¯ç¤ºä¾‹å±•ç°äº†ç®€æ˜çš„æµå¤„ç†ï¼Œä½†one-by-oneä¸Šæ¶å¯èƒ½ä¼šæ‹–æ…¢ç³»ç»Ÿé€Ÿåº¦ï¼Œæ­¤æ—¶å°±æœ‰æ‰¹é‡å¤„ç†åœºæ™¯ï¼Œä½†æ˜¯æ ‡å‡†çš„æµä»…æä¾›å•è¡Œæ•°æ®ï¼Œåº”è¯¥å¦‚ä½•æ”¹è¿›å‘¢ï¼Ÿ

å‘ƒã€‚ã€‚ã€‚ä¸å…¶è¯´æ˜¯æ”¹è¿›ä¸å¦‚è¯´æ˜¯é€€åŒ–ï¼Œ`Sheet`æ¥å£æä¾›iteratorå’ŒdataIteratorä¸¤ç§è¿­ä»£å™¨ï¼Œå¯ä»¥ä½¿ç”¨è¿­ä»£å™¨æ”¶é›†æ•°æ®ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/goods.xlsx"))) {
    List<Goods> batch = new ArrayList<>(100);
    for (Iterator<Row> ite = reader.sheet(0).dataIterator(); ite.hasNext(); ) {
        // è¡Œæ•°æ®è½¬å¯¹è±¡
        batch.add(ite.next().to(Goods.class));
        // æ»¡100æ¡æ‰¹é‡ä¸Šæ¶
        if (batch.size() >= 100) {
            goodsService.batchPublish(batch);
            batch.clear();
        }
    }
    // ä¸Šæ¶å‰©ä½™å•†å“
    if (!batch.isEmpty()) {
        goodsService.batchPublish(batch);
    }
} catch (IOException ex) {
    ex.printStackTrace();
}
```

ä½ æ— éœ€æ‹…å¿ƒOOMï¼Œå› ä¸ºIteratorä¾ç„¶æ˜¯æŒ‰éœ€åŠ è½½æ•°æ®ï¼Œå†…å­˜æ¶ˆè€—ä¸Streamç›¸å½“ã€‚

### è·å–æ–‡ä»¶åŒ…å«å¤šå°‘è¡Œ

EECå¹¶ä¸æä¾›è·å–æ€»è¡Œæ•°çš„æ–¹æ³•ï¼ˆæœ‰ä¸€ä¸ªè¢«æ ‡è®°ä¸ºè¿‡æ—¶çš„`Sheet#getSize`æ–¹æ³•ç›®å‰ä»ç„¶å¯ä»¥ä½¿ç”¨ï¼‰ï¼Œæ¨èä½¿ç”¨`Sheet#getDimension`æ–¹æ³•æ›¿æ¢ï¼Œè¯¥æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ª`Dimension`å¯¹è±¡åŒ…å«`firstRow` `lastRow` `firstColumn` `lastColumn`4ä¸ªå±æ€§ï¼Œç»†å¿ƒçš„ä½ ä¸€å®šå‘ç°äº†è¿™4ä¸ªå±æ€§å°†å®šä½æ•´ä¸ªæ–‡æ¡£çš„æœ‰æ•ˆèŒƒå›´ã€‚ å–æœ‰æ•ˆæ•°æ®è¡Œæ•°å¯ä»¥é€šè¿‡è®¡ç®—`dimension.lastRow - dimension.firstRow + 1`å¾—åˆ°ã€‚

å¯¹äºæ ‡å‡†çš„Office Open XMLæ¥è¯´è¯¥èŒƒå›´å€¼è¢«å†™åˆ°äº†å„worksheetçš„å¤´éƒ¨ï¼Œå¤§è‡´åƒè¿™æ ·`<dimension ref="A1:F10"/>`ï¼Œæ‰€ä»¥æ ‡å‡†çš„Excelå¯ä»¥å¿«é€Ÿè·å¾—ã€‚ ä½†æ˜¯å¹¶éæ‰€æœ‰å·¥å…·éƒ½é‡‡ç”¨Officeæ ‡å‡†ï¼Œæ¯”å¦‚POIå¯¼å‡ºçš„æ–‡ä»¶å°±ä¸ä¼šå†™æ­¤å±æ€§ï¼Œè¯»å–è¿™ç±»æ–‡ä»¶EECåšå¦‚ä¸‹å¤„ç†ï¼šå°†æŒ‡é’ˆæŒ‡å‘æ–‡ä»¶æœ«å°¾ï¼Œç„¶åè¯»å–æœ€åä¸€ä¸ªå•å…ƒæ ¼çš„èŒƒå›´ï¼Œå°†æ­¤èŒƒå›´åšä¸ºæœ‰æ•ˆæ•°æ®èŒƒå›´ï¼Œè¿™æœ‰å¯èƒ½å¯¼è‡´åˆ—èŒƒå›´ä¸å‡†ç¡®çš„é—®é¢˜ã€‚

æ€»çš„æ¥è¯´è·å–æ–‡ä»¶èŒƒå›´çš„æ—¶é—´å¤æ‚åº¦è¶‹è¿‘äºO(1)ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯**æ­¤å±æ€§å¹¶éå¯ä¿¡ä»»**çš„ï¼Œæœ€å¥½ä¸è¦åœ¨ä»£ç ä¸­ä½¿ç”¨æ­¤å€¼åšå¼ºæ£€éªŒ

v0.5.11å¼€å§‹å¹¶ä¸ä¼šè§£å‹åŸå§‹æ–‡ä»¶ï¼Œæ‰€ä»¥æ— æ³•ç”¨ä¸Šé¢çš„æ–¹æ³•å°†æŒ‡é’ˆç§»åˆ°æ–‡ä»¶æœ«å°¾ä»¥å¿«é€Ÿè·å–æœ€åä¸€ä¸ªå•å…ƒæ ¼èŒƒå›´ï¼Œè°ƒç”¨`Sheet#getDimension`æ–¹æ³•å°†ä»å¤´å¼€å§‹åŒ¹é…å•å…ƒæ ¼èŒƒå›´æ‰€ä»¥æ­¤æ–¹æ³•å°†æ¶ˆè€—æ›´å¤šçš„æ—¶é—´

### åå¤è¯»å–

Sheetæä¾›`reset`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šé‡ç½®ä½ç½®åˆ°æ–‡ä»¶å¤´ï¼Œä»è€Œèµ·åˆ°åå¤è¯»å–æ•ˆæœï¼Œè¯¥æ–¹æ³•å¹¶ä¸ä¼šäºŒæ¬¡è§£å‹æ–‡ä»¶ä¹Ÿä¸ä¼šæ¸…é™¤SharedStringå’Œæ–‡ä»¶èŒƒå›´ç­‰åŸºç¡€ä¿¡æ¯ï¼Œæ‰€ä»¥ç†è®ºä¸Šä¼šæ¯”ç¬¬ä¸€æ¬¡å¿«ã€‚çœ‹ä¸Šå»åƒæ˜¯ä¸€ä¸ªå¾ˆ2çš„åŠŸèƒ½ï¼Œä½†æ˜¯æŸäº›æƒ…å†µä¾ç„¶æœ‰ç”¨ï¼Œæ¯”å¦‚å¤§æ–‡ä»¶éœ€è¦æ£€æŸ¥æŸä¸ªåˆ—æ˜¯å¦å‡ºç°é‡å¤å€¼ï¼Œæ£€æŸ¥å®Œåå†é€»è¾‘å¤„ç†ï¼Œ å› ä¸ºæ–‡ä»¶å¤ªå¤§æˆ‘ä»¬æ— æ³•å°†æ•°æ®ä¸€æ¬¡è¯»åˆ°å†…å­˜å†æ£€æŸ¥é‡å¤å’Œé€»è¾‘å¤„ç†ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨resetåšä¸¤æ¬¡è¯»æ–‡ä»¶æ“ä½œ

```java
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/large-goods.xlsx"))) {
    Sheet sheet = reader.sheet(0);
    Dimension dimension = sheet.getDimension();
    // è¿™é‡Œæ²¡æœ‰+1ï¼Œå› ä¸ºè¡¨å¤´å ä¸€è¡Œ
    int maxRow = dimension.lastRow - dimension.firstRow;
    long count = sheet.dataRows().map(row -> row.getString("å•†å“ç¼–ç ")).distinct().count(); // <- ä½¿ç”¨distinctå»é™¤é‡å¤å•†å“ç¼–ç 
    // å¦‚æœå»é‡åçš„ç»“æœå°äºåŸå§‹ç»“æœè¯´æ˜æœ‰é‡å¤
    if (count < maxRow) {
        throw new IllegalArgumentException("åŒ…å«é‡å¤å•†å“ç¼–ç ");
    }

    // é‡ç½®
    sheet.reset();

    // å’Œä¸Šé¢çš„ä¾‹å­ä¸€æ ·å¤„ç†é€»è¾‘å³å¯
    sheet.dataRows().map(row -> row.to(Goods.class)).forEach(goodsService::publish);
} catch (IOException ex) {
    ex.printStackTrace();
}
```

### æŒ‡å®šè¡¨å¤´ä½ç½®

ä»v0.5.6å¼€å§‹EECæ”¯æŒæŒ‡å®šè¡¨å¤´ä½ å¯ä»¥é€šè¿‡`Sheet#header(fromRowNum, toRowNum)`æ¥æŒ‡å®šè¡¨å¤´çš„ä½ç½®ï¼Œå¦‚ä¸Šé¢å®ä¾‹ä¸­ç¬¬7è¡Œä¸ºè¡¨å¤´ï¼Œåˆ™å¯ä»¥ä½¿ç”¨

```java
List<Goods> list = reader.sheet(0).reset()
.header(7) // æŒ‡å®šç¬¬7è¡Œä¸ºè¡¨å¤´
.rows().map(row -> row.to(Goods.class)).collect(Collectors.toList());
```

### JDBCå¼è¯»å–

é™¤äº†ä¸Šé¢ä½¿ç”¨`row#to`æˆ–è€…`rot#too`æ–¹å¼å°†è¡Œæ•°æ®ç›´æ¥è½¬å¯¹è±¡å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç±»ä¼¼äºJDBCæ–¹å¼æ›´åŸå§‹çš„è·å–å•å…ƒæ ¼çš„å€¼ï¼Œè¿™ç§æ›´åº•å±‚çš„æ–¹å¼åœ¨å¤æ‚ç¯å¢ƒä¸­å°¤ä¸ºæœ‰æ•ˆï¼Œæ¯”å¦‚å¤šè¡Œè¡¨å¤´æˆ–è€…éè¡¨æ ¼è¯»å–

```java
List<O> list = reader.sheet(0).rows().map(row -> {
    // ... å…¶å®ƒè§£æ
    O o = new O();
    o.total = row.getInt(0);       // è·å–æ€»è®¡
    o.formula = row.getFormula(0); // è·å–è®¡ç®—æ€»è®¡çš„å…¬å¼
    return o;
}).collect(Collectors.toList());
```

### è¡Œè½¬Map

v0.5.6 Rowæä¾›toMapæ–¹æ³•å°†è¡Œæ•°æ®è½¬ä¸ºå­—å…¸ç±»å‹ï¼Œä¸ºä¿è¯åˆ—é¡ºåºå®é™…è¿”å›ç±»å‹ä¸ºLinkedHashMapï¼Œå¦‚æœä½¿ç”¨`Sheet#dataRows`æˆ–`Sheet#header`æŒ‡å®šè¡¨å¤´åˆ™å­—å…¸çš„Keyä¸ºè¡¨å¤´æ–‡æœ¬ï¼ŒValueä¸ºè¡¨å¤´å¯¹åº”çš„åˆ—å€¼ï¼Œ å¦‚æœæœªæŒ‡å®šè¡¨å¤´é‚£å°†ä»¥åˆ—ç´¢å¼•åšä¸ºKeyï¼Œä¸å¯¼å‡ºæŒ‡å®šçš„colIndexä¸€æ ·ç´¢å¼•ä»0å¼€å§‹ã€‚å¯¹äºå¤šè¡Œè¡¨å¤´å­—å…¸Keyå°†ä»¥`è¡Œ1:è¡Œ2:è¡Œn`çš„æ ¼å¼è¿›è¡Œæ‹¼æ¥ï¼Œæ¨ªå‘åˆå¹¶çš„å•å…ƒæ ¼å°†è‡ªåŠ¨å°†å€¼å¤åˆ¶åˆ°æ¯ä¸€åˆ—ï¼Œè€Œçºµå‘åˆå¹¶çš„å•å…ƒæ ¼åˆ™ä¸ä¼šå¤åˆ¶

å…³äºå•å…ƒæ ¼ç±»å‹çš„ç‰¹æ®Šè¯´æ˜ï¼šè¡Œæ•°æ®è½¬å¯¹è±¡æ—¶ä¼šæ ¹æ®å¯¹è±¡å®šä¹‰è¿›è¡Œä¸€æ¬¡ç±»å‹è½¬æ¢ï¼Œå°†å•å…ƒæ ¼çš„å€¼è½¬ä¸ºå¯¹è±¡å®šä¹‰ä¸­çš„ç±»å‹ï¼Œä½†æ˜¯è½¬ä¸ºå­—å…¸æ—¶å´ä¸ä¼šæœ‰è¿™ä¸€æ­¥ é€»è¾‘ï¼Œç±»å‹æ˜¯æ ¹æ®excelä¸­çš„å€¼è¿›è¡Œç²—ç²’åº¦è½¬æ¢ï¼Œä¾‹å¦‚æ•°å­—ç±»å‹å¦‚æœå¸¦æœ‰æ—¥æœŸæ ¼å¼åŒ–åˆ™ä¼šè¿”å›ä¸€ä¸ªTimestampç±»å‹ï¼Œ æ‰€ä»¥æœ€ç»ˆçš„æ•°æ®ç±»å‹å¯èƒ½ä¸é¢„æœŸæœ‰æ‰€ä¸åŒ

æœ‰å¦‚ä¸‹Excelæ–‡ä»¶

 ![1734069849287-2e2590c3-bdb3-4d18-a9ce-f88672bd5622.jpeg](./img/7urPzaZk-WufFtAp/1734069849287-2e2590c3-bdb3-4d18-a9ce-f88672bd5622-390216.jpeg)

ä½¿ç”¨toMapæ–¹æ³•ç¤ºä¾‹

ä¸æŒ‡å®šè¡¨å¤´è¡Œå°†åˆ—ç´¢å¼•å°†åšä¸ºKey

```java
reader.sheet(0).asMergeSheet()
.rows().map(org.ttzero.excel.reader.Row::toMap).forEach(System.out::println);

// æ§åˆ¶å°è¾“å‡º
{0=å§“å, 1=æ€§åˆ«, 2=è¯ä¹¦, 3=è¯ä¹¦, 4=è¯ä¹¦, 5=å¹´é¾„, 6=æ•™è‚², 7=æ•™è‚²}
{0=å§“å, 1=æ€§åˆ«, 2=ç¼–å·, 3=ç±»å‹, 4=ç­‰çº§, 5=å¹´é¾„, 6=æ•™è‚²1, 7=æ•™è‚²2}
{0=æš—æœˆæœˆ, 1=ç”·, 2=1, 3=æ•°å­¦, 4=3, 5=30, 6=æ•™è‚²a, 7=æ•™è‚²b}
{0=æš—æœˆæœˆ, 1=ç”·, 2=2, 3=è¯­æ–‡, 4=1, 5=30, 6=æ•™è‚²a, 7=æ•™è‚²c}
{0=æš—æœˆæœˆ, 1=ç”·, 2=3, 3=å†å², 4=1, 5=30, 6=æ•™è‚²b, 7=æ•™è‚²c}
{0=å¼ ä¸‰, 1=å¥³, 2=1, 3=è‹±è¯­, 4=1, 5=20, 6=æ•™è‚²d, 7=æ•™è‚²d}
{0=å¼ ä¸‰, 1=å¥³, 2=5, 3=ç‰©ç†, 4=7, 5=20, 6=æ•™è‚²x, 7=æ•™è‚²x}
{0=æå››, 1=ç”·, 2=2, 3=è¯­æ–‡, 4=1, 5=24, 6=æ•™è‚²c, 7=æ•™è‚²a}
{0=æå››, 1=ç”·, 2=3, 3=å†å², 4=1, 5=24, 6=æ•™è‚²b, 7=æ•™è‚²c}
{0=ç‹äº”, 1=ç”·, 2=1, 3=é«˜æ•°, 4=2, 5=28, 6=æ•™è‚²c, 7=æ•™è‚²a}
{0=ç‹äº”, 1=ç”·, 2=2, 3=JAvA, 4=3, 5=28, 6=æ•™è‚²b, 7=æ•™è‚²c}
```

æŒ‡è¡¨å¤´æ—¶ä»¥è¡¨å¤´è¡Œåšä¸ºKey

```java
reader.sheet(0).header(1, 2).rows().map(org.ttzero.excel.reader.Row::toMap).forEach(System.out::println);

// æ§åˆ¶å°è¾“å‡º
æ³¨æ„æ­¤å¤„ â†“ æ‹¼æ¥"è¯ä¹¦:ç±»å‹"åšä¸ºè¡¨å¤´
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=æ•°å­¦, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²b}
{å§“å=, æ€§åˆ«=, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²c} // <- æ³¨æ„æ­¤è¡Œ
{å§“å=, æ€§åˆ«=, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c} // <- æ³¨æ„æ­¤è¡Œ
{å§“å=å¼ ä¸‰, æ€§åˆ«=å¥³, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=è‹±è¯­, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=20, æ•™è‚²:æ•™è‚²1=æ•™è‚²d, æ•™è‚²:æ•™è‚²2=æ•™è‚²d}
{å§“å=, æ€§åˆ«=, è¯ä¹¦:ç¼–å·=5, è¯ä¹¦:ç±»å‹=ç‰©ç†, è¯ä¹¦:ç­‰çº§=7, å¹´é¾„=, æ•™è‚²:æ•™è‚²1=æ•™è‚²x, æ•™è‚²:æ•™è‚²2=æ•™è‚²x}
{å§“å=æå››, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=24, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=, æ€§åˆ«=, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
{å§“å=ç‹äº”, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=é«˜æ•°, è¯ä¹¦:ç­‰çº§=2, å¹´é¾„=28, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=, æ€§åˆ«=, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=JAvA, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
```

ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°é™¤è¡¨å¤´å¤–æ‰€æœ‰åˆå¹¶çš„å•å…ƒæ ¼åªæœ‰ç¬¬1ä¸ªå•å…ƒæ ¼æœ‰å€¼å…¶å®ƒå•å…ƒæ ¼å‡ä¸ºNULLï¼Œè‹¥è¦ä½¿åˆå¹¶å•å…ƒæ ¼çš„å…¶å®ƒåˆå¹¶é¡¹ä¹Ÿæœ‰å€¼å¯ä»¥å°†Sheetè½¬ä¸ºMergedSheetå³å¯ã€‚

```java
reader.sheet(0).asMergeSheet() // <- è½¬ä¸ºMergedSheet
.header(1, 2).rows().map(org.ttzero.excel.reader.Row::toMap).forEach(System.out::println);

// æ§åˆ¶å°è¾“å‡º
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=æ•°å­¦, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²b}
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²c} // <- æ³¨æ„æ­¤è¡Œ
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c} // <- æ³¨æ„æ­¤è¡Œ
{å§“å=å¼ ä¸‰, æ€§åˆ«=å¥³, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=è‹±è¯­, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=20, æ•™è‚²:æ•™è‚²1=æ•™è‚²d, æ•™è‚²:æ•™è‚²2=æ•™è‚²d}
{å§“å=å¼ ä¸‰, æ€§åˆ«=å¥³, è¯ä¹¦:ç¼–å·=5, è¯ä¹¦:ç±»å‹=ç‰©ç†, è¯ä¹¦:ç­‰çº§=7, å¹´é¾„=20, æ•™è‚²:æ•™è‚²1=æ•™è‚²x, æ•™è‚²:æ•™è‚²2=æ•™è‚²x}
{å§“å=æå››, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=24, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=æå››, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=24, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
{å§“å=ç‹äº”, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=é«˜æ•°, è¯ä¹¦:ç­‰çº§=2, å¹´é¾„=28, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=ç‹äº”, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=JAvA, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=28, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
```

### isEmptyä¸isBlankçš„åŒºåˆ«

v0.5.6æä¾›äº†æ–°çš„ç©ºå•å…ƒæ ¼åˆ¤æ–­æ–¹æ³•`Row#isBlank`ï¼Œè¯¥æ–¹æ³•ä¸åŸæœ‰çš„`Row#isEmpty`çš„åŒºåˆ«åœ¨äº`isEmpty`çš„åˆ¤æ–­é€»è¾‘æ˜¯åªè¦åŒ…å«å€¼å’Œæ ·å¼ï¼ˆæ ¼å¼åŒ–/è¾¹æ¡†/å¡«å……/å­—ä½“/å¯¹é½ç­‰ï¼‰çš„ä»»ä½•ä¸€æ ·éƒ½ä¼šåˆ¤å®šä¸º`å¦`ï¼Œè€Œ`isBlank`ä»…åˆ¤æ–­å•å…ƒæ ¼çš„å€¼ã€å€¼ã€å€¼ï¼Œåªè¦å•å…ƒæ ¼æ— å€¼åˆ™åˆ¤å®šä¸º`æ˜¯`

æ•ˆæœå¦‚ä¸‹å›¾æ‰€ç¤º

![1734069868949-e6464a78-4340-489e-a545-0edf11c002bb.jpeg](./img/7urPzaZk-WufFtAp/1734069868949-e6464a78-4340-489e-a545-0edf11c002bb-990962.jpeg)

### è¯»å–è¡Œå·

ä½ å¯ä»¥ä½¿ç”¨`Row#getRowNum`æ–¹æ³•æˆ–è€…ä½¿ç”¨`@RowNum`æ³¨è§£æ¥è·å–åŸå§‹æ–‡ä»¶è¡Œå·ï¼Œä¸ä½ æ‰“å¼€Excelæ‰€è§ä¸€æ ·æ­¤è¡Œå·ä»1å¼€å§‹

### é¢å¤–å±æ€§

v0.5.11æ”¯æŒæŒ‡å®šé¢å¤–å±æ€§ä»¥ä¸°å¯ŒRowè½¬å¯¹è±¡æ—¶çš„åˆ—åŒ¹é…ï¼Œç›®å‰æ”¯æŒçš„å±æ€§æœ‰`Force Import`(æ— ExcelColumnæ³¨è§£å¼ºåˆ¶åŒ¹é…), `Ignore Case`(å¿½ç•¥å¤§å°å†™)å’Œ`Camel Case`(ä¸‹åˆ’çº¿è½¬é©¼å³°)ä¸‰ç§å±æ€§ï¼Œ_å±æ€§é—´å¯ä»¥è‡ªç”±ç»„åˆ_

```java
reader.sheet(0)
.forceImport()             // <- æ²¡æœ‰ExcelColumnæ³¨è§£çš„åˆ—ä½¿ç”¨field nameåŒ¹é…
.headerColumnIgnoreCase()  // <- å¿½ç•¥å¤§å°å†™åŒ¹é…
.headerColumnToCamelCase() // <- ä¸‹åˆ’çº¿è½¬é©¼å³°åŒ¹é…
.dataRows().map(row -> row.to(U.class))
.collect(Collectors.toList());
```

### xlsxå’Œxlsæ ¼å¼

å¤§å®¶åº”è¯¥å¯¹POIè¯»å–xlså’Œxlsxä¸¤ç§æ ¼å¼éœ€è¦ä¸¤å¥—APIå¹¶ä¸é™Œç”Ÿå§ï¼ŒPOIå¤„ç†xlsæ¶ˆè€—å†…å­˜æå¤§ï¼Œå¾€å¾€è¯»å‡ MBçš„æ–‡ä»¶å°±éœ€è¦ä¸Šç™¾MBå†…å­˜ã€‚ EECç»Ÿä¸€äº†ä¸¤ç§æ ¼å¼çš„APIï¼Œæ¢å¥è¯è¯´ä½ ä¸éœ€è¦å…³å¿ƒè¯¥æ–‡ä»¶æ˜¯xlsè¿˜æ˜¯xlsxï¼Œè¯»å–æ—¶EECæ ¹æ®æ–‡ä»¶å¤´æ¥åˆ¤æ–­æ ¼å¼ï¼Œç„¶åé€‰æ‹©ä½¿ç”¨ä½•ç§æ–¹å¼è§£ææ–‡ä»¶ã€‚EECè¯»å–xlsæ¶ˆè€—æå°çš„å†…å­˜ï¼Œæé™æµ‹è¯•çº¦**1G**çš„100ä¸‡è¡Œxlsæ–‡ä»¶ï¼Œä½¿ç”¨Easyexceléœ€è¦çº¦**5G**å†…å­˜ï¼Œè€ŒEECä»…éœ€è¦**7MB**å†…å­˜ã€‚

æˆ‘åˆ†åˆ«å¯¹EECå’ŒEasyexcelè¿›è¡Œäº†æé™å†…å­˜æµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯è·‘å®Œæµ‹è¯•ä¸æŠ›å¼‚å¸¸æ—¶çš„æœ€å°å†…å­˜ï¼Œç»“æœå¦‚ä¸‹ã€‚

| æè¿° | 1w/6.9M | 5w/35M | 10w/71M | 50w/487M | 100w/978M |
| --- | --- | --- | --- | --- | --- |
| EEC | 3M | 3M | 3M | 5M | 7M |
| POI | 50M | 220M | 440M | 2400M | 5000M |

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºéšç€æ–‡ä»¶é€æ¸å¢å¤§POIæ‰€éœ€å†…å­˜ä¹Ÿé€æ¸å¢å¤§ï¼Œè¯»å–æ–‡ä»¶æ‰€éœ€çš„å†…å­˜ç”šè‡³è¿œè¿œè¶…è¿‡æ–‡ä»¶æœ¬èº«çš„å¤§å°ï¼Œè€ŒEECè¯»æ–‡ä»¶æ‰€éœ€å†…å­˜ä¸€ç›´æ¯”è¾ƒå¹³ç¨³ä¸”è¿œä½äºPOIï¼ŒåŸºæœ¬å¯ä»¥åœ¨10MBä¸‹å®Œæˆå¤§æ–‡ä»¶è¯»å–ã€‚

## å¤§æ•°æ®é‡å¯¼å‡º

å‰é¢å·²ç»å±•ç¤ºäº†ç®€å•çš„å¯¼å‡ºç¤ºä¾‹ï¼Œä¾‹å­ä¸­å¤§éƒ¨åˆ†éƒ½ä¼ å…¥ä¸€ä¸ªæ•°ç»„ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“å¯¹äºåä¸‡çº§ã€ç™¾ä¸‡çº§çš„æ•°é‡ï¼Œä¸å¯èƒ½ä¸€æ¬¡æ‹‰å–åˆ°å†…å­˜ï¼Œæ­¤æ—¶**åˆ†ç‰‡**åŠŸèƒ½å°±çªç°ä»·å€¼äº†ã€‚

### è‡ªåŠ¨åˆ†ç‰‡

ListSheetå’ŒListMapSheeté»˜è®¤æ”¯æŒåˆ†ç‰‡ï¼Œæˆ‘ä»¬åªéœ€è¦è¦†å†™`protected List<T> more()`æ–¹æ³•å³å¯ã€‚

ä¸‹é¢ä»£ç å°†å±•ç¤ºå¦‚ä½•åˆ†é¡µæ‹‰å–å­¦ç”Ÿæ•°æ®ï¼Œæ¯æ¬¡æ‹‰å–1024æ¡æ•°æ®ï¼Œè¿™æ ·å†…å­˜ä¸­æœ€å¤šä¹Ÿå°±1024æ¡æ•°æ®ï¼Œè¾¹å†™è¾¹æ‹‰å–æ•°æ®ï¼Œç›´åˆ°è¿”å›ç©ºæ•°ç»„æˆ–è€…nullã€‚

```java
new Workbook().addSheet(new ListSheet<Student>() {
    private int pageNo = 0, limit = 1024;
    @Override
    protected List<Student> more() {
        return service.getPageData(++pageNo, limit);
    }
}).writeTo(Paths.get("F:/excel"));
```

å¾—ç›ŠäºEECçš„Worksheeté»˜è®¤åˆ†é¡µï¼Œæˆ‘ä»¬æ— éœ€æ›´å¤šçš„å¤„ç†ï¼Œä¸Šé¢ä»£ç å³å¯æ”¯æŒç™¾ä¸‡çº§ã€åƒä¸‡çº§æ•°æ®å¯¼å‡º

å¦‚ä¸‹ä»£ç æµ‹è¯•200wéšæœºæ•°å­—å¯¼å‡ºçš„ç¤ºä¾‹

```java
// å¯¼å‡º200wæ•°æ®
final int loop = 2000;
new Workbook("200w").addSheet(new ListSheet<E>() {
    int n = 0; // é¡µç 
    @Override
    public List<E> more() {
        return n++ < loop ? data() : null;
    }
}).writeTo(Paths.get("F:/excel"));

// ç”Ÿæˆæµ‹è¯•æ•°æ®
public List<E> data() {
    List<E> list = new ArrayList<>(1000);
    for (int i = 0; i < 1000; i++) {
        E e = new E();
        list.add(e);
        e.nv = random.nextInt();
        e.str = getRandomString();
    }
    return list;
}

// æµ‹è¯•å¯¹è±¡
public static class E {
    @ExcelColumn
    private int nv;
    @ExcelColumn
    private String str;
}
```

æ‰“å¼€æ–‡ä»¶æ•ˆæœå¦‚ä¸‹:

ç¬¬ä¸€é¡µå…±å†™å…¥1048576è¡Œï¼Œè¿™ä¹Ÿæ˜¯xlsxæ ¼å¼å•é¡µæœ€å¤§è¡Œæ•°

![1734069826070-7aa3ce75-cdce-4efa-bd5f-398f69a2ad3f.jpeg](./img/7urPzaZk-WufFtAp/1734069826070-7aa3ce75-cdce-4efa-bd5f-398f69a2ad3f-021086.jpeg)

å†™æ»¡ç¬¬ä¸€é¡µåè‡ªåŠ¨æ–°å¢ä¸€ä¸ªworksheetå¹¶å†™å…¥å‰©ä½™æ•°æ®951426ï¼Œå…±è®¡200w+2ï¼ˆ2ä¸ªè¡¨å¤´ï¼‰

![1733743986010-4998cf54-184e-44af-a506-32e195bb0ea8.jpeg](./img/7urPzaZk-WufFtAp/1733743986010-4998cf54-184e-44af-a506-32e195bb0ea8-109529.jpeg)

### ä½¿ç”¨data-supplieræ‹‰å–æ•°æ®

v0.5.14ç‰ˆæœ¬æ–°å¢data-supplierå‡åŒ–äº†åˆ†ç‰‡å¼€å‘éš¾åº¦ï¼Œå®ƒè¢«å®šä¹‰ä¸º`BiFunction<Integer, T, List<T>>`å…¶ä¸­ç¬¬ä¸€ä¸ªå…¥å‚`Integer`è¡¨ç¤ºå·²æ‹‰å–æ•°æ®çš„è®°å½•æ•°ï¼Œ ç¬¬äºŒä¸ªå…¥å‚`T`è¡¨ç¤ºä¸Šä¸€æ‰¹æ•°æ®ä¸­æœ€åä¸€ä¸ªå¯¹è±¡ï¼Œä¸šåŠ¡ç«¯å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå‚æ•°æ¥è®¡ç®—ä¸‹ä¸€æ‰¹æ•°æ®åº”è¯¥ä»å“ªä¸ªèŠ‚ç‚¹å¼€å§‹æ‹‰å–ï¼Œ é€šå¸¸ä½ å¯ä»¥ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°é™¤ä»¥æ¯æ‰¹æ‹‰å–çš„æ•°æ®å¤§å°æ¥ç¡®å®šå½“å‰é¡µç ï¼Œå¦‚æœæ•°æ®å·²æ’åºåˆ™å¯ä»¥ä½¿ç”¨Tå¯¹è±¡çš„æ’åºå­—æ®µæ¥è®¡ç®—ä¸‹ä¸€æ‰¹æ•°æ®çš„æ¸¸æ ‡ä»è€Œè·³è¿‡ `limit ... offset ...`åˆ†é¡µæŸ¥è¯¢ä»é¡µæå¤§æå‡å–æ•°æ€§èƒ½ã€‚

```java
new Workbook()
.addSheet(new ListSheet<E>().setData((i, lastOne) -> i < 2_000_000 ? E.data() : null))
.writeTo(Paths.get("F:/excel/200w.xlsx"));
```

### å¢åŠ è¿›åº¦å…¼å¬

å¤§æ•°æ®é‡å¯¼å‡ºæ—¶å¾€å¾€è€—æ—¶è¾ƒé•¿ï¼Œè¡¨ç°å‡ºæ¥å°±æ˜¯ç¨‹åºå¡åœ¨é‚£é‡Œä¸€åŠ¨ä¸åŠ¨ï¼Œä¸ºäº†é˜²æ­¢è¿™ç§å‡æ­»ç°è±¡æˆ‘ä»¬å¯ä»¥åœ¨å¯¼å‡ºæ—¶å¢åŠ ä¸€ä¸ªè¿›åº¦å…¼å¬ä»£ç æ®µï¼Œå®ƒä½äº`Workbook#onProgress`æ–¹æ³•ï¼Œå®ƒæœ‰ä¸¤ä¸ªå…¥å‚ ç¬¬ä¸€ä¸ªæ˜¯`sheet`è¡¨ç¤ºå½“å‰æ­£åœ¨å¯¼å…¥å“ªä¸ªå·¥ä½œè¡¨ï¼Œç¬¬äºŒä¸ªæ˜¯`rows`è¡¨ç¤ºå·²å†™å…¥çš„è¡Œæ•°ï¼Œ`onProgress`æ–¹æ³•æ¯1000è¡Œè¢«æ‰§è¡Œä¸€æ¬¡

```java
new Workbook()
// æ·»åŠ è¿›åº¦å…¼å¬ä»£ç ï¼Œå¤–éƒ¨å¯è§‚å¯Ÿå†™å…¥æ•°æ®é‡ï¼Œå¯åšå¯¼å‡ºè¿›åº¦ä¹Ÿç®€å•å†™æ—¥å¿—
.onProgress((sheet, rows) -> System.out.println(sheet.getName() + " å·²å†™å…¥: " + rows))
.addSheet(new ListSheet<E>().setData((i, lastOne) -> i < 2_000_000 ? E.data() : null))
.writeTo(Paths.get("F:/excel/200w.xlsx"));
```

å¯¹äºå¯¼å‡ºæ—¶é•¿è¯„ä¼°çš„è¡¥å……è¯´æ˜ï¼šxlsxæ ¼å¼æœ¬è´¨ä¸ºzipæ ¼å¼ï¼Œæ‰€ä»¥å¯¼å‡ºå¯åˆ†ä¸ºä¸¤é˜¶æ®µï¼Œç¬¬ä¸€é˜¶æ®µä¸ºå†™æ•°æ®é˜¶æ®µï¼Œç¬¬äºŒé˜¶æ®µä¸ºå‹ç¼©é˜¶æ®µã€‚

+ ç¬¬ä¸€é˜¶æ®µå¯ä»¥æ ¹æ®æ€»æ•°æ®é‡å’Œæ¯1000æ¡æ•°æ®çš„è€—æ—¶è®¡ç®—å‡ºè¯¥é˜¶æ®µçš„æ€»è€—æ—¶ï¼ˆæ¯æ‰¹åŠ¨æ€è®¡ç®—æ¥çŸ«æ­£åå·®ï¼‰
+ ç¬¬äºŒé˜¶æ®µå°±æ¯”è¾ƒéš¾åŠ¨æ€è®¡ç®—äº†ï¼Œä¸€èˆ¬åšæ³•æ˜¯æå‰æ‹¿æ–‡ä»¶åšåŸºå‡†zipå‹ç¼©æµ‹è¯•ï¼Œæ ¹æ®æ¯mbçš„åŸºå‡†æ—¶é—´æ¥è®¡ç®—ï¼Œå¥½åœ¨åšå®ŒåŸºå‡†æµ‹è¯•åå¯ç›´æ¥æ ¹æ®æ–‡ä»¶å¤§å°å°±èƒ½è®¡ç®—å‡ºå‹ç¼©æ—¶é•¿ï¼Œå¯ä»¥ç²—ä¼°ä¸ºç¬¬ä¸€é˜¶æ®µæ—¶é—´åŒç­‰æ—¶é—´

### è¯»å–åˆ†ç‰‡æ•°æ®

å¯¹äºè‡ªåŠ¨åˆ†ç‰‡çš„æ•°æ®ï¼Œæˆ‘ä»¬ä¸éœ€è¦ä¸€ä¸ªsheetä¸€ä¸ªsheetè¯»å–ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨Streamçš„`flatMap`åŠŸèƒ½å°†worksheeté™ç»´å¤„ç†ï¼Œå¦‚ä¸‹ä»£ç ç»Ÿè®¡200wæ•°æ®ä¸­æ•°å­—å¤§äº1wçš„ä¸ªæ•°

```java
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/200w.xlsx"))) {
    long count = reader.sheets()
    .flatMap(Sheet::dataRows) // ä½¿ç”¨flatMapé™ç»´
    .map(row -> row.getInt(0)).filter(i -> i > 10000) // å–ç¬¬1åˆ—æ•°æ®å¹¶è¿‡æ»¤å¤§äº10000çš„å€¼
    .count();
    System.out.println("å…±è®¡" + count + "ä¸ªæ•°å¤§äº1w");
}
```

è´´å‡ºDEBUGæ—¥å¿—

```java
- load xl\worksheets\sheet1.xml
- Dimension-Range: A1:B1048576
- end of file.
- load xl\worksheets\sheet2.xml
- Dimension-Range: A1:B951426
- end of file.
å…±è®¡999601ä¸ªæ•°å¤§äº1w
```

é€šè¿‡DEBUGæ—¥å¿—å¯ä»¥çœ‹åˆ°ä½¿ç”¨flatMapè§£æå®Œsheet1åæ¥ç€è§£æsheet2ï¼Œå¾—å‡ºç»“æœ999601ï¼Œä¸excelç­›é€‰å‡ºçš„ç»“æœä¸€è‡´

![1733743964193-686bfda1-288c-476c-a5d1-152ab31ef4c1.jpeg](./img/7urPzaZk-WufFtAp/1733743964193-686bfda1-288c-476c-a5d1-152ab31ef4c1-972037.jpeg)![1733743966881-beb6e696-d518-433b-83cc-f498ec8c96f2.jpeg](./img/7urPzaZk-WufFtAp/1733743966881-beb6e696-d518-433b-83cc-f498ec8c96f2-261554.jpeg)

## æ¨¡æ¿å¯¼å‡º

ä»v0.5.14å¼€å§‹EECæ–°å¢æ¨¡æ¿å·¥ä½œè¡¨TemplateSheetï¼Œå®ƒæ”¯æŒæŒ‡å®šä¸€ä¸ªå·²æœ‰çš„Excelæ–‡ä»¶ä½œä¸ºæ¨¡æ¿å¯¼å‡ºï¼ŒTemplateSheetå°†å¤åˆ¶æ¨¡æ¿å·¥ä½œè¡¨çš„æ ·å¼å¹¶æ›¿æ¢å ä½ç¬¦ï¼Œ åŒæ—¶TemplateSheetä¹Ÿå¯ä»¥å’Œå…¶å®ƒWorksheetæ··ç”¨ï¼Œè¿™æ„å‘³ç€å¯ä»¥æ·»åŠ å¤šä¸ªæ¨¡æ¿å·¥ä½œè¡¨å’Œæ™®é€šå·¥ä½œè¡¨ã€‚ åˆ›å»ºæ¨¡æ¿å·¥ä½œè¡¨éœ€è¦æŒ‡å®šæ¨¡æ¿æ–‡ä»¶ï¼Œå®ƒå¯ä»¥æ˜¯æœ¬åœ°æ–‡ä»¶ä¹Ÿå¯æ˜¯è¾“å…¥æµInputStreamï¼Œæ”¯æŒçš„ç±»å‹åŒ…å«xls å’Œxlsxä¸¤ç§æ ¼å¼ï¼Œé™¤æ¨¡æ¿æ–‡ä»¶å¤–è¿˜éœ€è¦æŒ‡å®šå·¥ä½œè¡¨ï¼Œ æœªæŒ‡å®šå·¥ä½œè¡¨æ—¶é»˜è®¤ä»¥ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨åšä¸ºæ¨¡æ¿ã€‚

### ç»‘å®šå€¼

TemplateSheetå·¥ä½œè¡¨å¯¼å‡ºæ—¶ä¸å—ExcelColumnæ³¨è§£é™åˆ¶ï¼Œå¯¼å‡ºçš„æ•°æ®èŒƒå›´ç”±æ¨¡æ¿å†…å ä½ç¬¦å†³å®šï¼Œé»˜è®¤å ä½ç¬¦ç”±ä¸€å¯¹å…³é—­çš„å¤§æ‹¬å·`${key}`ç»„æˆï¼Œ è™½ç„¶å ä½ç¬¦ä¸ELè¡¨è¾¾å¼å†™æ³•ç›¸åŒä½†æ¨¡æ¿å ä½ç¬¦å¹¶ä¸å…·å¤‡ELçš„èƒ½åŠ›ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨`${1 + 2}`æˆ–`${System.getProperty("user.name")}`è¿™ç±»è¯­å¥æ¥åšè¿ç®—ï¼Œ æ¨¡æ¿å ä½ç¬¦_ä»…åšæ›¿æ¢ä¸åšè¿ç®—_æ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒå®‰å…¨æ¼æ´é—®é¢˜ã€‚

`setData(java.lang.Object)`æ–¹æ³•ä¸ºå ä½ç¬¦ç»‘å®šå€¼ï¼Œæ”¯æŒå¯¹è±¡ã€Mapã€Arrayå’ŒListï¼Œæ•°æ®é‡è¾ƒå¤§æ—¶å¯ç»‘å®šä¸€ä¸ªæ•°æ®ç”Ÿäº§è€…data-supplieræ¥åˆ†ç‰‡æ‹‰å–æ•°æ®ï¼Œ å®ƒè¢«å®šä¹‰ä¸º`BiFunction<Integer, T, List<T>>`ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…¥å‚`Integer`è¡¨ç¤ºå·²æ‹‰å–æ•°æ®çš„è®°å½•æ•°ï¼ˆå¹¶éå·²å†™å…¥æ•°æ®ï¼‰ï¼Œ ç¬¬äºŒä¸ªå…¥å‚`T`è¡¨ç¤ºä¸Šä¸€æ‰¹æ•°æ®ä¸­æœ€åä¸€ä¸ªå¯¹è±¡ï¼Œä¸šåŠ¡ç«¯å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªå‚æ•°æ¥è®¡ç®—ä¸‹ä¸€æ‰¹æ•°æ®åº”è¯¥ä»å“ªä¸ªèŠ‚ç‚¹å¼€å§‹æ‹‰å–ï¼Œ é€šå¸¸ä½ å¯ä»¥ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°é™¤ä»¥æ¯æ‰¹æ‹‰å–çš„æ•°æ®å¤§å°æ¥ç¡®å®šå½“å‰é¡µç ï¼Œå¦‚æœæ•°æ®å·²æ’åºåˆ™å¯ä»¥ä½¿ç”¨Tå¯¹è±¡çš„æ’åºå­—æ®µæ¥è®¡ç®—ä¸‹ä¸€æ‰¹æ•°æ®çš„æ¸¸æ ‡ä»¥è·³è¿‡ `limit ... offset ...`åˆ†é¡µæŸ¥è¯¢ä»è€Œå¤§å¤§æå‡å–æ•°æ€§èƒ½ã€‚

```java
new Workbook("æ¨¡æ¿æµ‹è¯•")
// æ¨¡æ¿å·¥ä½œè¡¨
.addSheet(new TemplateSheet(Paths.get("F:/excel/template.xlsx"))
          // ç»‘å®šç”¨æˆ·åˆ—è¡¨
          .setData(userList)
          // è®¾ç½®ä¸€ä¸ªæ•°æ®ç”Ÿäº§è€… data-supplieråˆ†ç‰‡æŸ¥è¯¢æ•°æ®
          .setData((i, lastOne) -> queryUser(i > 0 ? ((User)lastOne).getId() : 0))
          // æ™®é€šå¯¹è±¡æ•°ç»„å·¥ä½œè¡¨
          .addSheet(new ListSheet<>().setData(list)))
.writeTo(Paths.get("F:/excel"));
```

### å‘½åç©ºé—´

æ¯ä¸ªå ä½ç¬¦éƒ½æœ‰ä¸€ä¸ªå‘½åç©ºé—´ï¼Œæ ¼å¼ä¸º`${namespace.key}`å®ƒç”¨äºåŒºåˆ†ä¸åŒçš„æ•°æ®åŸŸï¼Œä¾‹å¦‚æ±‡æ€»æ•°æ®å’Œåˆ—è¡¨æ•°æ®æˆ–å¤šä¸ªåˆ—è¡¨æ•°æ®ï¼Œ å½“å‰åªæ”¯æŒä¸€çº§å‘½åç©ºé—´å¦‚æœå¯¹è±¡å¥—å¯¹è±¡åˆ™éœ€è¦åœ¨å¤–éƒ¨æ‹†åˆ†å¹¶ä»¥ä¸åŒçš„å‘½åç©ºé—´è®¾å€¼

æœ‰å¦‚ä¸‹æ¨¡æ¿ï¼Œå®ƒæœ‰3ä¸ªå‘½åç©ºé—´ï¼Œåˆ†åˆ«ä¸ºâ€é»˜è®¤â€œï¼Œâ€listâ€œå’Œâ€summaryâ€œ

![1734003106133-6749dddc-32ee-40df-a30e-c3a567007648.jpeg](./img/7urPzaZk-WufFtAp/1734003106133-6749dddc-32ee-40df-a30e-c3a567007648-207885.jpeg)

æµ‹è¯•ä»£ç 

```java
// å‡†å¤‡æµ‹è¯•æ•°æ® >>>
Map<String, Object> main = new HashMap<>();
main.put("gysName", " ä¾›åº”å•†A");
main.put("gsName", "ABCå…¬å¸");
main.put("jsName", "äºšç‘Ÿ");
main.put("cgDate", new Date());
main.put("orderNo", "0001");
main.put("orderStatus", "OK");

List<Map<String, Object>> list = new ArrayList<>();
Map<String, Object> row1 = new HashMap<>();
row1.put("xh", 1);
row1.put("jpCode", "45A3495C72");
row1.put("jpName", "name1");
row1.put("num", 10);
row1.put("price", 10);
row1.put("amount", 100);
row1.put("tax", 0.6);
row1.put("taxPrice", 11.6);
row1.put("taxAmount", 116);
row1.put("remark", "å¤‡æ³¨1");
list.add(row1);
Map<String, Object> row2 = new HashMap<>();
row2.put("xh", 2);
row2.put("jpCode", "F2454E321436");
row2.put("jpName", "name2");
row2.put("num", 20);
row2.put("price", 20);
row2.put("amount", 200);
row2.put("tax", 0.6);
row2.put("taxPrice", 21.2);
row2.put("taxAmount", 212);
row2.put("remark", "å¤‡æ³¨2");
list.add(row2);

Map<String, Object> summary = new HashMap<>();
summary.put("nums", 30);
summary.put("priceTotal", 30);
summary.put("amountTotal", 300);
summary.put("taxTotal", 0.6);
summary.put("taxPriceTotal", 32.8);
summary.put("taxAmountTotal", 328);
// <<< æµ‹è¯•æ•°æ®å‡†å¤‡ç»“æŸ

new Workbook()
.addSheet(new TemplateSheet(testResourceRoot().resolve("template2.xlsx"))
          .setData(main)  <- ç»‘å®šå‘½åç©ºé—´null
          .setData("list", list) <- ç»‘å®šå‘½åç©ºé—´list
          .setData("summary", summary) <- ç»‘å®šå‘½åç©ºé—´summary
         ).writeTo(Paths.get("F:/excel/å‘½åç©ºé—´æµ‹è¯•.xlsx"));
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1733750055897-a0222fb3-63cf-41a1-84ce-d25bff167058.jpeg](./img/7urPzaZk-WufFtAp/1733750055897-a0222fb3-63cf-41a1-84ce-d25bff167058-211482.jpeg)

### æ•°æ®æ ¼å¼åŒ–

åªéœ€è¦åœ¨æ¨¡æ¿æ–‡ä»¶ä¸­è®¾ç½®å¥½æ ¼å¼åŒ–å³å¯ï¼Œå•å…ƒæ ¼è®¾ç½®çš„ä»»æ„æ ¼å¼åŒ–éƒ½å°†è¢«å¤åˆ¶ï¼Œå¦‚ä¸Šç¤ºä¾‹ä¸­ä»·æ ¼å•å…ƒæ ¼åŒ…å«æ ¼å¼åŒ–`Â¥0.00_)`ï¼Œæ¨¡æ¿æ–‡ä»¶çœ‹ä¸å‡ºæ•ˆæœä½†ç»“æœæ–‡ä»¶å¯ä»¥çœ‹åˆ°æ•ˆæœï¼ˆç»“æœä¸ºæ•°å­—æ‰€ä»¥æœ‰æ ¼å¼åŒ–æ•ˆæœï¼‰

### å†…ç½®å‡½æ•°

å ä½ç¬¦ä¸­åŒ…å«ä¸‰ä¸ªå†…ç½®å‡½æ•°å®ƒä»¬åˆ†åˆ«ä¸º`[@link:]`ã€`[@list:]`å’Œ`[@media:]`ï¼Œåˆ†åˆ«ç”¨äºè®¾ç½®å•å…ƒæ ¼çš„å€¼ä¸ºè¶…é“¾æ¥ã€åºåˆ—å’Œå›¾ç‰‡ï¼Œ å…¶ä¸­åºåˆ—çš„å€¼å¯ä»¥ä»æºå·¥ä½œè¡¨ä¸­è·å–ä¹Ÿå¯ä»¥ä½¿ç”¨`setData`æ–¹æ³•æ¥è®¾ç½®ï¼Œ_å†…ç½®å‡½æ•°å¿…é¡»ç‹¬å ä¸€ä¸ªå•å…ƒæ ¼ä¸”ä»…è¯†åˆ«å›ºå®šçš„ä¸‰ä¸ªå†…ç½®å‡½æ•°ï¼Œ ä»»æ„å…¶å®ƒå‘½ä»¤å°†è¢«è¯†åˆ«ä¸ºæ™®é€šå‘½ä»¤ç©ºé—´_

å ä½ç¬¦æ•´ä½“æ ·å¼ï¼š`[@å†…ç½®å‡½æ•°:][å‘½åç©ºé—´][.]<å ä½ç¬¦>`

æœ‰å¦‚ä¸‹æ¨¡æ¿

![1733750066373-332158c6-ef18-48bc-9df9-8167259bba84.jpeg](./img/7urPzaZk-WufFtAp/1733750066373-332158c6-ef18-48bc-9df9-8167259bba84-072491.jpeg)

```java
// å‡†å¤‡æµ‹è¯•æ•°æ® >>>
List<Map<String, Object>> list = new ArrayList<>();
Map<String, Object> row1 = new HashMap<>();
row1.put("name", "å¼ ä¸‰");
row1.put("age", 6);
row1.put("sex", "ç”·");
row1.put("pic", "https://m.360buyimg.com/babel/jfs/t20260628/103372/21/40858/120636/649d00b3Fea336b50/1e97a70d3a3fe1c6.jpg");
row1.put("jumpUrl", "https://www.tulingxueyuan.cn");
list.add(row1);

Map<String, Object> row2 = new HashMap<>();
row2.put("name", "æå››");
row2.put("age", 8);
row2.put("sex", "å¥³");
row2.put("pic", "https://gw.alicdn.com/bao/uploaded/i3/1081542738/O1CN01ZBcPlR1W63BQXG5yO_!!0-item_pic.jpg_300x300q90.jpg");
row2.put("jumpUrl", "https://www.tulingxueyuan.cn/zjtl/");
list.add(row2);
// <<< æµ‹è¯•æ•°æ®å‡†å¤‡ç»“æŸ

new Workbook()
// æ¨¡æ¿å·¥ä½œè¡¨
.addSheet(new TemplateSheet(Paths.get("F:/excel/template.xlsx"))
          // æ›¿æ¢æ¨¡æ¿ä¸­å ä½ç¬¦
          .setData(list)
          // æ›¿æ¢æ¨¡æ¿ä¸­"@list:sex"å€¼ä¸ºæ€§åˆ«åºåˆ—
          .setData("@list:sex", Arrays.asList("æœªçŸ¥", "ç”·", "å¥³")))
.writeTo(Paths.get("F:/excel/å†…ç½®å‡½æ•°æµ‹è¯•.xlsx"));
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1733750076373-6623ea2e-063a-436f-abe7-b8a90731f747.jpeg](./img/7urPzaZk-WufFtAp/1733750076373-6623ea2e-063a-436f-abe7-b8a90731f747-099480.jpeg)

æ€§åˆ«åˆ—ä¸º"åºåˆ—"ï¼Œå¤´åƒåˆ—ä¸º"å›¾ç‰‡"ï¼Œç®€å†åŸä»¶ä¸º"è¶…é“¾æ¥"

### å¤šç§æ··åˆå·¥ä½œè¡¨

åœ¨EECä¸­WorksheetåŠå…¶å­ç±»å‡è¢«è§†ä¸ºæ•°æ®æºï¼Œè¿™äº›æ•°æ®æºå‡å¯ä»¥æ··åˆä½¿ç”¨ï¼Œè¾“å‡ºåè®®ç”±WorksheetWriterå†³å®šï¼Œç›®å‰ä»…æ”¯æŒxlsxå’Œcsvæ ¼å¼ï¼Œæ‰€ä»¥å³ä½¿æ¨¡æ¿ä¸ºxlsæ ¼å¼è¾“å‡ºä¹Ÿå°†æ˜¯xlsxæ ¼å¼

```java
new Workbook()
.addSheet(new TemplateSheet(Paths.get("F:/excel/1.xlsx"))) // <- xlsxæ¨¡æ¿å·¥ä½œè¡¨
.addSheet(new TemplateSheet(Paths.get("F:/excel/2.xls"))) // <- xlsæ¨¡æ¿å·¥ä½œè¡¨
.addSheet(new ListSheet<>(randomTestData())) // <- æ™®é€šå·¥ä½œè¡¨
.writeTo(Paths.get("F:/excel/æ··åˆæ¨¡æ¿.xlsx"));
```

### å…¼å®¹æ€§

ä¸ºäº†è§£å†³åˆ‡æ¢åˆ°EECåå¯¼è‡´ç°æœ‰æ¨¡æ¿å¤±æ•ˆä»è€Œå¤§é¢ç§¯ä¿®æ”¹æ¨¡æ¿çš„é—®é¢˜ï¼ŒEECæä¾›äº†`setPrefix`å’Œ`setSuffix`ä¸¤ä¸ªæ–¹æ³•æ¥ä¿®æ”¹å ä½ç¬¦å‰ç¼€å’Œåç¼€ï¼Œå¦‚ç°æœ‰æ¨¡æ¿å ä½ç¬¦ä¸º`{key}` åˆ™å¯ä»¥ä½¿ç”¨`setPrefix("{")`æ¥é‡ç½®å‰ç¼€ï¼Œè¿™æ ·ä½ ä¸éœ€è¦ä¿®æ”¹ç°æœ‰æ¨¡æ¿æ¥å®Œæˆé€‚é…ã€‚

```java
new Workbook()
// æ¨¡æ¿å·¥ä½œè¡¨
.addSheet(new TemplateSheet(Paths.get("F:/excel/template.xlsx"))
          .setPrefix("{") // <- é‡ç½®å‰ç¼€ä¸º"{"
          .setData(list))
.writeTo(Paths.get("F:/excel/å†…ç½®å‡½æ•°æµ‹è¯•.xlsx"));
```

### ç‰¹æ®Šè¯´æ˜

TemplateSheetå·¥ä½œè¡¨ä½¿ç”¨ExcelReaderè¯»å–æºæ–‡ä»¶ï¼Œå¹¶å¤åˆ¶æ ·å¼ç­‰ä¿¡æ¯åˆ°æ–°çš„å·¥ä½œè¡¨ï¼Œå®ƒå¹¶ä¸æ˜¯ç›´æ¥åœ¨åŸå·¥ä½œè¡¨ä¸­è¿½åŠ æ•°æ®ï¼Œæ‰€ä»¥ä¼šä¸¢å¤±ä¸€äº›ä¿¡æ¯ï¼ˆåªèƒ½è¯»å–å½“å‰ExcelReaderæ‰€æ”¯æŒçš„å†…å®¹ï¼‰ã€‚

é™¤æ­¤ä¹‹å¤–v0.5.14ç‰ˆæœ¬è¿˜æœ‰ä¸€äº›åŠŸèƒ½é™åˆ¶ï¼Œå…·ä½“è¡¨ç°å¦‚ä¸‹

+ ä¸æ”¯æŒå¤šTableï¼Œå¦‚æœTableåˆ—ä¸å…¶ä½™å›ºå®šæ–‡æœ¬ä¸€èµ·æ—¶å›ºå®šæ–‡æœ¬ä¹Ÿå°†è¢«å¤åˆ¶
+ æ›¿æ¢å ä½ç¬¦æ—¶ä¸è§£æç°æœ‰å¯¹è±¡ä¸­çš„ExcelColumnæ³¨è§£ï¼Œæ‰€ä»¥åœ¨å®ä½“é‡Œè®¾ç½®çš„æ³¨è§£å±æ€§å®Œå…¨æ— æ•ˆ
+ æ¨¡æ¿ä¸ºxlsæ—¶é¢œè‰²ä¼šå‡ºç°åå·®ï¼Œæˆ‘å°è¯•ç”¨POIè¯»å–é¢œè‰²æ—¶ä¹Ÿå‡ºç°åŒæ ·é—®é¢˜
+ æš‚æ—¶ä¸æ”¯æŒè‡ªåŠ¨åˆ†é¡µï¼Œæ¨¡æ¿æœ‰æ›´å¤æ‚çš„å†…å®¹ï¼Œæ— æ³•å¤„ç†åˆ†é¡µåå“ªäº›éƒ¨åˆ†éœ€è¦å¤åˆ¶åˆ°æ–°çš„å·¥ä½œè¡¨ï¼Œæ‰€ä»¥æš‚æ—¶ä¸æ”¯æŒåˆ†é¡µ
+ æ¨¡æ¿ä¸­åŒ…å«åŒè‰²å¡«å……æ—¶å¯¼å‡ºç»“æœåªä¼šä¿ç•™color1çš„é¢œè‰²
+ ç”±äºeecè¯»å–xlså›¾ç‰‡æœ‰BUGï¼Œæ‰€ä»¥æ¨¡æ¿æ–‡ä»¶ä¸­æœ‰å›¾ç‰‡æ—¶å¯èƒ½å¯¼è‡´å¯¼å‡ºå¼‚å¸¸

## åŠ¨æ€è®¾ç½®æ ·å¼

æ‰€è°“åŠ¨æ€å°±æ˜¯æ ¹æ®å•å…ƒæ ¼æˆ–è¡Œæ•°æ®ä¸åŒä¸ºæ¯ä¸ªå•å…ƒæ ¼æˆ–è€…æ¯ä¸€è¡Œè®¾ç½®ä¸åŒæ ·å¼ï¼Œè¿™ä¸ªåŠŸèƒ½å¯ä»¥æå¤§ä¸°å¯Œæ–‡ä»¶çš„å¯è¯»æ€§å’Œå¤šæ ·æ€§ï¼Œç®—æ˜¯EECçš„ä¸ªæ€§åŒ–åŠŸèƒ½å§ã€‚

### ä½¿ç”¨StyleDesignæ³¨è§£

Java Beanå¯ä»¥ä½¿ç”¨`@StyleDesign`æ³¨è§£åŠ¨æ€ç¼–è¾‘æ ·å¼ï¼ˆåŒ…å«å­—ä½“ï¼Œå¡«å……ï¼Œè¾¹æ¡†ï¼Œæ ¼å¼ç­‰ï¼‰ï¼ŒStyleDesignä½œç”¨äº`Type`ï¼Œ`Field`å’Œ`Method`ï¼Œå‰è€…å½±å“æ•´è¡Œæ ·å¼ï¼Œåä¸¤ç§å½±å“å•ä¸ªCell

#### ä½œç”¨äºType

StyleDesignæŒ‡å®šçš„ç±»éœ€è¦å®ç°`StyleProcessor<T>`æ¥å£ï¼Œè¯¥æ¥å£æ–¹æ³•æœ‰3ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªä¸ºJava Beanï¼Œç¬¬2ä¸ªæ˜¯ç°æœ‰æ ·å¼ï¼Œç¬¬3ä¸ªæ˜¯Styleså®ä¾‹ï¼Œ

```java
@StyleDesign(using = StudentScoreStyle.class)
public static class DesignStudent {
    @ExcelColumn
    private String name;
    @ExcelColumn
    private int score;
}

public static class StudentScoreStyle implements StyleProcessor<DesignStudent> {
    @Override
    public int build(DesignStudent o, int style, Styles st) {
        // ä½äº60åˆ†æ—¶èƒŒæ™¯è‰²æ ‡é»„
        if (o.getScore() < 60) {
            style = st.modifyFill(style, new Fill(PatternType.solid, Color.orange));
        } else if (o.getScore() > 95) {
            // ç²—ä½“+ä¸‹åˆ’çº¿ï¼ˆè¿™é‡Œä½¿ç”¨cloneå¯ä»¥ä¿ç•™åŸå­—ä½“å’Œå¤§å°ï¼‰
            Font newFont = st.getFont(style).clone().underline().bold();
            style = st.modifyFont(style, newFont);
        }
        return style;
    }
}
```

æ•ˆæœå¦‚ä¸‹ï¼š95åˆ†ä»¥ä¸Šçš„è¡Œå­—ä½“è¢«åŠ ç²—å¹¶åŠ ä¸‹åˆ’çº¿ï¼Œä½äº60åˆ†çš„æ•´è¡ŒèƒŒæ™¯è‰²æ ‡é»„

![1734260790323-6ef976e9-66b9-469b-899c-001ac7ae7ca8.png](./img/7urPzaZk-WufFtAp/1734260790323-6ef976e9-66b9-469b-899c-001ac7ae7ca8-058832.png)

#### ä½œç”¨äºFieldå’ŒMethod

StyleDesignä½¿ç”¨äºFieldå’ŒMethodç”¨æ³•ä¸Typeå®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯ä¼ å…¥çš„ç¬¬1ä¸ªå‚æ•°å˜æˆå•å…ƒæ ¼çš„å€¼

```java
public static class DesignStudent {
    @StyleDesign(using = NameMatch.class)
    @ExcelColumn
    private String name;
    private int score;

    @StyleDesign(using = ScoreStyle.class)
    @ExcelColumn
    public int getScore() {
        return score;
    }
}

private static final Set<String> VIP_SET = new HashSet<>(Arrays.asList("a", "b", "x"));

public static class NameMatch implements StyleProcessor<String> {
    @Override
    public int build(String name, int style, Styles sst) {
        if (VIP_SET.contains(name)) {
            Font font = sst.getFont(style).clone();
            style = sst.modifyFont(style, font.bold());
        }
        return style;
    }
}

public static class ScoreStyle implements StyleProcessor<Integer> {
    @Override
    public int build(Integer score, int style, Styles st) {
        if (score < 60) {
            style = st.modifyFill(style, new Fill(PatternType.solid, Color.orange));
        }
        return style;
    }
}
```

![1734260777455-3959941e-ce83-4c54-a444-8b6c9b5a738c.png](./img/7urPzaZk-WufFtAp/1734260777455-3959941e-ce83-4c54-a444-8b6c9b5a738c-179113.png)

### ä½¿ç”¨StyleProcessor

å¯¹äºListMapSheet,ResultSetSheetæˆ–StatementSheetè¿™ä¸‰ç§æ— æ³•ä½¿ç”¨æ³¨è§£çš„Worksheetï¼ŒEECæä¾›äº†`setStyleProcessor`æ–¹æ³•ï¼Œä¸StyleDesignä¸€æ ·ï¼Œå¯ä»¥åº”ç”¨äºæ•´è¡Œæˆ–è€…å•ä¸ªå•å…ƒæ ¼

#### ä½œç”¨äºWorksheet

```java
new Workbook()
.addSheet(new ListSheet<>(list
                          , new Column("å§“å", "name")
                          , new Column("æ•°å­¦æˆç»©", "score")
                          , new Column("å¤‡æ³¨", "toString")
                         ).setStyleProcessor((o,s,st) -> o.getScore() < 60 ? st.modifyFill(s, new Fill(PatternType.solid, Color.orange)) : s))
.writeTo(Paths.get("F:/excel"));
```

ä½äº60åˆ†æ•´ä¸ªå•å…ƒæ ¼æ ‡é»„

 ![1734260767870-7f7210a1-da67-4bfd-ac1f-b18f86b27d83.png](./img/7urPzaZk-WufFtAp/1734260767870-7f7210a1-da67-4bfd-ac1f-b18f86b27d83-487781.png)

#### ä½œç”¨äºColumn

```java
new Workbook()
.addSheet(new ListSheet<>(list
                          , new Column("å§“å", "name").setStyleProcessor((n, s, sst) -> Styles.modifyHorizontal(s, Horizontals.CENTER))
                          , new Column("æ•°å­¦æˆç»©", "score").setWidth(12D)
                          , new Column("å¤‡æ³¨", "toString").setWidth(25.32D).setWrapText(true)
                         )).writeTo(Paths.get("F:/excel"));
```

ä¸Šé¢çš„ä»£ç ä½¿ç”¨æ˜¯å°†â€œå§“åâ€åˆ—è®¾ç½®ä¸ºå±…ä¸­

![1734260756210-409a1dcb-fc6c-4e55-a5b0-9d5abd859025.png](./img/7urPzaZk-WufFtAp/1734260756210-409a1dcb-fc6c-4e55-a5b0-9d5abd859025-485121.png)

åŠ¨æ€æ ·å¼å¤„ç†å°±å±•ç¤ºè¿™ä¹ˆå¤šï¼Œå¯¹äºæ ·å¼å¤„ç†æœ‰ä¸€å®šçš„å­¦ä¹ æˆæœ¬ï¼ŒEECå¤„ç†æ ·å¼ä¸€å®šæœ‰è¿™ä¸¤æ­¥ï¼Œç¬¬ä¸€æ­¥æ˜¯æ¸…é™¤å½“å‰æ ·å¼ï¼Œç¬¬äºŒæ­¥æ˜¯æ·»åŠ æ–°çš„æ ·å¼ã€‚æ ·å¼ä¹‹é—´ä½¿ç”¨`|`è¿ç®—ç¬¦è¿æ¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`Styles.modifyXX`ä¸ç®€åŒ–

## é™æ€è®¾ç½®æ ·å¼

Excelæ ·å¼åŒ…å«æ ¼å¼åŒ–NumFmtã€å­—ä½“Fontã€å¡«å……Fillã€è¾¹æ¡†Borderã€ å‚ç›´å¯¹é½Verticalså’Œæ°´å¹³å¯¹é½Horizontalsä»¥åŠè‡ªåŠ¨æŠ˜è¡Œç»„æˆï¼Œ EECç®€åŒ–äº†æ ·å¼è®¾è®¡ï¼Œå•å…ƒæ ¼æ ·å¼ç”±ä¸€ä¸ªintå€¼ä¿å­˜ï¼Œå®ƒå¯ä»¥æå¤§å‡å°‘å†…å­˜å¼€é”€å’Œæå‡æŸ¥æ‰¾é€Ÿåº¦ï¼Œä½†çŸ­æ¿æ˜¯å¯ç”¨çš„æ ·å¼å‡å°‘ï¼Œå½“å‰æœ€å¤šåªèƒ½åŒ…å«**256ä¸ªæ ¼å¼åŒ–ï¼Œ64ä¸ªå­—ä½“ã€64ä¸ªå¡«å……å’Œ64ä¸ªè¾¹æ¡†**ï¼Œ å¯¹äºæ—¥å¸¸çš„å¯¼å‡ºéœ€æ±‚åº”è¯¥æ˜¯å¤Ÿç”¨çš„ä½†å¤æ‚åœºæ™¯å°±éœ€è¦è€ƒè™‘å°†intæ‰©å¤§åˆ°longã€‚

ç›¸å¯¹äºåŠ¨æ€æ ·å¼è€Œè¨€ï¼Œè®¾ç½®é™æ€æ ·å¼æ˜¯ä¸€æ¬¡æ€§çš„åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¡ç®—æ‰€ä»¥å¹¶ä¸ä¼šå½±å“å¯¼å‡ºé€Ÿåº¦ï¼Œé»˜è®¤çš„æ ·å¼å¤§å¤šæ•°æƒ…å†µä¸‹å¹¶ä¸èƒ½æ»¡è¶³æ¯ä¸ªäººçš„å®¡ç¾ï¼Œ å¥½åœ¨EECæœ‰å¤šç§æ–¹å¼ä¿®æ”¹é»˜è®¤çš„è¡¨å¤´æˆ–è€…æ•°æ®è¡Œçš„æ ·å¼ã€‚

### ä¿®æ”¹è¡¨å¤´æ ·å¼

Worksheetæš´éœ²äº†å‡ ä¸ªä¿®æ”¹è¡¨å¤´æ ·å¼çš„æ–¹æ³•`setHeadStyle`æˆ–`setHeadStyleIndex`å¯ä»¥é€šè¿‡è¿™äº›æ–¹æ³•è®¾ç½®è¡¨å¤´æ ·å¼ï¼Œæ¯ä¸ªWorksheetéƒ½å¯ä»¥è®¾ç½®ä¸åŒçš„è¡¨å¤´ã€‚

ä¿®æ”¹æ ·å¼å‰å¿…é¡»å…ˆå®ä¾‹åŒ–Workbookç„¶åæ‰èƒ½ä¿®æ”¹æ ·å¼ã€‚ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºå¦‚ä½•ä¿®æ”¹è¡¨å¤´å­—ä½“ã€èƒŒæ™¯å’Œè¾¹æ¡†

```java
ListSheet<Item> sheet = new ListSheet<>(Item.randomTestData());

// å¿…é¡»å…ˆæ‰§è¡Œè¿™ä¸€æ­¥ï¼Œå°†Worksheetæ·»åŠ åˆ°Workbook
Workbook workbook = new Workbook("Custom header style").addSheet(sheet);

// ç„¶åæ‰èƒ½ä¿®æ”¹æ ·å¼
sheet.setHeadStyle(new Font("å¾®è½¯é›…é»‘", 18, Font.Style.BOLD, Color.black)
                   , new Fill(PatternType.gray0625, Color.lightGray)
                   , new Border(BorderStyle.DOUBLE, Color.red));

workbook.writeTo(Paths.get("F:/excel"));
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1734260731016-c4aa2439-4f72-4355-87f2-9a583c9f498e.png](./img/7urPzaZk-WufFtAp/1734260731016-c4aa2439-4f72-4355-87f2-9a583c9f498e-048387.png)

å…¶ä¸­BorderStyleæ•ˆæœå¦‚ä¸‹ï¼š

![1734260720749-08c8f796-3a55-4eab-ae6e-374d62ba4fae.png](./img/7urPzaZk-WufFtAp/1734260720749-08c8f796-3a55-4eab-ae6e-374d62ba4fae-298956.png)

PatternTypeæ•ˆæœå¦‚ä¸‹ï¼š

![1734260711789-29bc336a-0a1d-417b-8019-781236e644e6.png](./img/7urPzaZk-WufFtAp/1734260711789-29bc336a-0a1d-417b-8019-781236e644e6-899995.png)

### ä¿®æ”¹éƒ¨åˆ†è¡¨å¤´æ ·å¼

å¦‚æœä»…éœ€è¦ä¿®æ”¹è¡¨å¤´çš„éƒ¨åˆ†æ ·å¼æ—¶åˆ™å¯ä»¥å…ˆè·å–åŸæœ‰æ ·å¼ç„¶åå†ä¿®æ”¹éƒ¨åˆ†å±æ€§å³å¯ã€‚ ä¸‹é¢çš„ç¤ºä¾‹å±•ç¤ºä¿®æ”¹éƒ¨åˆ†è¡¨å¤´çš„éƒ¨åˆ†å±æ€§ï¼Œæ¯”å¦‚ä¿®æ”¹å­—ä½“ã€ä¿®æ”¹å¡«å……è‰²ç­‰

```java
ListSheet<Item> sheet = new ListSheet<>(Collections.singletonList(new Item()));
Workbook workbook = new Workbook().addSheet(sheet);

Styles styles = workbook.getStyles();
int style = sheet.defaultHeadStyle();
// ä»…ä¿®æ”¹å­—ä½“é¢œè‰²
Font font = styles.getFont(style).clone() // å…ˆè·å–åŸæœ‰æ ·å¼å¹¶å¤åˆ¶ï¼ˆä¸ç„¶ä¼šå½±å“åŸæ ·å¼ï¼‰
.setColor(new Color(191, 191, 191)); // è®¾ç½®æ–°çš„æ ·å¼
int newStyle = styles.modifyFont(style, font); // å°†æ–°å­—ä½“æ·»åŠ è¿›æ ·å¼è¡¨
// ä¿®æ”¹å¡«å……è‰²
int borderStyle = styles.modifyFill(style, new Fill(PatternType.solid, new Color(247, 150, 70)));

sheet.setColumns(new Column[] {
    new Column("å•†å“åç§°", "productName").setWidth(20.0D).setWrapText(true)
    , new Column("å•†å“ç¼–ç ", "goodsNo").setHeaderStyle(borderStyle)
    , new Column("è§„æ ¼å‹å·", "model")
    , new Column("å“ç‰Œ", "brandNameCn").setWidth(12.63D)
    , new Column("å•ä½", "measure").setWidth(9.63D)
    , new Column("åœ¨åº“åº“å­˜(å‹¿æ”¹)", "quantity").setWidth(16.25D).setNumFmt("###0").setHeaderStyle(newStyle)
    , new Column("ç›˜ç‚¹åº“å­˜", "editQuantity").setWidth(12.63D).setHeaderStyle(borderStyle)
});
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1734260692029-3588dd43-e541-461e-9e96-00314b7196a5.jpeg](./img/7urPzaZk-WufFtAp/1734260692029-3588dd43-e541-461e-9e96-00314b7196a5-250169.jpeg)

å¯ä»¥çœ‹åˆ°"åœ¨åº“åº“å­˜"åˆ—è§‚æ„Ÿä¸Šå°±ç»™ç”¨æˆ·ä¸èƒ½ä¿®æ”¹çš„è§†è§‰ï¼Œè¿™æ ·å¯ä»¥é¿å…ç”¨æˆ·å°†åº“å­˜å¡«å†™åœ¨æ­¤åˆ—ï¼Œè€Œåº”è¯¥å¡«å†™åœ¨â€ç›˜ç‚¹åº“å­˜â€œåˆ—ï¼Œå¹¶ä¸”å°†ä¸¤åˆ—å¿…å¡«é¡¹çš„èƒŒæ™¯æ”¹ä¸ºæ©™è‰²å¯ä»¥ç€é‡æ˜¾ç¤ºã€‚

### æ¸…é™¤è¡¨å¤´æ ·å¼

æ¸…é™¤è¡¨å¤´æ ·å¼å°±æ¯”è¾ƒç®€å•äº†ï¼Œå¯ä»¥ç›´æ¥ç»™StyleIndexèµ‹å€¼ä¸º0å³å¯ã€‚

```java
ListSheet<Item> sheet = new ListSheet<>(Item.randomTestData());
Workbook workbook = new Workbook("Custom header style").addSheet(sheet);

// Style Indexè®¾ç½®ä¸ºã€0ã€‘
sheet.setHeadStyleIndex(0);
workbook.writeTo(Paths.get("F:/excel"));
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1734260681519-2d900348-6e4f-49a8-8454-508da80d860a.jpeg](./img/7urPzaZk-WufFtAp/1734260681519-2d900348-6e4f-49a8-8454-508da80d860a-308177.jpeg)

### ä¿®æ”¹Bodyæ ·å¼

ä¸è¡¨å¤´ç±»ä¼¼Columnä¹Ÿæä¾›äº†ç±»ä¼¼çš„æ–¹æ³•ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡`setCellStyle`æ–¹æ³•ä¿®æ”¹æ ·å¼ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œä¹Ÿæ”¯æŒåŠ¨æ€ä¿®æ”¹æ ·å¼ï¼Œè¯·å‚ç…§[åŠ¨æ€è®¾ç½®æ ·å¼](https://github.com/wangguanquan/eec/wiki/%E5%8A%A8%E6%80%81%E8%AE%BE%E7%BD%AE%E6%A0%B7%E5%BC%8F)

**v0.5.12**æä¾›æ‰€æœ‰æ ·å¼ä¿®æ”¹ï¼Œä½ å¯ä»¥åœ¨åˆ›å»ºColumnæ—¶è°ƒç”¨`setFont`ï¼Œ`setBorder`ï¼Œ`setNumFmt`ï¼Œ`setFill`ï¼Œ`setHorizontal`å’Œ`setVertical`ç­‰æ–¹æ³•ç›´æ¥è®¾ç½®åˆå§‹æ ·å¼

```java
new Workbook()
.setAutoSize(true) // <- è‡ªé€‚åº”åˆ—å®½
.addSheet(new ListSheet<>(randomTestData()
                          , new Column("ç¼–ç ", "code").setFont(new Font("Trebuchet MS", 20))
                          , new Column("å§“å", "name").setFont(new Font("Trebuchet MS", 20)).setHorizontal(Horizontals.CENTER) // <-- è®¾ç½®æ°´å¹³å±…ä¸­
                          , new Column("æ—¥æœŸ", "date").setFont(new Font("åæ–‡è¡Œæ¥·", 11)).setNumFmt("yyyy-mm-dd hh:mm:ss")
                          , new Column("æ•°å­—", "num").setFont(new Font("Bauhaus 93", 14)).setNumFmt("#,##0_);[Red]-#,##0_);0_)") // <- æŒ‡å®šå­—ä½“å’Œæ ¼å¼åŒ–
                         )).writeTo(Paths.get("F:/excel"));
```

![1734260670348-fa8f6961-53a5-4ea9-956b-686ae3c263ba.jpeg](./img/7urPzaZk-WufFtAp/1734260670348-fa8f6961-53a5-4ea9-956b-686ae3c263ba-904265.jpeg)

## æŒ‡å®šå¯¼å‡ºæ—¶çš„åˆ—é¡ºåºå’Œä½ç½®

é»˜è®¤æƒ…å†µListSheetæ ¹æ®å¯¹è±¡çš„Fieldè‡ªç„¶é¡ºåºå¯¼å‡ºï¼ŒListMapSheetæ˜¯æ— åºçš„ï¼ŒResultSetSheetå’ŒStatementSheetçš„é¡ºåºå½“ç„¶å°±æ˜¯Queryå­—æ®µçš„é¡ºåºï¼Œé™¤äº†é»˜è®¤é¡ºåºè¿˜å¯ä»¥æŒ‡å®šColumnæ¥è°ƒæ•´é¡ºåºã€‚

 v0.4.13ç‰ˆæœ¬å¼€å§‹ï¼ŒExcelColumnæ³¨è§£ä¸­å¢åŠ äº†`colIndex`å±æ€§ä»¥åŠColumnå¢åŠ `#setColIndex`æ–¹æ³•ã€‚æ­¤å±æ€§å®šä¹‰ä¸º`int`ç±»å‹ï¼Œç”¨äºæŒ‡å®š_ä»â€˜0â€™å¼€å§‹_çš„åˆ—ä½ç½®ï¼Œ**ä»â€˜0â€™å¼€å§‹**ã€**ä»â€˜0â€™å¼€å§‹** é‡è¦çš„äº‹æƒ…è¯´ä¸‰éã€‚

æ­¤å€¼çš„æœ€å¤§å€¼ä¸excelç‰ˆæœ¬æœ‰å…³ï¼Œexcel97-2003é™åˆ¶ä¸º`256`ï¼Œxlsxç‰ˆæœ¬é™åˆ¶ä¸º`16_384`ï¼Œå› ä¸ºcolIndexæ˜¯ä»0å¼€å§‹ï¼Œæ‰€ä»¥è¦åœ¨æ­¤é™åˆ¶ä¸Šå‡1ï¼Œåˆ†åˆ«ä¸º`254`å’Œ`16_383`ï¼Œ è¶…è¿‡æ­¤é™åˆ¶ä¼šæŠ›å‡º [TooManyColumnsException](https://github.com/wangguanquan/eec/blob/master/src/main/java/org/ttzero/excel/entity/TooManyColumnsException.java) å¼‚å¸¸ã€‚

_æ­¤ä½ç½®æ˜¯ç»å¯¹ä½ç½®ï¼Œå¦‚æœæœ‰ç›¸åŒçš„åˆ—ä¸‹æ ‡ï¼Œè¿™äº›åˆ—ä¸‹æ ‡ä¼šä¾æ¬¡å¾€åæ’åˆ—_

ä¸‹é¢åˆ—ä¸€äº›å®é™…ä¾‹å­:

### è‡ªç„¶é¡ºåº

æˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªåŸºç¡€çš„ç±»å¦‚ä¸‹ï¼š

```java
public class OrderEntry {
    @ExcelColumn(colIndex = 0)
    private String s;
    @ExcelColumn( colIndex = 1)
    private Date date;
    @ExcelColumn(colIndex = 2)
    private Double d;
    @ExcelColumn(colIndex = 3)
    private String s2 = "a";
    @ExcelColumn(colIndex = 4)
    private String s3 = "b";
    @ExcelColumn(colIndex = 5)
    private String s4 = "c";

    // è¿™é‡Œæ˜¯ GET SET æ–¹æ³•...
}
```

è¿™æ˜¯ä¸€ä¸ªè‡ªç„¶é¡ºåºçš„ç±»ï¼Œå¦‚ä½ æƒ³è±¡å¯¼å‡ºç»“æœå¦‚ä¸‹ï¼š

![1734263081284-0852f998-b1f9-4b17-9f05-1016f4f4d9df.jpeg](./img/7urPzaZk-WufFtAp/1734263081284-0852f998-b1f9-4b17-9f05-1016f4f4d9df-768396.jpeg)

### ç›¸åŒåˆ—ä¸‹æ ‡

å¦‚æœå‡ºç°ç›¸åŒåˆ—ä¸‹æ ‡ä¼šå¦‚ä½•å¤„ç†ï¼Œæ˜¯æŠ›å¼‚å¸¸è¿˜æ˜¯åˆ«çš„ï¼Ÿ

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»ç»§æ‰¿OrderEntryï¼Œå°†åŸæ¥ç¬¬2å’Œç¬¬3åˆ—éƒ½è®¾ç½®ä¸º5ï¼Œå¦‚ä¸‹ï¼š

```java
public class SameOrderEntry extends OrderEntry {
    @Override
    @ExcelColumn(colIndex = 5)
    public Double getD() {
        return super.getD();
    }

    @Override
    @ExcelColumn(colIndex = 5)
    public String getS2() {
        return super.getS2();
    }
}
```

è¿™æ ·åˆ—ä¸‹æ ‡ä¸º5çš„ä¸€å…±æœ‰3ä¸ªï¼Œåˆ†åˆ«æ˜¯`Double d`ã€`String s2`å’Œ`String s4`ï¼Œç°åœ¨çš„é¡ºåºæ˜¯[0, 1, 4, 5, 5, 5]ï¼ŒEECå¯¼å‡ºä¼šæ˜¯æ€æ ·å‘¢ï¼Ÿ

![p2.png](./img/7urPzaZk-WufFtAp/p2-230983.png)![1734263093014-6f385ca7-95fc-4a1d-8abe-9385d8c2c6b1.jpeg](./img/7urPzaZk-WufFtAp/1734263093014-6f385ca7-95fc-4a1d-8abe-9385d8c2c6b1-320544.jpeg)

Cã€Dä¸¤åˆ—ç©ºå‡ºæ¥äº†ï¼Œæ­£å¥½å¯¹åº”ä¸Šé¢è·³è¿‡çš„2,3ã€‚é‚£3ä¸ª5å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå®ƒä¼šæŒ‰ç…§å±æ€§å®šä¹‰çš„é¡ºåºï¼Œæ­£å¥½å°±æ˜¯[d, s2, s4]

### æé™ä¸‹æ ‡

æˆ‘ä»¬è®¾ç½®ä¸€äº›è¾ƒå¤§çš„ä¸‹æ ‡æµ‹è¯•ä¸€ä¸‹ï¼Œè®¾ç½®ä¸€ä¸ªxlsxå¯æ¥å—çš„æœ€å¤§ä¸‹æ ‡16_383ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

```java
public class LargeOrderEntry extends OrderEntry {
    @Override
    @ExcelColumn(colIndex = 16_383)
    public Date getDate() {
        return super.getDate();
    }

    @Override
    @ExcelColumn(colIndex = 189)
    public String getS2() {
        return super.getS2();
    }
}
```

æ•ˆæœå¦‚ä¸‹ï¼Œåˆ—å¤ªå¤§æ‰€ä»¥åªæ¥äº†ä¸¤ä¸ªè¾ƒå¤§çš„åˆ—è¿›è¡Œæ‹¼æ¥

![1734263103374-b0342be8-058d-4e75-8941-42dcaa9a4289.jpeg](./img/7urPzaZk-WufFtAp/1734263103374-b0342be8-058d-4e75-8941-42dcaa9a4289-004619.jpeg)

### æŒ‡å®šå¼€å§‹è¡Œ

é»˜è®¤çš„EECä»ç¬¬1è¡Œå¼€å§‹å†™ï¼Œä»v0.5.8ç‰ˆæœ¬å¼€å§‹ä½ å¯ä»¥é€šè¿‡`Sheet#setStartRowIndex`æ¥æŒ‡å®šç¬¬ä¸€è¡Œçš„ä½ç½®ï¼Œè¡Œä¸‹æ ‡çš„èŒƒå›´ä¸º`1~${limit}`ï¼Œè¿™é‡Œlimitä¸æ–‡ä»¶æ ¼å¼ç›¸å…³ï¼Œxlsxæ ¼å¼é»˜è®¤æœ€å¤§ä¸‹æ ‡`1_048_576`ï¼Œxlsæœ€å¤§ä¸‹æ ‡`65_536`

`startRowIndex`å’Œ`colIndex`ä¸¤ä¸ªå±æ€§å¯ä»¥æ­é…ä½¿ç”¨ï¼Œä¸‹é¢ä»£ç å±•ç¤ºä»ç¬¬7è¡Œç¬¬4åˆ—å¼€å§‹å†™è¡¨æ ¼

```java
List<RepeatableEntry> list = RepeatableEntry.randomTestData();
int startRowIndex = 7; // æŒ‡å®šèµ·å§‹è¡Œ
new Workbook()
.setAutoSize(true)
.addSheet(new ListSheet<>(list).setStartRowIndex(startRowIndex))
.writeTo(Paths.get("F:/excel/Repeat Columns From 7.xlsx"));

// è¯»å–æ—¶æŒ‡å®šèµ·å§‹è¡Œ
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/Repeat Columns From 7.xlsx"))) {
    List<RepeatableEntry> readList = reader.sheet(0).header(startRowIndex).bind(RepeatableEntry.class).rows()
    .map(row -> (RepeatableEntry) row.get()).collect(Collectors.toList());
}
```

![1734263120104-548345f3-09e3-49dd-93d4-cd32a78c7bbe.jpeg](./img/7urPzaZk-WufFtAp/1734263120104-548345f3-09e3-49dd-93d4-cd32a78c7bbe-031557.jpeg)

é»˜è®¤æƒ…å†µä¸‹æ— è®ºè¡Œå’Œåˆ—çš„å¼€å§‹ä¸‹æ ‡æ˜¯å¤šå°‘ï¼Œæ‰“å¼€æ–‡ä»¶æ—¶è¡¨æ ¼éƒ½ä¼šåœç•™åœ¨å·¦ä¸Šè§’ï¼Œå¦‚æœä¸å¸Œæœ›æ»šåŠ¨åˆ°å·¦ä¸Šè§’åˆ™éœ€è¦åœ¨è°ƒç”¨`setStartRowIndex`æ—¶æŒ‡å®šå‚æ•°`scrollToVisibleArea`ä¸ºfalseï¼Œæ­¤æ—¶æ‰“å¼€æ–‡ä»¶æ—¶æ´»åŠ¨å…‰æ ‡åœ¨`A1`å•å…ƒæ ¼ï¼Œ å› ä¸ºå…‰æ ‡åœç•™åœ¨`A1`æ‰€ä»¥æ‰“å¼€æ–‡ä»¶å¯èƒ½æ— æ³•åœ¨å±å¹•ä¸­çœ‹åˆ°æ•°æ®ï¼Œéœ€è¦æ‰‹åŠ¨æ»šåŠ¨åˆ°æ•°æ®è¡Œï¼Œå®¹æ˜“äº§ç”Ÿæ²¡æœ‰æ•°æ®çš„è¯¯ä¼šï¼Œè¯·è°¨æ…ä½¿ç”¨ã€‚

![1734263129464-ab1f8796-0b19-4968-880b-d8693b39adc8.jpeg](./img/7urPzaZk-WufFtAp/1734263129464-ab1f8796-0b19-4968-880b-d8693b39adc8-972899.jpeg)

## åˆå¹¶å•å…ƒæ ¼

EECé€šè¿‡æ‰©å±•å‚æ•°`merge_cells`æ¥æ·»åŠ åˆå¹¶å•å…ƒæ ¼ï¼Œåˆå¹¶æ˜¯ä½œç”¨äºä¸€ä¸ªåŒºåŸŸï¼Œæ‰€ä»¥ä½¿ç”¨`Dimension`æ¥ä¿å­˜ä¸€ä¸ªåˆå¹¶çš„èµ·å§‹å’Œç»“æŸè¡Œåˆ—ä¿¡æ¯ï¼Œä½ å¯ä»¥åˆå¹¶ä»»æ„å¤šä¸ªå•å…ƒæ ¼ï¼Œå…¶ä¸­åªæœ‰ä¸€ä¸ªé™åˆ¶ï¼Œé‚£å°±æ˜¯åˆå¹¶åçš„å•å…ƒæ ¼**å¯ä»¥ç›¸é‚»ä½†ä¸èƒ½é‡å **

### å†™å…¥

ç¤ºä¾‹ï¼š

```java
List<Dimension> mergeCells = Arrays.asList(Dimension.of("A1:A10"), Dimension.of("B2:E5"));
new Workbook()
.addSheet(new EmptySheet().putExtProp(Const.ExtendPropertyKey.MERGE_CELLS, mergeCells))
.writeTo(Paths.get("F:/excel"));
```

æ•ˆæœå¦‚ä¸‹ï¼š

![1734263817372-6dfc4056-1f04-401d-86ef-068c95220275.jpeg](./img/7urPzaZk-WufFtAp/1734263817372-6dfc4056-1f04-401d-86ef-068c95220275-583739.jpeg)

å¦‚æœå•å…ƒæ ¼æœ‰é‡å ç¨‹åºä¸ä¼šæŠ¥é”™ï¼Œä½†æ‰“å¼€æ–‡ä»¶æ—¶ä¼šå¼¹å‡ºè­¦å‘Šï¼Œå¦‚æœç‚¹å‡»â€œæ˜¯â€å°†ä¼šå°è¯•ä¿®å¤ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä¼šåˆ é™¤äº§ç”Ÿé‡å çš„åˆå¹¶

ä¾‹å¦‚æˆ‘ä»¬å°†ä¸Šé¢çš„ç¬¬äºŒä¸ªåˆå¹¶ä¸­`B2:E5`æ”¹ä¸º`A2:E5`å°†åœ¨A2å•å…ƒæ ¼é‡å ï¼Œæ‰“å¼€æ–‡ä»¶å¦‚ä¸‹å›¾

![1734263825218-339f3ccd-7795-42d4-8047-21851caaf324.jpeg](./img/7urPzaZk-WufFtAp/1734263825218-339f3ccd-7795-42d4-8047-21851caaf324-601845.jpeg)

ç‚¹å‡»â€œæ˜¯â€åå¯ä»¥çœ‹åˆ°ä»…ä¿ç•™äº†ç¬¬ä¸€ä¸ªåˆå¹¶ï¼Œè€Œå°†é€ æˆé‡å çš„ç¬¬äºŒä¸ªåˆå¹¶åˆ é™¤äº†

![1734263831976-71cf9b59-1405-45f3-a32a-4c9480aa24dd.jpeg](./img/7urPzaZk-WufFtAp/1734263831976-71cf9b59-1405-45f3-a32a-4c9480aa24dd-036889.jpeg)

ä½ ä¸èƒ½å¯„å¸Œæœ›åœ¨è‡ªåŠ¨ä¿®å¤ä¸Šï¼Œé‚£æ ·å°†äº§ç”Ÿä¸å¯é¢„æœŸçš„æ•ˆæœï¼ŒEECä¹Ÿä¸ä¼šè¿›è¡Œç›¸å…³æ£€æŸ¥ï¼Œæ‰€ä»¥æœ€å¥½äº‹å…ˆé¢„æ£€ï¼Œå¥½åœ¨æ­¤é¢„æ£€å¹¶ä¸å¤æ‚ã€‚

### è¯»å–

æˆ‘ä»¬çŸ¥é“åˆå¹¶åçš„å€¼åªä¿å­˜åœ¨å·¦ä¸Šçš„ç¬¬ä¸€ä¸ªå•å…ƒæ ¼ä¸­å…¶å®ƒå•å…ƒæ ¼å‡ä¸ºnullï¼ŒEECæä¾›äº†`copy-on-merged`æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šå°†ç¬¬ä¸€ä¸ªå•å…ƒæ ¼çš„å€¼å¤åˆ¶åˆ°å…¶å®ƒå•å…ƒæ ¼ä¸­ä½¿å¾—åˆå¹¶èŒƒå›´å†…çš„æ‰€æœ‰å•å…ƒæ ¼è¯»å–çš„å†…å®¹å®Œå…¨ä¸€æ ·ã€‚

å‡å¦‚æœ‰å¦‚ä¸‹åˆå¹¶å•å…ƒæ ¼

![1734263839150-0c7cbc05-d5c3-435d-97be-fe0879f57760.jpeg](./img/7urPzaZk-WufFtAp/1734263839150-0c7cbc05-d5c3-435d-97be-fe0879f57760-228872.jpeg)

ä½¿ç”¨`reader.sheet(0).rows().forEach(System.out::println)`æ™®é€šè¯»å–ç»“æœå¦‚ä¸‹ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå•å…ƒæ ¼æœ‰å€¼å¤–å…¶ä½™å•å…ƒæ ¼å‡ä¸ºnullï¼Œä¸šåŠ¡ä»£ç éœ€è¦ç‰¹æ®Šå¤„ç†æ‰è¡Œå¦åˆ™å°†ä¸¢å¤±æ•°æ®ã€‚

```java
 ab |  | 
    |  | 
    |  | 
    |  | 
    |  | 
    |  |
```

#### ä½¿ç”¨copy-on-merge

org.ttzero.reader.Sheetå¯ä»¥ä½¿ç”¨`asSheet`ï¼Œ`asMergeSheet`ï¼Œ`asCalcSheet`å’Œ`asFullSheet`ç›¸äº’è½¬æ¢ï¼Œè½¬æ¢åWorksheetå°±æœ‰äº†ä¸åŒçš„åŠŸèƒ½ï¼Œè€ƒè™‘åˆ°æ™®é€šçš„Sheetè¯»å–é€Ÿåº¦æœ€å¿«æ‰€ä»¥è¯·æ ¹æ®éœ€æ±‚é€‰æ‹©ã€‚

```java
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/abc.xlsx"))) {
    // ä½¿ç”¨asMergeSheetè½¬æ¢ä¸ºMergeSheet
    MergeSheet sheet = reader.sheet(0).asMergeSheet();
    // åˆå¹¶å•å…ƒæ ¼ä¿¡æ¯
    Grid mergeGrid = sheet.getMergeGrid();
    // ä½¿ç”¨testæ¥åˆ¤æ–­æŸä¸ªå•å…ƒæ ¼æ˜¯å¦ä¸ºåˆå¹¶å•å…ƒæ ¼
    assert mergeGrid.test(3, 1);

    // è·å–æ‰€æœ‰åˆå¹¶å•å…ƒæ ¼çš„ä½ç½®
    List<Dimension> mergeCells = sheet.getMergeCells();

    // æ‰“å°
    sheet.rows().forEach(System.out::println);
}
```

å¾—åˆ°Gridåå¯ä»¥é€šè¿‡testæ–¹æ³•æ¥æµ‹è¯•å•å…ƒæ ¼æ˜¯å¦ä¸ºåˆå¹¶å•å…ƒæ ¼ï¼Œå¦ä¸€ä¸ªé‡è¦çš„æ–¹å¼ä¸­sizeï¼Œè¯¥æ–¹æ³•è¿”å›åˆå¹¶å•å…ƒæ ¼ä¸ªæ•°ã€‚

ä½¿ç”¨`copy-on-merged`åå°†å¾—åˆ°å¦‚ä¸‹æ•ˆæœ

```java
ab | ab | ab
ab | ab | ab
ab | ab | ab
ab | ab | ab
ab | ab | ab
ab | ab | ab
```

è¿™æ ·æˆ‘ä»¬ä¸éœ€è¦é¢å¤–å¤„ç†null

## è®¾ç½®å¤šè¡Œè¡¨å¤´

EECä»v0.5.3å¼€å§‹æ”¯æŒå¤šè¡¨å¤´å¯¼å‡ºï¼ŒåŒæ ·çš„å¯ä»¥ä½¿ç”¨æ³¨è§£æˆ–è€…æ‰‹åŠ¨æŒ‡å®šä¸¤ç§æ–¹å¼ï¼Œæœ€å¤šæ”¯æŒ10å±‚ã€‚

### ä½¿ç”¨æ³¨è§£

Java Beanå¯ä»¥ä½¿ç”¨å¤šä¸ª`ExcelColumn`æ¥å®ç°ï¼Œå¤šä¸ªExcelColumnçš„é¡ºåºä¸å¯¼å‡ºçš„æœ€ç»ˆè¡¨å¤´å®Œå…¨ä¸€è‡´ï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹:

```java
@ExcelColumn("è®¢å•å·")
private String orderNo;

@ExcelColumn("æ”¶ä»¶äºº")
private String recipient;

@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("çœ")
private String province;

@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("å¸‚")
private String city;

@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("åŒº")
private String area;

@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("è¯¦ç»†åœ°å€")
private String detail;
```

å®šä¹‰å¦‚ä¸ŠJavaå®ä½“ï¼Œåœ¨â€˜çœâ€™ï¼Œâ€˜å¸‚â€™ï¼Œâ€˜åŒºâ€™ï¼Œå’Œâ€˜è¯¦ç»†åœ°å€â€˜4ä¸ªå±æ€§ä¸Šé¢åŠ äº†ä¸€ä¸ªå…±åŒçš„çˆ¶è¡¨å¤´â€˜æ”¶ä»¶åœ°å€â€™ï¼Œæ•ˆæœå¦‚ä¸‹

![1734263941001-f263f0ff-1299-488a-824c-77bda283c9f8.jpeg](./img/7urPzaZk-WufFtAp/1734263941001-f263f0ff-1299-488a-824c-77bda283c9f8-503505.jpeg)

æ›´ä¸ºå¤æ‚çš„ç¤ºä¾‹

```java
@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn
@ExcelColumn("è®¢å•å·")
private String orderNo;

@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn
@ExcelColumn("æ”¶ä»¶äºº")
private String recipient;

@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("çœ")
private String province;

@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("å¸‚")
private String city;

@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("åŒº")
private String area;

@ExcelColumn("TOP")
@ExcelColumn
@ExcelColumn("æ”¶ä»¶åœ°å€")
@ExcelColumn("è¯¦ç»†åœ°å€")
private String detail;
```

æˆ‘ä»¬åœ¨å¤´é¡¶å†åŠ ä¸€ä¸ªå…±åŒçš„è¡¨å¤´â€˜TOPâ€™ï¼Œå±•ç¤ºæ•ˆæœå¦‚ä¸‹

![1734263950664-9cd01659-1e81-49fd-a42c-230fa3a3ef39.jpeg](./img/7urPzaZk-WufFtAp/1734263950664-9cd01659-1e81-49fd-a42c-230fa3a3ef39-574026.jpeg)

### æ‰‹åŠ¨æ·»åŠ 

Columnå¢åŠ `addSubColumn`æ–¹æ³•ç”¨äºæ·»åŠ å­è¡¨å¤´ï¼Œé¡ºåºä¸æ³¨è§£ç›¸ä¼¼ï¼Œç¬¬ä¸€ä¸ªåœ¨æœ€ä¸Šé¢æœ€åä¸€ä¸ªéœ€è¦æŒ‡å®šå­—æ®µåã€‚è¿™ç§æ–¹å¼å¤šç”¨äºListMapSheetå’ŒResultSetSheet

```java
new Workbook().addSheet(new ListSheet<>(data
                                        , new Column("å§“å", "name")
                                        , new Column("æ€§åˆ«", "sex")
                                        , new Column("è¯ä¹¦").addSubColumn(new Column("ç¼–å·", "no"))
                                        , new Column("è¯ä¹¦").addSubColumn(new Column("ç±»å‹", "type"))
                                        , new Column("è¯ä¹¦").addSubColumn(new Column("ç­‰çº§", "level"))
                                        , new Column("å¹´é¾„", "age")
                                        , new Column("æ•™è‚²").addSubColumn(new Column("æ•™è‚²1", "jy1"))
                                        , new Column("æ•™è‚²").addSubColumn(new Column("æ•™è‚²2", "jy2"))))
.writeTo(Paths.get("F:/excel"));
```

![1734263960047-befa5682-e3cc-4293-a347-1fde4b00fa16.jpeg](./img/7urPzaZk-WufFtAp/1734263960047-befa5682-e3cc-4293-a347-1fde4b00fa16-262885.jpeg)

### è¯»å–å¸¦å¤šè¡Œè¡¨å¤´çš„æ–‡ä»¶

v0.5.6å¼€å§‹EECæ”¯æŒæŒ‡å®šè¡¨å¤´ä½ç½®ï¼Œä½ å¯ä»¥é€šè¿‡`Sheet#header(fromRowNum, toRowNum)`æ¥æŒ‡å®šè¡¨å¤´ï¼Œ`header`æ–¹æ³•æ”¯æŒ`fromRowNum`å’Œ`toRowNum`ä¸¤ä¸ªå‚æ•°ï¼Œä¸ºäº†æ›´åŠ ç›´è§‚è¿™ä¸¤ä¸ªå‚æ•°å‡ä»1å¼€å§‹ï¼Œå’Œæ‰“å¼€excelæ‰€çœ‹åˆ°çš„ä¸€æ ·ï¼ŒåŒæ—¶fromå’Œtoä¸¤ç«¯éƒ½æ˜¯åŒ…å«çš„ï¼Œå¯¹äºå¤šè¡Œè¡¨å¤´æ¥è¯´headerå°†ä»¥`A1:A2:A3`è¿™ç§æ ¼å¼è¿›è¡Œçºµå‘æ‹¼æ¥

æˆ‘ä»¬æ‹¿ä¸Šé¢ã€æ‰‹åŠ¨æ·»åŠ ã€‘çš„æ–‡ä»¶ä¸ºä¾‹å­æ¥å±•ç¤ºå¦‚ä½•ä½¿ç”¨headeræ¥æ”¯æŒå¤šè¡¨å¤´ï¼Œæˆ‘ä»¬åªéœ€è¦è®¾ç½®header(1, 2)æŒ‡å®šä¸¤è¡Œè¡¨å¤´å³å¯`reader.sheet(0).header(1, 2).dataRows().map(Row::toMap).forEach(System.out::println)`ï¼Œé€šè¿‡è¿™ä¸ªå‘½ä»¤å¯è¾“å…¥å¦‚ä¸‹ç»“æœ

```java
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=æ•°å­¦, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²b}
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²a, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
{å§“å=æš—æœˆæœˆ, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=30, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
{å§“å=å¼ ä¸‰, æ€§åˆ«=å¥³, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=è‹±è¯­, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=20, æ•™è‚²:æ•™è‚²1=æ•™è‚²d, æ•™è‚²:æ•™è‚²2=æ•™è‚²d}
{å§“å=å¼ ä¸‰, æ€§åˆ«=å¥³, è¯ä¹¦:ç¼–å·=5, è¯ä¹¦:ç±»å‹=ç‰©ç†, è¯ä¹¦:ç­‰çº§=7, å¹´é¾„=20, æ•™è‚²:æ•™è‚²1=æ•™è‚²x, æ•™è‚²:æ•™è‚²2=æ•™è‚²x}
{å§“å=æå››, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=è¯­æ–‡, è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=24, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=æå››, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=3, è¯ä¹¦:ç±»å‹=å†å², è¯ä¹¦:ç­‰çº§=1, å¹´é¾„=24, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
{å§“å=ç‹äº”, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=1, è¯ä¹¦:ç±»å‹=é«˜æ•°, è¯ä¹¦:ç­‰çº§=2, å¹´é¾„=28, æ•™è‚²:æ•™è‚²1=æ•™è‚²c, æ•™è‚²:æ•™è‚²2=æ•™è‚²a}
{å§“å=ç‹äº”, æ€§åˆ«=ç”·, è¯ä¹¦:ç¼–å·=2, è¯ä¹¦:ç±»å‹=JAvA, è¯ä¹¦:ç­‰çº§=3, å¹´é¾„=28, æ•™è‚²:æ•™è‚²1=æ•™è‚²b, æ•™è‚²:æ•™è‚²2=æ•™è‚²c}
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸­é—´åˆå¹¶çš„è¡¨å¤´è¡¨ç°ä¸º`è¯ä¹¦:ç¼–å·, è¯ä¹¦:ç±»å‹, è¯ä¹¦:ç­‰çº§`ï¼Œå¦‚æœJava beanä½¿ç”¨EECæ³¨è§£çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥è½¬å¯¹è±¡`reader.sheet(0).header(1, 2).dataRows().map(row -> row.to(Order.class)).forEach(Print::println)`å’Œå•è¡Œè¡¨å¤´å®Œå…¨ä¸€æ ·

### è‡ªå®šä¹‰è¡¨å¤´

v0.5.6åŒæ ·ä¹Ÿæ”¯æŒè‡ªå®šä¹‰è¡¨å¤´ï¼Œå¦‚æœè‡ªåŠ¨è§£æè¡¨å¤´æœ‰é—®é¢˜åˆ™å¯ä»¥è®¾ç½®è‡ªå®šä¹‰è¡¨å¤´

```java
// åˆ›å»ºè‡ªå®šä¹‰è¡¨å¤´
org.ttzero.excel.reader.Row headerRow2 = new org.ttzero.excel.reader.Row() {};
Cell[] cells2 = new Cell[8];
cells2[0] = new Cell((short) 1).setSv("å§“å");
cells2[1] = new Cell((short) 2).setSv("æ€§åˆ«");
cells2[2] = new Cell((short) 3).setSv("è¯ä¹¦:ç¼–å·");
cells2[3] = new Cell((short) 4).setSv("è¯ä¹¦:ç±»å‹");
cells2[4] = new Cell((short) 5).setSv("è¯ä¹¦:ç­‰çº§");
cells2[5] = new Cell((short) 6).setSv("å¹´é¾„");
cells2[6] = new Cell((short) 7).setSv("æ•™è‚²:æ•™è‚²1");
cells2[7] = new Cell((short) 8).setSv("æ•™è‚²:æ•™è‚²2");
headerRow2.setCells(cells2);
// ä½¿ç”¨è‡ªå®šä¹‰è¡¨å¤´
reader.sheet(0).reset().header(2).bind(Object.class, new HeaderRow().with(2, headerRow2))
.rows().map(Row::toMap).forEach(System.out::println);
```

## å…³äºè‡ªé€‚åº”åˆ—å®½

v0.5.3ç‰ˆæœ¬å¤§å¹…ä¼˜åŒ–äº†è‡ªé€‚åº”åˆ—å®½è®¡ç®—æ–¹å¼ï¼Œä½¿å¾—åœ¨**é»˜è®¤å­—ä½“**ä¸‹åˆ—å®½æ›´åŠ ç²¾å‡†ï¼Œç›¸å¯¹äºPOIçš„è‡ªé€‚åº”ç»“æœEECå¯¹ä¸­æ–‡å¤„ç†æ›´ç²¾å‡†ï¼ŒEECè®¾ç½®è‡ªé€‚åº”åˆ—å®½åªéœ€è¦è°ƒç”¨`setAutoSize`å³å¯ã€‚

**v0.5.12**ç‰ˆæœ¬è¿›ä¸€æ­¥ä¼˜åŒ–å­—ä½“å®½åº¦è®¡ç®—é€»è¾‘ï¼Œé™¤äº†æ”¯æŒâ€œå®‹ä½“11å·â€å­—ä½“å¤–ç°åœ¨æ”¯æŒç»å¤§éƒ¨åˆ†å­—ä½“å’Œå­—å·ï¼ŒåŒæ—¶è¿˜ä¼˜åŒ–äº†è‡ªåŠ¨æŠ˜è¡Œæ—¶è®¡ç®—é€»è¾‘ï¼Œå‡çº§åå°†åˆ†ç»„è®¡ç®—æ¯æ®µæ–‡æœ¬å®½åº¦å–æœ€å¤§å€¼ï¼Œ è€Œä¸æ˜¯å½“åšä¸€ä¸ªé•¿å­—ç¬¦ä¸²å¤„ç†

### é»˜è®¤å­—ä½“

```java
// æµ‹è¯•ç±»
public static class WidthTestItem {
    @ExcelColumn(value = "æ•´å‹", format = "#,##0_);[Red]-#,##0_);0_)")
    private Integer nv;
    @ExcelColumn("å­—ç¬¦ä¸²(en)")
    private String sen;
    @ExcelColumn("å­—ç¬¦ä¸²(ä¸­æ–‡)")
    private String scn;
    @ExcelColumn(value = "æ—¥æœŸæ—¶é—´", format = "yyyy-mm-dd hh:mm:ss")
    private Timestamp iv;
}

new Workbook()
.setAutoSize(true) // <- è‡ªé€‚åº”åˆ—å®½
.addSheet(new ListSheet<>(randomTestData()))
.writeTo(Paths.get("F:/excel"));
```

![1734273269778-693ad31c-7ed2-4c3c-bc4b-b4089795b1ef.jpeg](./img/7urPzaZk-WufFtAp/1734273269778-693ad31c-7ed2-4c3c-bc4b-b4089795b1ef-182446.jpeg)

### è‡ªå®šä¹‰å­—ä½“

ä¸‹é¢ä¿®æ”¹4åˆ—çš„4ç§å­—ä½“å’Œå­—å·ï¼Œçœ‹ä¸€ä¸‹è‡ªé€‚åº”åˆ—å®½çš„æ•ˆæœ

```java
new Workbook()
.setAutoSize(true) // <- è‡ªé€‚åº”åˆ—å®½
.addSheet(new ListSheet<>(randomTestData()
                          , new Column("æ•´å‹", "nv").setNumFmt("#,##0_);[Red]-#,##0_);0_)").setFont(new Font("Bauhaus 93", 16))
                          , new Column("å­—ç¬¦ä¸²(EN)", "sen").setFont(new Font("Trebuchet MS", 20))
                          , new Column("å­—ç¬¦ä¸²(ä¸­æ–‡)", "scn").setFont(new Font("å¾®è½¯é›…é»‘", 8))
                          , new Column("æ—¥æœŸ", "iv").setNumFmt("yyyy-mm-dd hh:mm:ss").setFont(new Font("åæ–‡è¡Œæ¥·", 14))
                         )).writeTo(Paths.get("F:/excel"));
```

![1734273752912-ee520104-36a2-4023-a6d0-0ea36a38579c.jpeg](./img/7urPzaZk-WufFtAp/1734273752912-ee520104-36a2-4023-a6d0-0ea36a38579c-663462.jpeg)

ä¼˜åŒ–åæ•ˆæœçœ‹ä¸Šå»è¿˜ä¸é”™ï¼Œå½“ç„¶ä¹Ÿæœ‰ä¸€äº›å­—ä½“è®¡ç®—å‡ºæ¥çš„ç»“æœä¸å®é™…æ˜¾ç¤ºæ•ˆæœå¯èƒ½æœ‰å¾ˆå¤§åå·®ï¼Œæ­¤æ—¶å¯ä»¥è¦†å†™XMLWorksheetWriter#stringWidthæ–¹æ³•è°ƒæ•´ï¼Œ å†…éƒ¨ä½¿ç”¨`SwingUtilities2.getFontMetrics#stringWidth`æ–¹æ³•è®¡ç®—å­—ç¬¦ä¸²å®½åº¦ã€‚æµ‹è¯•å‘ç°windowsç³»ç»Ÿè‡ªå¸¦çš„ä¸­æ–‡å­—ä½“å‡èƒ½å¾ˆå¥½çš„é€‚åº”ï¼Œ ä½†å‡ ä¹æ‰€æœ‰çš„è‹±æ–‡å­—ä½“å‡æ— æ³•æ­£å¸¸é€‚åº”è¦ä¹ˆæ— æ³•é€‚åº”ä¸­æ–‡è¦ä¹ˆæ— æ³•é€‚åº”è‹±æ–‡æ‰€ä»¥è°ƒæ•´èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒéº»çƒ¦ï¼ŒEECä¹Ÿåªèƒ½å–å·§å¤„ç†ã€‚

### Number Formatåˆ—å¦‚ä½•è®¡ç®—å®½åº¦

å¦‚æœæ ¼å¼åŒ–çš„åˆ—ä½¿ç”¨ä¸Šé¢çš„è®¡ç®—æ–¹æ³•å°±ä¸å‡†ç¡®äº†ï¼Œæ ¼å¼åŒ–åçš„å­—ç¬¦ä¸²åŸºæœ¬ä¼šåœ¨åŸå­—ç¬¦ä¸²ä¸ŠåŠ ä¸€äº›åˆ†éš”ç¬¦ï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´æ ¼å¼åŒ–åçš„é•¿åº¦æ¯”åŸé•¿åº¦æ›´é•¿ï¼Œæ¯”å¦‚æœ€å¸¸è§çš„æ•°å­—æ ¼å¼åŒ–`#,##0`ï¼Œå®ƒçš„ä½¿ç”¨æ˜¯æ¯3ä½åŠ ä¸€ä¸ªé€—å·ï¼Œ åˆ—å®½ä¸æ•°å­—å¤§å°æˆæ­£æ¯”ï¼Œæ•°å­—è¶Šå¤§æ·»åŠ çš„é€—å·è¶Šå¤šå®½åº¦è¶Šå¤§ã€‚

æœ€ç»ˆçš„åˆ—å®½ä¸æ¯ä¸ªæ ¼å¼ç›¸å…³ï¼Œæ‰€ä»¥è®¡ç®—åˆ—å®½çš„æ–¹æ³•ä¹Ÿåœ¨NumFmtå®ä¾‹ä¸­ï¼Œè‡ªå®šä¹‰æ ¼å¼åŒ–éœ€è¦é‡å†™`calcNumWidth`æ–¹æ³•æ¥å¾®è°ƒï¼Œè®¡ç®—æ–¹æ³•å¯ä»¥å‚è€ƒ`NumFmt#calcNumWidth`é€šç”¨è®¡ç®—æ–¹æ³•ã€‚

```java
new Workbook()
.setAutoSize(true)
.addSheet(new ListSheet<>(expectList
                          , new Column().setNumFmt(new NumFmt("yyyy-mm-dd hh:mm:ss") { // <-- è®¾ç½®NumFmtæ—¶é‡ç½®è®¡ç®—æ–¹æ³•
                              @Override
                              public double calcNumWidth(double base, Font font) {
                                  // TODO æ ¹æ®å­—ä½“å’Œå­—å·è®¡ç®—å®½åº¦
                                  return super.calcNumWidth(base, font);
                              }
                          })
                         )).writeTo(Paths.get("F:/excel"));
```

### æŒ‡å®šå•åˆ—è‡ªé€‚åº”å®½åº¦

é™¤åœ¨å·¥ä½œè¡¨æ‰€æœ‰åˆ—è‡ªé€‚åº”å¤–è¿˜æ”¯æŒå•åˆ—è‡ªé€‚åº”ï¼Œå¯åœ¨åˆ›å»ºåˆ—çš„æ—¶å€™æŒ‡å®šæŸåˆ—è‡ªé€‚åº”åˆ—å®½`new Column().autoSize()`

```java
new Workbook()
.addSheet(new ListSheet<>("æœŸæœ«æˆç»©", expectList
                          , new Column("å­¦å·", "id")
                          , new Column("å§“å", "name").autoSize() // <-å•åˆ—è‡ªé€‚åº”
                          , new Column("æˆç»©", "score")
                         )
         ).writeTo(Paths.get("F:/excel"));
```

![1734273765271-2c3a4fd0-82ec-4196-b394-b8f4c739cb5e.jpeg](./img/7urPzaZk-WufFtAp/1734273765271-2c3a4fd0-82ec-4196-b394-b8f4c739cb5e-433262.jpeg)

### æˆ´ä¸Šç´§ç®å’’å§

è‡ªé€‚åº”åˆ—å®½åœ¨æŸç§ç¨‹åº¦ä¸Šæ¥è¯´å¯ä»¥ä½¿æ–‡æ¡£æ›´ç¾è§‚ï¼Œä½†å¦‚æœæŸä¸ªå•å…ƒæ ¼æ–‡å­—å¤ªé•¿ä¼šè®©æ¥¼æ­ªæ‰ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç»™å®ƒæˆ´ä¸Šä¸€ä¸ªç´§ç®å’’ï¼Œä¸èƒ½è®©å®ƒè¶…è¿‡æˆ‘ä»¬è®¾å®šçš„èŒƒå›´ï¼Œ è¿™ä¸ªè®¾å®šæ˜¯é€šè¿‡ExcelColumnæ³¨è§£çš„maxWidthå±æ€§å®ç°ï¼ŒColumnä¹Ÿå¯ä»¥ä½¿ç”¨widthå±æ€§é™å®šï¼Œæˆ‘ä»¬çœ‹ä¸‹æ•ˆæœï¼š

![1734273774761-c1c2fe84-bdcf-4294-b02a-724234f68d5b.jpeg](./img/7urPzaZk-WufFtAp/1734273774761-c1c2fe84-bdcf-4294-b02a-724234f68d5b-279182.jpeg)

å·¦è¾¹æ˜¯è‡ªé€‚åº”åˆ—å®½ï¼Œå³è¾¹æ˜¯è‡ªé€‚åº”åˆ—å®½+MaxWidth+Wrapçš„æ•ˆæœï¼Œå³è¾¹çš„æ•ˆæœåªéœ€è¦æ·»åŠ `@ExcelColumn(maxWidth = 20D, wrapText = true)`å±æ€§å³å¯ã€‚

### å¤šä¸ªå±æ€§é—´çš„ç»„åˆé€»è¾‘

å½“å‰è®¾ç½®åˆ—å®½æœ‰2ä¸ªå±æ€§ï¼Œåˆ†åˆ«æ˜¯auto-sizeå’Œwidthï¼Œç»„åˆæ•ˆæœå¦‚ä¸‹

| auto-size | width | æ•ˆæœ |
| --- | --- | --- |
| - | - | é»˜è®¤å›ºå®šå®½åº¦ |
| TRUE | - | è‡ªé€‚åº”å®½åº¦ |
| - | 10 | å›ºå®šå®½åº¦10 |
| TRUE | 10 | min(è‡ªé€‚åº”å®½åº¦,10) |
| FALSE | - | é»˜è®¤å›ºå®šå®½åº¦ |
| FALSE | 10 | å›ºå®šå®½åº¦10 |

## æ‰¹æ³¨

è¡¨å¤´æ‰¹æ³¨å¯ä»¥ä½¿ç”¨æ³¨é‡Š`HeaderComment`æˆ–åˆ›å»ºColumnæŒ‡å®š`new Column().setHeaderComment()`ï¼Œæ‰¹å®šæ‰¹æ³¨æ—¶è¿˜å¯ä»¥é¢å¤–æŒ‡å®šå®½åº¦å’Œé«˜åº¦

### ä½¿ç”¨æ³¨è§£

```java
public static class Stock {
    @ExcelColumn("åº“å­˜")
    private int stock;
    @ExcelColumn(value = "åº“å­˜å¥åº·åº¦", comment = @HeaderComment(value =
                                                           "å¥åº·ï¼šåº“å­˜å¤§äºé˜ˆå€¼20%\n" +
                                                           "æ­£å¸¸ï¼šåº“å­˜é«˜äºé˜ˆå€¼10%\n" +
                                                           "è­¦å‘Šï¼šåº“å­˜é«˜äºé˜ˆå€¼0ï½10%\n" +
                                                           "å±é™©ï¼šåº“å­˜ä½äºé˜ˆå€¼10%", width = 120))
    private StockHealth stockHealth;
}

// ç”Ÿæˆæµ‹è¯•æ•°æ®
List<Stock> list = new ArrayList<>();
list.add(new Stock(60, StockHealth.HEALTHY));
list.add(new Stock(40, StockHealth.NORMAL));
list.add(new Stock(10, StockHealth.DANGER));
// å¯¼å‡º
new Workbook().addSheet(new ListSheet<>(list)).writeTo(Paths.get("F:/excel/æ‰¹æ³¨æµ‹è¯•.xlsx"));
```

![1734273829273-7833c7fb-766c-4247-b18a-04c5bf4438c6.jpeg](./img/7urPzaZk-WufFtAp/1734273829273-7833c7fb-766c-4247-b18a-04c5bf4438c6-638192.jpeg)

### ä½¿ç”¨Column#setHeaderCommentæ·»åŠ 

```java
new Workbook().addSheet(new ListSheet<>(list)
                        .setColumns(new Column("åº“å­˜", "stock")
                                    , new Column("åº“å­˜å¥åº·åº¦", "stockHealth")
                                    .setHeaderComment(new Comment(null,
                                                                  "å¥åº·ï¼šåº“å­˜å¤§äºé˜ˆå€¼20%\n" +
                                                                  "æ­£å¸¸ï¼šåº“å­˜é«˜äºé˜ˆå€¼10%\n" +
                                                                  "è­¦å‘Šï¼šåº“å­˜é«˜äºé˜ˆå€¼0ï½10%\n" +
                                                                  "å±é™©ï¼šåº“å­˜ä½äºé˜ˆå€¼10%", 120., 60.))))
.writeTo(Paths.get("F:/excel/æ‰¹æ³¨æµ‹è¯•.xlsx"));
```

### ä½¿ç”¨addCommentæ‰‹åŠ¨æ·»åŠ æ‰¹æ³¨

é¦–å…ˆéœ€è¦ä»Sheetæ‹¿åˆ°Commentsï¼ŒCommentsæ˜¯ä¸€ä¸ªé›†åˆä½“å®ƒå¯ä»¥åŒ…å«å¤šä¸ªæ‰¹æ³¨ï¼Œç›®å‰Commentå¯¹è±¡è®¾è®¡ä¸å¤ªå‹å¥½ï¼Œåªèƒ½é€šè¿‡refæŒ‡å®šä½ç½®æ²¡æœ‰åŠæ³•æŒ‡å®šrowå’ŒcolæŒ‡å®šä½ç½®ï¼Œå½“ç„¶å¤´éƒ¨æ‰¹æ³¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•æ·»åŠ ï¼Œæ­¤æ–¹æ³•æ›´åŠ çµæ´»ã€‚

```plain
Workbook workbook = new Workbook();
ListSheet listSheet = new ListSheet<>(list);
// è·å–Comments
Comments comments = listSheet.createComments();
// A2å•å…ƒæ ¼æ·»åŠ æ‰¹æ³¨
comments.addComment("A2", null, "å®é™…åº“å­˜");
// B4å•å…ƒæ ¼æ·»åŠ æ‰¹æ³¨
comments.addComment("B4", "åº“å­˜ä¸è¶³", "åº•äºè­¦æˆ’çº¿13%,è¯·å°½å¿«æ·»åŠ åº“å­˜");
workbook.addSheet(listSheet);
workbook.writeTo(Paths.get("F:/excel/æ‰¹æ³¨æµ‹è¯•.xlsx"));
```

![1734273837925-11bf7c7f-cce2-4046-9ecd-cb1d104c24d8.jpeg](./img/7urPzaZk-WufFtAp/1734273837925-11bf7c7f-cce2-4046-9ecd-cb1d104c24d8-946378.jpeg)

### å®æˆ˜

åœºæ™¯ï¼šå¯¼å…¥å¹¶æ ¡éªŒæ•°æ®æ˜¯å¦åˆè§„ï¼Œæ•°æ®ä¸åˆè§„æ—¶åœ¨å¯¹åº”çš„Cellä¸Šæ›´æ”¹å­—ä½“å’ŒèƒŒæ™¯é¢œè‰²ä¸”é€šè¿‡æ‰¹æ³¨æ·»åŠ å¼‚å¸¸ä¿¡æ¯

1. æå‰æ£€æŸ¥æ•°æ®æ˜¯å¦åˆè§„ï¼Œå¦‚æœå…¨éƒ¨åˆè§„å°±æ‰§è¡Œå¯¼å…¥ï¼Œå¦‚æœæœ‰ä¸€æ¡ä¸åˆè§„å°±æå‰ä¸­æ–­å¹¶åˆ›å»ºExcel
2. ä½¿ç”¨TemplateSheetæ¨¡æ¿å·¥ä½œè¡¨åšä¸ºè¾“å‡ºæºï¼Œè¿™æ ·å¯ä»¥æœ€å¤§é™åº¦ä¿ç•™åŸå§‹æ–‡ä»¶æ ·å¼
3. æ£€æŸ¥æ•°æ®è¡Œå¹¶æŒ‰éœ€ä¿®æ”¹â€œå­—ä½“â€ï¼Œâ€œå¡«å……è‰²â€ä»¥åŠtooltips

```java
public void testDataCheck() throws IOException {
try (ExcelReader reader = ExcelReader.read(Paths.get("F:/excel/students.xlsx"))) {
    // æå‰æ£€æŸ¥æ•°æ®æ˜¯å¦åˆè§„ï¼ˆä»»æ„ä¸€æ¡ä¸åˆè§„å°±ä¸­æ–­ï¼‰
    boolean invalid = reader.sheet(0).dataRows().map(row -> row.too(Student.class)).anyMatch(e -> !check(e));

    // æ£€æŸ¥æ­£å¸¸çš„æƒ…å†µä¸‹å¤„ç†å¯¼å…¥
    if (!invalid) {
        // TODO æ­£å¸¸ä¸šåŠ¡å¤„ç†
    } else {
        // åŒ…å«ä¸åˆè§„çš„æ•°æ®åˆ™åˆ›å»ºä¸€ä¸ªExcel
        new Workbook().addSheet(new TemplateSheet(Paths.get("F:/excel/students.xlsx")) {
            @Override
            protected void resetBlockData() {
                super.resetBlockData();

                // è·å–æ ·å¼è¡¨
                Styles styles = workbook.getStyles();

                // å†æ¬¡å…¨é¢æ£€æŸ¥æ‰€æœ‰è¡Œæ•°æ®
                for (int i = 0, position = rowBlock.position(); i < position; i++) {
                    org.ttzero.excel.entity.Row row = rowBlock.get(i);
                    Cell[] cells = row.getCells();

                    // æ£€æŸ¥å¿…è¦åˆ—

                    // æ£€æŸ¥â€œå§“åâ€ï¼ˆè®¾å®šç¬¬2åˆ—ä¸ºâ€œå§“åâ€
                    Cell cell = cells[1];
                    String v = checkName(cell.stringVal);
                    // "å§“å"ä¸åˆè§„
                    if (v != null) {
                        // è·å–åŸå§‹æ ·å¼
                        int style = styles.getStyleByIndex(cell.xf);
                        // ä¿®æ”¹å­—ä½“
                        // å¦‚æœä»…ä»…æ˜¯æ”¹å­—ä½“æ ·å¼ï¼Œæ¯”å¦‚æ”¹ä¸ºçº¢è‰²ï¼ŒåŠ ç²—ï¼Œæ–œä½“ç­‰å¯ä»¥å…ˆè·å–åŸå§‹å­—ä½“ç„¶åå†ä¿®æ”¹
                        Font font = styles.getFont(style); // æ³¨æ„ï¼šè¿™é‡Œæ‹¿åˆ°çš„æ˜¯å­—ä½“çš„å¼•ç”¨ï¼Œä¿®æ”¹å‰å¿…é¡»cloneä¸€ä»½æ–°å­—ä½“
                        // ä¿®æ”¹å­—ä½“æ ·å¼ - æ”¹ä¸ºæ–œä½“
                        style = styles.modifyFont(style, font.clone().italic()); // <- æ³¨æ„è¿™é‡Œcloneäº†åŸå§‹å­—ä½“ç„¶åå†æ”¹ä¸ºæ–œä½“ï¼Œå¦‚æœä¸cloneåˆ™å°†ä¿®æ”¹æ‰€æœ‰ä½¿ç”¨åŸå§‹å­—ä½“çš„å•å…ƒæ ¼

                        // ä¿®æ”¹å¡«å……è‰² - æ”¹ä¸ºæ©™è‰²
                        style = styles.modifyFill(style, new Fill(Color.ORANGE));

                        // æ·»åŠ è¿›æ ·å¼è¡¨å¹¶ä¿®æ”¹å•å…ƒæ ¼æ ·å¼
                        cell.xf = styles.of(style);

                        // æ·»åŠ tooltips
                        createComments().addComment(new String(int2Col(2)) + (row.getIndex() + 1), new Comment("", v)); // int2Col(2) å°†ç¬¬2åˆ—è½¬ä¸ºExcelçš„refå€¼ä¹Ÿå°±æ˜¯'B'
                    }
                }
            }
        }.setPrefix("$#@!$")).writeTo(Paths.get("F:/excel/student-checked.xlsx"));
    }
}
}
```

æ•ˆæœå¦‚ä¸‹

![1734273851176-0ad99098-77d9-4c1f-9aed-a45497d9bf45.jpeg](./img/7urPzaZk-WufFtAp/1734273851176-0ad99098-77d9-4c1f-9aed-a45497d9bf45-436711.jpeg)

ç›®å‰ç‰ˆæœ¬æš‚æ—¶ä¸æ”¯æŒè¯»å–æ‰¹æ³¨ï¼Œæ•¬è¯·å…³æ³¨

## è¯»å–Excelä¸­çš„å›¾ç‰‡

å¯¼å‡ºå›¾ç‰‡è¯·æŸ¥çœ‹ç« èŠ‚    å¯¼å‡ºExcel#å¯¼å‡ºå›¾ç‰‡

ä»v0.4.12ç‰ˆæœ¬å¼€å§‹æ”¯æŒè¯»å–excelæ–‡ä»¶ä¸­çš„å›¾ç‰‡ï¼Œç›®å‰æœ‰ä¸¤ç§é€”å¾„è·å–å›¾ç‰‡ä¿¡æ¯ï¼Œä¸€æ˜¯ä»ExcelReaderä¸­è·å–æ‰€æœ‰å›¾ç‰‡ï¼Œå¦ä¸€ä¸ªæ˜¯ä»å„Worksheetä¸­è·å–å½“å‰WorksheetåŒ…å«çš„å›¾ç‰‡ã€‚

**v0.5.12**æ”¯æŒè¯»å–POIçš„å†…åµŒå›¾ç‰‡ï¼Œè¯»å–æ–¹æ³•ä¸å˜`listPictures`å°†è¿”å›æ‰€æœ‰å›¾ç‰‡

```java
// ä»Workbookä¸­è·å–æ‰€æœ‰å›¾ç‰‡
List<Drawings.Picture> pictures = reader.listPictures();

// å–ç¬¬ä¸€ä¸ªworksheetä¸­åŒ…å«çš„å›¾ç‰‡
List<Drawings.Picture> pictures = reader.sheet(0).listPictures();
```

è¿”å›çš„`Drawings.Picture`ç±»å‹ï¼ŒåŒ…å«Worksheetï¼Œä½ç½®ï¼Œæœ¬åœ°ä¸´æ—¶è·¯å¾„ï¼Œç½‘ç»œå›¾ç‰‡URLï¼ˆå¦‚æœæ˜¯è”æœºå›¾ç‰‡ï¼‰ä»¥åŠæ˜¯å¦ä¸ºèƒŒæ™¯å›¾ç‰‡ç­‰ä¿¡æ¯ï¼Œæ‹¿åˆ°æœ¬åœ°ä¸´æ—¶è·¯å¾„åå°±å¯ä»¥å°†å›¾ç‰‡å¤åˆ¶åˆ°å…¶å®ƒä»»æ„ä½ç½®ï¼Œå¦å¤–è¿™é‡Œçš„ä½ç½®ä¿¡æ¯æ˜¯å›¾ç‰‡å·¦ä¸Šå’Œå³ä¸‹åœ¨å•å…ƒæ ¼çš„è¡Œåˆ—ä½ç½®ï¼Œå¯¹è±¡ä¸º`Dimension`å®ƒåŒ…å«"é¦–è¡Œ", "é¦–åˆ—", "æœ«è¡Œ", "æœ«åˆ—" 4ä¸ªä½ç½®ï¼Œä¾‹å¦‚ï¼šä¸‹å›¾ä¸­å›¾ç‰‡åœ¨worksheetçš„ä½ç½®ä¸º`C39:H52`

![1734273904514-a5456e97-4f11-487b-8011-747bf617db74.jpeg](./img/7urPzaZk-WufFtAp/1734273904514-a5456e97-4f11-487b-8011-747bf617db74-293907.jpeg)

ä¸‹é¢æ–¹æ³•å®ç°å›¾ç‰‡å¤åˆ¶åŠŸèƒ½

```java
// From workbook
List<Drawings.Picture> pictures = reader.listPictures();

// å¦‚æœexcelä¸åŒ…å«å›¾ç‰‡åˆ™picturesä¸ºNULLï¼Œæ‰€ä»¥é˜²æ­¢NPEè¿™é‡Œåˆ¤æ–­pictures
if (pictures != null) {
    // Copy images
    for (Drawings.Picture pic : pictures) {
        // å°†å›¾ç‰‡å¤åˆ¶åˆ°dç›˜
        Path dest = Paths.get("F:/excel", pic.sheet.getName(), pic.localPath.getFileName().toString());
        if (!Files.exists(dest.getParent())) FileUtil.mkdir(dest.getParent());
        Files.copy(pic.localPath, dest, StandardCopyOption.REPLACE_EXISTING);
    }
}
```

v0.4.13æ”¯æŒxlsçš„å›¾ç‰‡è¯»å–ï¼Œæ–¹æ³•ä¸xlsxå®Œå…¨ä¸€æ ·

![1734273912028-3ae07df6-aa10-40e8-b736-7699e9e8715f.jpeg](./img/7urPzaZk-WufFtAp/1734273912028-3ae07df6-aa10-40e8-b736-7699e9e8715f-122612.jpeg)

xlså›¾ç‰‡ä¿å­˜åœ¨Workbook globalsé‡Œï¼Œå®ƒå¤„äºWroksheetä¹‹å‰ï¼Œä½†æ˜¯é€šè¿‡è§£æglobalså¹¶ä¸çŸ¥é“å›¾ç‰‡ç”±å“ªä¸ªWorksheetå¼•ç”¨ï¼Œå¼•ç”¨ä¿¡æ¯(åŒ…å«ä½ç½®ä¿¡æ¯)å­˜åœ¨äºå„ä¸ªWorksheetçš„æœ«å°¾ï¼Œä¸ºäº†é¿å…è¿‡åº¦è§£æï¼Œé»˜è®¤åªè®°å½•globalé‡Œå›¾ç‰‡çš„èµ·å§‹ä½ç½®ï¼Œè°ƒç”¨`#listPictures`æ–¹æ³•æ—¶æ‰ä¼šè§£æå›¾ç‰‡ï¼Œè°ƒç”¨`Picture#getSheet()`æˆ–è€…`Picture#getDimension()`æ—¶è§£æå¼•ç”¨ä¿¡æ¯ã€‚

_æ³¨æ„ï¼šæœ¬åœ°ä¸´æ—¶è·¯å¾„åœ¨å…³é—­ExcelReaderåä¼šè‡ªåŠ¨æ¸…é™¤ï¼Œå¦‚æœæƒ³è¦æ°¸ä¹…ä¿å­˜å›¾ç‰‡åˆ™éœ€è¦å°†å…¶å¤åˆ¶åˆ°å…¶å®ƒåœ°æ–¹_

## è¯»å–å•å…ƒæ ¼æ ·å¼

EECä»v0.5.6å¼€å§‹æ”¯æŒè¯»å–å•å…ƒæ ¼æ ·å¼ï¼ŒRowå¯¹è±¡æä¾›`getCellStyle`æ–¹æ³•è·å–å•å…ƒæ ¼æ ·å¼ï¼Œæ­¤æ ·å¼ä»…è¿”å›ä¸€ä¸ªintå€¼è¡¨ç¤ºæ ·å¼ç´¢å¼•ï¼Œå¦‚æœè¦è·å¾—å…·ä½“çš„æ ·å¼ï¼Œ ä½ éœ€è¦ä»Styleså¯¹è±¡ä¸­è°ƒç”¨å…·ä½“çš„`getFont`ï¼Œ`getFill`ï¼Œ`getNumFmt`ï¼Œ`getBorder`ï¼Œ`getVertical`ï¼Œ`getHorizontal`æ¥åˆ†åˆ«è·å– å­—ä½“ï¼Œå¡«å……ï¼Œæ ¼å¼åŒ–ï¼Œè¾¹æ¡†ï¼Œå‚ç›´å¯¹é½ï¼Œæ°´å¹³å¯¹é½ 6ä¸ªæ ·å¼

```java
// ç¬¬ä¸€æ­¥ è·å–Styleså¯¹è±¡
Styles styles = row.getStyles();

// ç¬¬äºŒæ­¥ è·å–æŒ‡å®šå•å…ƒæ ¼æ ·å¼
int style = row.getCellStyle(cell);

// è·å–å­—ä½“
Font font = styles.getFont(style);

// è·å–è¾¹æ¡†
Border border = styles.getBorder(style);

// è·å–å¡«å…… 
Fill fill = styles.getFill(style);

// è·å–æ ¼å¼åŒ–
NumFmt fmt = styles.getNumFmt(style);

// æ°´å¹³å¯¹é½
String horizontal = Horizontals.of(styles.getHorizontal(style))

// å‚ç›´å¯¹é½
String vertical = Verticals.of(styles.getVertical(style))
```

é€šè¿‡ä¸Šé¢çš„æ–¹æ³•ä½ å¯ä»¥å®Œæ•´çš„å¤åˆ¶ä¸€ä¸ªexcel

## åŠ¨æ€è½¬æ¢

å¯¼å‡ºæ•°æ®æ—¶ç»å¸¸ä¼šå°†æ•°æ®åº“ä¸€äº›çŠ¶æ€å€¼æšä¸¾å€¼è½¬ä¸ºæ–‡æœ¬è¾“å‡ºåˆ°Excelä¸­ï¼ŒEECæä¾›äº†ä¸€ä¸ªFunctionalInterfaceç±»`ConversionProcessor`ï¼Œåœ¨åˆ›å»ºColumnæ—¶å¯ä»¥åƒè¿™æ · `new Column("çŠ¶æ€", "status", int.class, n -> ApplyStatusEnum.of((int) n).getDesc()`å°†çŠ¶æ€è¿™ä¸€åˆ—çš„æ•°å­—å€¼è½¬ä¸ºçŠ¶æ€æ–‡æœ¬å€¼è¾“å‡ºï¼Œåœ¨v0.5.12ç‰ˆæœ¬ä¸­åˆå¼•å…¥äº†Converteræ¥å£ ä½ å¯ä»¥åœ¨ExcelColumnæ³¨è§£ä¸­ä½¿ç”¨å®ƒï¼Œä¸ConversionProcessorç›¸æ¯”Converteræ˜¯åŒå‘çš„ä»–æä¾›è¾“å‡ºè½¬æ¢`conversion`å’Œè¾“å…¥è½¬æ¢`reversion`

```java
@ExcelColumn
private String name;
@ExcelColumn(converter = StatusConvert.class) // <- æŒ‡å®šçŠ¶æ€ç è½¬æ¢å™¨
private int status;

// è½¬æ¢å™¨å®ç°
public static class StatusConvert implements Converter<Integer> {
    final String[] statusDesc = { "æœªå¼€å§‹", "è¿›è¡Œä¸­", "å®Œç»“", "ä¸­æ­¢" };

    /**
     * Excelè¯»å–çš„æ–‡æœ¬è½¬ä¸ºçŠ¶æ€ç 
     * 
     * @param v ExcelåŸå§‹å€¼
     * @param fieldClazz å¯¼å…¥å¯¹è±¡ä¸­Converteræ ‡è®°çš„å­—æ®µç±»å‹
     * @return çŠ¶æ€ç 
     */
    @Override
    public Integer reversion(String v, Class<?> fieldClazz) {
        for (int i = 0; i < statusDesc.length; i++) {
            if (statusDesc[i].equals(v)) {
                return i;
            }
        }
        return null;
    }

    /**
     * çŠ¶æ€ç è½¬ä¸ºæ–‡æœ¬
     * 
     * @param v åŸå§‹å€¼
     * @return çŠ¶æ€è¯´æ˜
     */
    @Override
    public Object conversion(Object v) {
        return v != null ? statusDesc[(int) v] : null;
    }
}
```

## QAé›†

### å¦‚ä½•è®¾ç½®æ ·å¼

æ ·å¼è®¾ç½®æ”¾åœ¨è¡¨å¤´Columnå¯¹è±¡ä¸Šï¼Œä½¿ç”¨ä»¥ä¸‹`setFont`ï¼Œ`setFill`ï¼Œ`setBorder`ï¼Œ`setNumFmt`ï¼Œ`setVertical`ï¼Œ`setHorizontal`ï¼Œ`setWrapText`7ä¸ªæ–¹æ³•è®¾ç½®å­—ä½“ï¼Œå¡«å……ï¼Œè¾¹æ¡†ï¼Œæ ¼å¼åŒ–ï¼Œå‚ç›´å¯¹é½ï¼Œæ°´å¹³å¯¹é½å’Œè‡ªåŠ¨æŠ˜è¡Œ 7ä¸ªæ ·å¼ï¼Œ ç”±äºEECåŒ…å«è¾¹æ¡†ã€å­—ä½“å’Œæ°´å¹³å¯¹é½3ä¸ªæ‰“åº•æ ·å¼ï¼Œè¦å»é™¤è¿™äº›æ‰“åº•æ ·å¼åˆ™éœ€è¦è®¾ç½®æ–°çš„æ ·å¼æ¥æ›¿æ¢ï¼Œè¾¹æ¡†å¯ä»¥ä½¿ç”¨`new Border()`ç©ºè¾¹æ¡†æ¥æ¸…é™¤

```java
new Workbook()
.setAutoSize(true) // <- è‡ªé€‚åº”åˆ—å®½
.addSheet(new ListSheet<>(randomTestData()
                          , new Column("æ•´å‹", "nv").setNumFmt("#,##0_);[Red]-#,##0_);0_)").setFont(new Font("Bauhaus 93", 16))
                          , new Column("å­—ç¬¦ä¸²(EN)", "sen").setFont(new Font("Trebuchet MS", 20))
                          , new Column("å­—ç¬¦ä¸²(ä¸­æ–‡)", "scn").setFont(new Font("å¾®è½¯é›…é»‘", 8))
                          , new Column("æ—¥æœŸ", "iv").setNumFmt("yyyy-mm-dd hh:mm:ss").setFont(new Font("åæ–‡è¡Œæ¥·", 14))
                         )).writeTo(Paths.get("F:/excel/1.xlsx"));
```

![auto_width2.png](./img/7urPzaZk-WufFtAp/auto_width2-660733.png)![1734274140782-35559966-7cdb-4601-80af-64716953f4da.jpeg](./img/7urPzaZk-WufFtAp/1734274140782-35559966-7cdb-4601-80af-64716953f4da-904502.jpeg)

### å¦‚ä½•å¿½ç•¥è¡¨å¤´

`Sheet#ignoreHeader`å¯å¿½ç•¥è¡¨å¤´

```java
new Workbook()
.addSheet(new EmptySheet().ignoreHeader()) // <- å¿½ç•¥è¡¨å¤´
.writeTo(Paths.get("F:/excel/1.xlsx"));
```

### å¦‚ä½•è¿›è¡Œæ•°æ®è½¬æ¢

ç®€å•è½¬æ¢å¯ä»¥ä½¿ç”¨`ConversionProcessor`ï¼Œå®ƒä»…æœ‰ä¸€ä¸ªå…¥å‚å’Œå‡ºå‚ä½œç”¨äºColumnåˆ—

å¦‚ä¸‹ä»£ç å±•ç¤ºå°†æˆç»©å°äº60åˆ†çš„è½¬æ¢ä¸º"ä¸åˆæ ¼"

```java
new Workbook()
.addSheet(new ListSheet<>(
    new Column("å­¦å·", "id"),
    new Column("å§“å", "name"),
    new Column("æˆç»©", "score", n -> (int) n < 60 ? "ä¸åˆæ ¼" : n)
)).writeTo(Paths.get("F:/excel/1.xlsx"));
```

ConversionProcessoråªæ”¯æŒè¾“å‡ºè½¬æ¢ï¼Œå¦‚æœéœ€è¦è¾“å…¥è½¬æ¢çš„è¯åˆ™éœ€è¦ä½¿ç”¨`Converter`æ¥å£ï¼Œå®ƒå…·æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼šä¸€ä¸ªä¸º`conversion`è¾“å‡ºè½¬æ¢ï¼Œä¸€ä¸ªä¸º`reversion`è¾“å…¥è½¬æ¢

ä¸‹é¢ä»£ç å±•ç¤ºå°†â€œstatusâ€è½¬ä¸ºçŠ¶æ€æ–‡æœ¬ï¼Œå¯¼å…¥æ—¶å°†çŠ¶æ€æ–‡æœ¬è½¬æ¢'status'å€¼

```java
public class Item {
    // è®¾ç½®è½¬æ¢å™¨
    @ExcelColumn(converter = StatusConvert.class)
    private int status;
}

public class StatusConvert implements Converter<Integer> {
    final String[] statusDesc = { "æœªå¼€å§‹", "è¿›è¡Œä¸­", "å®Œç»“", "ä¸­æ­¢" };

    @Override
    public Integer reversion(String v, Class<?> filedClazz) {
        for (int i = 0; i < statusDesc.length; i++) {
            if (statusDesc[i].equals(v)) {
                return i;
            }
        }
        return null;
    }

    @Override
    public Object conversion(Object v) {
        return v != null ? statusDesc[(int) v] : null;
    }
}
```

### å¦‚ä½•è®¾ç½®æ–‘é©¬çº¿

æ–‘é©¬çº¿æœ‰åˆ©äºé˜…è¯»ï¼ŒEECä½¿ç”¨`XMLZebraLineCellValueAndStyle`æ·»åŠ æ–‘é©¬çº¿ï¼Œé™¤è¡¨å¤´å¤–æ¯éš”ä¸€è¡Œè®¾ç½®ä¸€ä¸ªå¡«å……è‰²åšä¸ºæ–‘é©¬çº¿æ ·å¼

å¦‚ä¸‹ç¤ºä¾‹å±•ç¤ºè®¾ç½®æ©™è‰²æ–‘é©¬çº¿

```java
new Workbook()
.addSheet(new ListSheet<>(Item.randomTestData())
          .setCellValueAndStyle(new XMLZebraLineCellValueAndStyle(new Fill(PatternType.solid, Color.orange))))
.writeTo(Paths.get("F:/excel/æ–‘é©¬çº¿.xlsx"));
```

### å¦‚ä½•è®¾ç½®è‡ªé€‚åº”åˆ—å®½

EECæ”¯æŒå·¥ä½œç°¿ã€å·¥ä½œè¡¨å’ŒæŒ‡å®šåˆ—ä¸‰ä¸ªç»´åº¦è®¾ç½®è‡ªé€‚åº”åˆ—å®½ï¼Œå®ƒä»¬çš„å…³é”®è¯éƒ½æ˜¯`AutoSize`

```java
new Workbook()
.setAutoSize(true)   // <- ä½œç”¨äºå·¥ä½œè–„ï¼Œæ‰€æœ‰å·¥ä½œè¡¨éƒ½è‡ªé€‚åº”åˆ—å®½
.addSheet(new EmptySheet())
.addSheet(new EmptySheet())
.writeTo(Paths.get("F:/excel/1.xlsx"));

new Workbook()
.addSheet(new EmptySheet().autoSize()) // <- ä½œç”¨äºå·¥ä½œè¡¨
.writeTo(Paths.get("F:/excel/1.xlsx"));

new Workbook()
.addSheet(new ListSheet<>(
    new Column("å­¦å·", "id"),
    new Column("å§“å", "name").autoSize(), // <- ä½œç”¨æŸä¸€åˆ—
    new Column("æˆç»©", "score"))
         ).writeTo(Paths.get("F:/excel/1.xlsx"));
```

### å¦‚ä½•è®¾ç½®ç¼©æ”¾

ç¼©æ”¾æ˜¯é€šè¿‡æ‰©å±•å‚æ•°è®¾ç½®ï¼Œå¯¹åº”Keyä¸º`Const.ExtendPropertyKey.ZOOM_SCALE`ï¼ŒèŒƒå›´10-400å¯¹åº”ç¼©æ”¾æ¯”ä¾‹10%åˆ°400%

```java
new Workbook()
.addSheet(new EmptySheet().putExtProp(Const.ExtendPropertyKey.ZOOM_SCALE, 70)) // <- è®¾ç½®70%ç¼©æ”¾
.writeTo(Paths.get("F:/excel/1.xlsx"));
```

![1734274152293-de63c0b0-2efe-457c-8edf-e9f6d1c95bb2.jpeg](./img/7urPzaZk-WufFtAp/1734274152293-de63c0b0-2efe-457c-8edf-e9f6d1c95bb2-573907.jpeg)

### æ‰©å±•å‚æ•°è¯´æ˜

ç”±äºç¨‹åºè¶Šå†™è¶Šå¤æ‚ï¼Œå·¥ä½œè¡¨Worksheetæ–°æ·»åŠ åŠŸèƒ½éƒ½éœ€è¦å®šä¹‰æ–°çš„å±æ€§ï¼Œä¸ºäº†é™åˆ¶æ— é™å¢åŠ çš„å±æ€§æ‰€ä»¥å°†è¿™äº›å±æ€§æ”¾åˆ°æ‰©å±•å‚æ•°ä¸­ï¼Œæ‰©å±•å‚æ•°ç”±ä¸€ä¸ªMapç»„æˆï¼Œä½¿ç”¨`putExtProp`è®¾ç½®å±æ€§`getExtPropValue`è·å–æ‰©å±•å±æ€§

å½“å‰å·²æ”¯æŒæ‰©å±•å±æ€§æœ‰

| å±æ€§ | ç”¨é€” | ç±»å‹ |
| --- | --- | --- |
| FREEZE | å†»ç»“çª—æ ¼ | Dimension |
| STYLE_DESIGN | è¿æ€æ ·å¼ | StyleProcessor |
| MERGE_CELLS | åˆå¹¶å•å…ƒæ ¼ | List<Dimension> |
| AUTO_FILTER | ç­›é€‰ | Dimension |
| DATA_VALIDATION | æ•°æ®éªŒè¯ | List<Validation> |
| ZOOM_SCALE | ç¼©æ”¾ | Integer |

### å¯èƒ½å‡ºç°çš„å‡ ç§å¼‚å¸¸

+ java.lang.NoSuchMethodError: org.dom4j.io.SAXReader.createDefault()Lorg/dom4j/io/SAXReader; è¿™ä¸ªå¼‚å¸¸æ˜¯å› ä¸ºdom4jç‰ˆæœ¬ä¸ä¸€è‡´ï¼ŒEECä½¿ç”¨çš„æ˜¯org.dom4j:dom4j:2.1.3ï¼Œå¦‚æœé¡¹ç›®ä¸­å·²å¼•å…¥dom4jåˆ™éœ€è¦æ’é™¤å·²æœ‰çš„ä½ç‰ˆæœ¬dom4jï¼Œä½ç‰ˆæœ¬dom4jå­˜åœ¨XXEå®‰å…¨æ¼æ´ä¸å»ºè®®ä½¿ç”¨

## æŠ¥è¡¨ç±»å¯¼å‡ºæ ·å¼ç¤ºä¾‹

å¾—ç›ŠäºEECçš„æ‰©å±•æ€§ï¼Œå¤„ç†æŠ¥è¡¨ç±»æ ·å¼å¯ä»¥è½»æ¾å®ç°ï¼Œä¸‹é¢å±•ç¤ºå¦‚ä½•ç®€å•åˆ¶ä½œæŠ¥è¡¨

### åˆ†ç»„æ–‘é©¬çº¿

é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªGroupæ¥å£ï¼Œç”¨äºæŒ‡å®šåˆ†ç»„å­—æ®µ

```java
public interface Group {
    String groupBy();
}
```

ç„¶åå†å®šä¹‰ä¸€ä¸ªStyleProcessorç”¨äºå¤„ç†åˆ†ç»„æ–‘é©¬çº¿æ ·å¼

```java
public static class GroupStyleProcessor<U extends Group> implements StyleProcessor<U> {
    private String group;
    private int s, o;
    @Override
    public int build(U u, int style, Styles sst) {
        if (group == null) {
            group = u.groupBy();
            s = sst.addFill(new Fill(PatternType.solid, new Color(239, 245, 235)));
            return style;
        }
        // æ ¹æ®Groupçš„å€¼æ·»åŠ æ–‘é©¬çº¿
        if (u.groupBy() != null && !group.equals(u.groupBy())) {
            group = u.groupBy();
            o ^= 1;
        }
        return o == 1 ? Styles.clearFill(style) | s : style;
    }
}
```

å¯¼å‡ºæ—¶ä½¿ç”¨GroupStyleProcessoræŒ‰è®¢å•å·åˆ†ç»„çš„æ–‘é©¬çº¿

```java
new Workbook().setAutoSize(true)
.addSheet(new ListSheet<>(testData()).setStyleProcessor(new GroupStyleProcessor<>()))
.writeTo(Paths.get("F:/excel"));

public class OrderDetail implements Group {
    ã€‚ã€‚ã€‚å…¶å®ƒå­—æ®µ

    @Override
    public String groupBy() {
        return orderNo;
    }
}
```

åªéœ€è¦è¿™ä¸¤æ­¥æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°å¦‚ä¸‹æ ·å¼ï¼Œæ ¹æ®è®¢å•å·åˆ†ç»„æ–‘é©¬çº¿ï¼Œè¿™ä¸ªæ•ˆæœå¯ä»¥éå¸¸æ˜æ˜¾åŒºåˆ†ä¸åŒè®¢å•çš„å•†å“

![1734274286764-a8ce5d15-0eaa-4ad6-8fc2-ad71e1f83981.jpeg](./img/7urPzaZk-WufFtAp/1734274286764-a8ce5d15-0eaa-4ad6-8fc2-ad71e1f83981-251019.jpeg)

### åˆ†ç»„åˆå¹¶

ä¸Šé¢çš„æ ·å¼è™½ç„¶åŒºåˆ†äº†ä¸åŒçš„è®¢å•ï¼Œæœ‰åˆ©äºå¯¼å…¥åˆ°å…¶å®ƒç³»ç»Ÿï¼Œä½†ä¸ºäº†æ›´èƒ½ä½“ç°**æ¯æ—¥**çš„è®¢å•æˆ‘ä»¬è¿˜éœ€è¦å°†æ—¥æœŸè¿›è¡Œåˆ†ç»„ï¼Œå­¦ä¹ æ›´å¤šå•å…ƒæ ¼åˆå¹¶åŠŸèƒ½è¯·[ç‚¹å‡»è¿™é‡Œ](https://github.com/wangguanquan/eec/wiki/%E5%90%88%E5%B9%B6%E5%8D%95%E5%85%83%E6%A0%BC) ï¼Œå¥½å§ï¼æ¥ç€æ”¹é€ >>>

æˆ‘ä»¬ä¸ºæ¯ä¸ªè®¢å•æ·»åŠ ä¸€ä¸ªå°è®¡ï¼Œç”¨äºè®¢å•å†…å•†å“æ•°é‡å’Œä»·æ ¼åˆè®¡ï¼Œç„¶åæ¯ä¸ªè®¢å•å†…"æ—¥æœŸâ€œã€â€œå®¢æˆ·â€å’Œâ€œå…³è”è®¢å•â€ä¸¤åˆ—åšåˆå¹¶

```java
// ç”¨äºä¿å­˜åˆå¹¶å•å…ƒæ ¼
List<Dimension> mergeCells = new ArrayList<>();
String date = null, order = null;
int row = 2, dateFrom = row, orderFrom = row; // è®°å½•è®¢å•/æ—¥æœŸçš„èµ·å§‹ä½ç½®
E summary = null, allSummary = createSummary();
for (int i = 0, size = list.size(); i < size; ) {
    E e = list.get(i);
    if (!e.orderNo.equals(order)) {
        if (order != null) {
            list.add(i++, summary);
            size++;
            // åˆå¹¶å®¢æˆ·åå’Œè®¢å•å·
            mergeCells.add(new Dimension(orderFrom, (short) 2, row, (short) 2));
            mergeCells.add(new Dimension(orderFrom, (short) 10, row, (short) 10));
            // åˆå¹¶å°è®¡
            mergeCells.add(new Dimension(row, (short) 3, row, (short) 5));
            row++;
        }
        summary = createSummary();
        summary.orderNo = e.orderNo;
        summary.date = e.date;

        order = e.orderNo;
        orderFrom = row;
    } else {
        e.orderNo = null;
        e.customer = null;
    }
    if (!e.date.equals(date)) {
        if (date != null) {
            // åˆå¹¶æ—¥æœŸ
            mergeCells.add(new Dimension(dateFrom, (short) 1, row - 1, (short) 1));
        }
        dateFrom = row;
        date = e.date;
    } else e.date = null;

    // ç´¯è®¡
    summary.num += e.num;
    summary.totalAmount = summary.totalAmount.add(e.totalAmount);

    allSummary.num += e.num;
    allSummary.totalAmount = allSummary.totalAmount.add(e.totalAmount);

    i++;
    row++;
}
// æ·»åŠ æœ€åä¸€ä¸ªè®¢å•å°è®¡ä»¥åŠåˆè®¡æ•°æ®
list.add(summary);
mergeCells.add(new Dimension(dateFrom, (short) 1, row, (short) 1));
mergeCells.add(new Dimension(orderFrom, (short) 2, row, (short) 2));
mergeCells.add(new Dimension(orderFrom, (short) 10, row, (short) 10));
mergeCells.add(new Dimension(row, (short) 3, row, (short) 5));

allSummary.date = "æ€»è®¡ï¼š"; allSummary.productName = null; allSummary.orderNo = "--";
list.add(allSummary);
row++;
mergeCells.add(new Dimension(row, (short) 1, row, (short) 5));
```

ä¸Šé¢çš„ä»£ç å¹¶æ²¡æœ‰ä»€ä¹ˆé€»è¾‘ï¼Œä¸€æ˜¯åˆ¤æ–­è®¢å•ä¸åŒæ—¶è¿½åŠ ä¸€è¡Œå°è®¡ï¼ŒäºŒæ˜¯æ·»åŠ æ—¥æœŸï¼Œå®¢æˆ·å’Œè®¢å•ä¸‰åˆ—çš„åˆå¹¶ã€‚

æœ‰äº†ä¸Šé¢çš„åˆå¹¶å•å…ƒæ ¼æ”¶é›†åæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ åˆ°æ‰©å±•å‚æ•°ä¸­äº†

```java
new Workbook().cancelOddFill().setAutoSize(true)
.addSheet(new ListSheet<>(testData())
          .putExtProp(Const.ExtendPropertyKey.MERGE_CELLS, mergeCells)).writeTo(Paths.get("F:/excel"));
```

ç°åœ¨çš„æ•ˆæœå¦‚ä¸‹ï¼š

![1734274296051-6b70447f-13f3-46d9-a823-ccd2380ac293.jpeg](./img/7urPzaZk-WufFtAp/1734274296051-6b70447f-13f3-46d9-a823-ccd2380ac293-174224.jpeg)

çœ‹ä¸Šå»è¿˜è¡Œï¼Œæœ‰åˆå¹¶å’Œå°è®¡æ•°æ®äº†ï¼Œä½†æ˜¯æ–‘é©¬çº¿å¥½åƒä¸å¤ªå‹å¥½çš„æ ·å­ï¼Œä¸ºäº†ç¾è§‚ä¸‹ä¸€æ­¥æˆ‘ä»¬å»æ‰ç¬¬ä¸€åˆ—çš„æ–‘é©¬çº¿é¢œè‰²ï¼Œå¹¶å°†å°è®¡å­—ä½“åŠ ç²—å¤„ç†ã€‚

ä¸ºäº†æ ‡è®°å°è®¡ï¼Œæˆ‘ä»¬å¢åŠ ä¸€ä¸ªæ¥å£ï¼Œå®šä¹‰å¦‚ä¸‹

```java
public interface Summary {
    default boolean isSummary() {
        return false;
    }
}
```

æ™®é€šè¡ŒisSummaryè¿”å›falseï¼Œå°è®¡è¡Œè¿”å›true

ç„¶åå†å®ç°å°è®¡çš„æ ·å¼

```java
public static class GroupStyleProcessor2<U extends Group & Summary> implements StyleProcessor<U> {
    private String group;
    private int s, o, i;
    @Override
    public int build(U u, int style, Styles sst) {
        if (group == null) {
            group = u.groupBy();
            s = sst.addFill(new Fill(PatternType.solid, new Color(239, 245, 235)));
            return style;
        }
        // å°è®¡åŠ ç²—å­—ä½“
        if (u.isSummary()) {
            Font font = sst.getFont(style).clone();
            font.bold();
            style = Styles.clearFont(style) | sst.addFont(font);
        }
        else if (u.groupBy() != null && !group.equals(u.groupBy())) {
            group = u.groupBy();
            o ^= 1;
            i = 0;
        }
        return o == 1 && ++i > 1 ? Styles.clearFill(style) | s : style;
    }
}
```

ç°åœ¨å®ƒçš„æ•ˆæœæ˜¯è¿™æ ·

![1734274302998-1b0d7c68-3bd6-49c9-a518-40003092df00.jpeg](./img/7urPzaZk-WufFtAp/1734274302998-1b0d7c68-3bd6-49c9-a518-40003092df00-510038.jpeg)

ç°åœ¨ä¸€ä¸ªæ¼‚äº®çš„æŠ¥è¡¨å·²ç»å‘ˆç°ï¼Œæ²¡æœ‰æ¨¡æ¿ä¼¼ä¹ä¹Ÿå¾ˆè½»æ¾ã€‚

## EECä¸E3 supportå…¼å®¹æ€§å¯¹ç…§è¡¨

eecæ”¯æŒxlsxæ ¼å¼è¯»å–/å†™å…¥ï¼Œeec-e3-supportæ”¯æŒxlsæ ¼å¼è¯»å–ï¼Œåè€…ä¾èµ–å‰è€…ï¼Œä½†æ˜¯ä¸¤ä¸ªå·¥å…·ç»å¸¸ä¸åœ¨ä¸€èµ·å‘ç‰ˆï¼Œç‰ˆæœ¬å¯èƒ½å­˜åœ¨ä¸å…¼å®¹çš„æƒ…å†µã€‚

ä¸‹é¢åˆ—å‡ºä¸¤è€…ç›¸äº’å…¼å®¹çš„æ˜ å°„è¡¨

| eec | æ›´æ–°è¯´æ˜ | eec-e3-support |
| --- | --- | --- |
| [0.5.20](https://github.com/wangguanquan/eec/releases/tag/v0.5.20) | 2024-11-13   - æ–°å¢SimpleSheetç®€å•å·¥ä½œè¡¨ï¼Œç®€åŒ–å¯¼å‡ºçš„æ•°æ®æ ¼å¼   - CSVSheetWriteræ–°å¢åˆ†éš”ç¬¦delimiterå±æ€§   - æå‡OpenJDK8-21çš„å…¼å®¹æ€§ | 0.5.19 |
| [0.5.19](https://github.com/wangguanquan/eec/releases/tag/v0.5.19) | 2024-09-22   - æ”¯æŒå¢åŠ è‡ªå®šä¹‰å±æ€§   - æ”¯æŒè®¾ç½®â€œåªè¯»â€æ ‡è¯†ï¼Œè®¾ç½®åªè¯»åæ‰“å¼€Excelåæ— æ³•ç¼–è¾‘   - åˆ é™¤éƒ¨åˆ†å·²æ ‡è®°ä¸ºè¿‡æ—¶çš„æ–¹æ³• | |
| [0.5.18](https://github.com/wangguanquan/eec/releases/tag/v0.5.18) | 2024-08-13   - å¢åŠ CSVSheetçš„å…¼å®¹æ€§, Excelè½¬CSVæ”¯æŒä¿å­˜BOM   - å¢åŠ ResultSetSheetçš„ç±»å‹å…¼å®¹æ€§   - ListMapSheetæ”¯æŒæ³›å‹   - åˆ é™¤I18Nç›¸å…³ä»£ç é™ä½å¤æ‚åº¦   - ç²¾ç®€BloomFilteré™ä½å¤æ‚åº¦ï¼Œç²¾ç®€åä»…æ”¯æŒStringç±»å‹ | 0.5.15 |
| [0.5.17](https://github.com/wangguanquan/eec/releases/tag/v0.5.17) | 2024-07-18   - ä¿®å¤éƒ¨åˆ†æƒ…å†µä¸‹Row#toMapæŠ›ä¸‹æ ‡è¶Šç•Œé—®é¢˜(#380) | |
| [0.5.16](https://github.com/wangguanquan/eec/releases/tag/v0.5.16) | 2024-06-29   - è¾“å…¥è½¬æ¢Converter#reversionå¢åŠ æ•°æ®ç±»å‹æå‡æ‰©å±•æ€§(#376)ï¼Œ [å…¼å®¹é—®é¢˜å‚è€ƒ](./ç‰ˆæœ¬å…¼å®¹æ€§å‡çº§æŒ‡å¼•)   - ä¿®å¤è¯»å–è‡ªå®šä¹‰themeé¢œè‰²ä¼šå‡ºç°åå·®çš„é—®é¢˜ | |
| [0.5.15](https://github.com/wangguanquan/eec/releases/tag/v0.5.15) | 2024-05-21   - ä¿®å¤onProgresså‡ºç°è¶Šç•Œé—®é¢˜   - ä¿®å¤data-supplierè®¡ç®—offsetå‡ºç°åå·®ä½¿å¾—å¯¼å‡ºæ•°æ®ç¼ºå¤±çš„é—®é¢˜   - åˆ é™¤éƒ¨åˆ†å·²æ ‡è®°ä¸ºè¿‡æ—¶çš„æ–¹æ³• | |
| [0.5.14](https://github.com/wangguanquan/eec/releases/tag/v0.5.14) | 2024-04-22   - æ–°å¢æ•°æ®éªŒè¯Validation   - æ–°å¢è¶…é“¾æ¥æ³¨è§£Hyperlink   - æ–°å¢æ¨¡æ¿å·¥ä½œè¡¨TemplateSheet   - æ–°å¢TypeCastExceptionç”¨äºRowè½¬å¯¹è±¡æ—¶å¦‚æœå‡ºç°ç±»å‹è½¬æ¢å¼‚å¸¸æ—¶æºå¸¦è¡Œåˆ—ç­‰ä¿¡æ¯   - ListSheetæ–°å¢data-supplierå‡åŒ–åˆ†ç‰‡å¼€å‘éš¾åº¦   - æ–°å¢zoomScaleæ‰©å±•å±æ€§æ”¯æŒè®¾ç½®å·¥ä½œè¡¨ç¼©æ”¾æ¯”ä¾‹   - ä¿®å¤è¯»å–åŒè‰²å¡«å……æ ·å¼æ—¶æŠ›å¼‚å¸¸ | 0.5.14 |
| [0.5.13](https://github.com/wangguanquan/eec/releases/tag/v0.5.13) | 2024-02-20   - logbackå®‰å…¨æ›´æ–°   - æ–°å¢å…¨å±æ€§å·¥ä½œè¡¨FullSheetä»¥è¯»å–æ›´å¤šå±æ€§ï¼Œå®ƒé›†åˆäº†MergeSheetå’ŒCalcSheetçš„åŠŸèƒ½   - æ–°å¢æ‰©å±•å±æ€§AutoFilterç”¨äºæ·»åŠ åˆ—ç­›é€‰åŠŸèƒ½   - ä¿®å¤ç»§æ‰¿è‡ªListSheetçš„å·¥ä½œè¡¨åˆå§‹æ— æ³•è·å–å¯¹è±¡ç±»å‹å¯¼è‡´å•å…ƒæ ¼ç©ºç™½çš„é—®é¢˜   - ä¿®å¤éƒ¨åˆ†åœºæ™¯ä¸‹è¾¹æ¡†é¢œè‰²æ— æ³•è®¾ç½®çš„é—®é¢˜   - ä¿®å¤éƒ¨åˆ†Excelçš„indexedé¢œè‰²ä¸æ ‡å‡†æœ‰æ‰€ä¸åŒå¯¼è‡´è·å–é¢œè‰²ä¸æ­£ç¡®çš„é—®é¢˜   - ä¿®å¤éƒ¨åˆ†åœºæ™¯è¯»å–Excelå‘ç”ŸIndexOutOfBoundå¼‚å¸¸   - ä¿®å¤HeaderStyleæ³¨è§£è®¾ç½®æ ·å¼æ—¶ï¼Œå­—æ®µæ ·å¼è¢«å…¨å±€æ ·å¼æ›¿æ¢çš„é—®é¢˜ | 0.5.13 |
| [0.5.12](https://github.com/wangguanquan/eec/releases/tag/v0.5.12) | 2023-11-26   - ç§»é™¤watchæ”¹ç”¨slf4jè¾“å‡ºæ—¥å¿—   - æ–°å¢è¿›åº¦çª—å£`onProgress`   - ä¼˜åŒ–è‡ªé€‚åº”åˆ—å®½ç®—æ³•ä½¿å…¶æ”¯æŒæ›´å¤šå­—ä½“å’Œå¤§å°   - æ•°æ®è½¬æ¢å™¨åŠŸèƒ½å¢å¼ºï¼ŒExcelColumnå¢åŠ converterå±æ€§ä»¥æ”¯æŒå¯¼å‡º/å¯¼å…¥æ—¶åŒå‘æ•°æ®è½¬æ¢(#362)   - æ”¯æŒè¯»å–xlsxæ ¼å¼wpsçš„å†…åµŒå›¾ç‰‡(#363)   - **éƒ¨åˆ†ç±»çš„æ³¨é‡Šæ”¹ä¸ºä¸­æ–‡ï¼Œåç»­ä¼šå°†å…¨éƒ¨æ³¨é‡Šæ”¹ä¸ºä¸­æ–‡** | 0.5.12 |
| [0.5.11](https://github.com/wangguanquan/eec/releases/tag/v0.5.11) | 2023-10-08   - ä¼˜åŒ–ExcelReaderæ€§èƒ½   - å¢åŠ `setHeaderColumnReadOption`æ–¹æ³•æé«˜ExcelReaderä¸°å¯Œæ€§   - ä¿®å¤è¯»å–16è¿›åˆ¶è½¬ä¹‰å­—ç¬¦æ—¶å‡ºç°ä¹±ç é—®é¢˜   - ä¿®å¤éæ³•UTF8å­—ç¬¦å¯¼è‡´å†™æ–‡ä»¶å¼‚å¸¸   - æ— æ•°æ®ä¸”èƒ½è·å–è¡¨å¤´ä¿¡æ¯æ—¶æ­£å¸¸å†™è¡¨å¤´(#361)   - å±è”½JDK17ä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨ExcelReaderæŠ›å¼‚å¸¸çš„é—®é¢˜ | 0.5.11 |
| [0.5.10](https://github.com/wangguanquan/eec/releases/tag/v0.5.10) | 2023-08-20   - ä¿®å¤å•å…ƒæ ¼é•¿åº¦è¿‡é•¿å¯¼è‡´å†…å®¹é”™ä½çš„å¼‚å¸¸(#354)   - æ”¯æŒå¯¼å‡ºå›¾ç‰‡ | 0.5.10 |
| [0.5.9](https://github.com/wangguanquan/eec/releases/tag/v0.5.9) | 2023-05-10   - ä¿®å¤dom4jé»˜è®¤æ„é€ å™¨å®¹æ˜“é€ æˆXXEå®‰å…¨æ¼æ´   - v0.5.x å‡çº§åˆ° v0.5.9   - v0.4.x å‡çº§åˆ° v0.4.15 | 0.5.8 |
| [0.5.8](https://github.com/wangguanquan/eec/releases/tag/v0.5.8) | 2023-04-08   - åˆ é™¤éƒ¨åˆ†å·²æ ‡è®°ä¸ºè¿‡æ—¶çš„æ–¹æ³•å’Œç±»ï¼Œå…¼å®¹å¤„ç†è¯·æŸ¥çœ‹[wikiå‡çº§æŒ‡å¼•]   - é‡å‘½åxxOddFillä¸ºxxZebraLine   - ä¿®å¤è‡ªåŠ¨åˆ†é¡µåæ‰“å¼€æ–‡ä»¶å¼¹å‡ºè­¦å‘Š   - å–æ¶ˆé»˜è®¤æ–‘é©¬çº¿ï¼Œå¢åŠ XMLZebraLineCellValueAndStyleè‡ªå®šä¹‰æ–‘é©¬çº¿   - è¡¨å¤´èƒŒæ™¯ä»666699è°ƒæ•´ä¸ºE9EAECï¼Œæ–‘é©¬çº¿é¢œè‰²ä»EFF5EBè°ƒæ•´ä¸ºE9EAEC   - å•ä¸ªColumnå¯ä»¥æŒ‡å®šauto-sizeå±æ€§(#337)   - æä¾›å…¥å£è‡ªå®šä¹‰å¤„ç†æœªçŸ¥çš„æ•°æ®ç±»å‹   - å¯¼å‡ºæ•°æ®æ”¯æŒæŒ‡å®šèµ·å§‹è¡Œå·(#345)   - ä¿®å¤xlsè§£æRK Valueä¸¢å¤±ç²¾åº¦é—®é¢˜   - ä¿®å¤éƒ¨åˆ†å·²çŸ¥BUG(#334, #342, #346) | |
| [0.5.7](https://github.com/wangguanquan/eec/releases/tag/v0.5.7) | 2023-02-17   - ä¿®å¤è¯»å–font-sizeæ—¶å› ä¸ºæµ®ç‚¹æ•°é€ æˆå¼‚å¸¸   - ä¿®å¤auto-sizeé‡ç½®åˆ—å®½æ—¶æŠ›Bufferå¼‚å¸¸   - æ–°å¢ #setRowHeight, #setHeaderRowHeight æ–¹æ³•è®¾ç½®è¡Œé«˜ | 0.5.6 |
| [0.5.6](https://github.com/wangguanquan/eec/releases/tag/v0.5.6) | 2023-01-07   - è¯»å–æ–‡ä»¶æ—¶æ”¯æŒæŒ‡å®šè¡¨å¤´ï¼Œå¯¹äºå¤šè¡Œè¡¨å¤´å°¤ä¸ºæœ‰æ•ˆ   - æä¾›Row#toMapæ–¹æ³•å°†è¡Œæ•°æ®è½¬ä¸ºLinkedHashMap(#294)   - æä¾›Row#isBlankæ–¹æ³•ç”¨äºåˆ¤æ–­æ‰€æœ‰å•å…ƒæ ¼çš„å€¼æ˜¯å¦ä¸ºç©º(#314)   - è¯»å–æ–‡ä»¶è½¬æ—¶æ”¯æŒè‡ªå®šä¹‰HeaderRow   - è¯»æ–‡ä»¶æ—¶æ”¯æŒè·å–å•å…ƒæ ¼æ ·å¼   - ä¿®å¤éƒ¨åˆ†BUG(#308, #320, #323) | |
| [0.5.5](https://github.com/wangguanquan/eec/releases/tag/v0.5.5) | 2022-11-07   - Rowè½¬å¯¹è±¡æ—¶å¦‚æœå‡ºå¼‚å¸¸å°†æç¤ºå…·ä½“çš„è¡Œå’Œåˆ—ä¿¡æ¯(#284)   - å¯¼å‡ºç»“æŸååˆ é™¤zipåŒ…(#296)   - ä¿®å¤éƒ¨åˆ†BUG(#297,#298)    | 0.5.4 |
| [0.5.4](https://github.com/wangguanquan/eec/releases/tag/v0.5.4) | 2022-08-28   - æ”¯æŒæ˜¾ç¤º/éšè—ç½‘ç»œçº¿   - æ”¯æŒæ˜¾ç¤º/éšè—æŒ‡å®šåˆ—   - å­—ä½“å¢åŠ "åˆ é™¤çº¿"æ ·å¼   - Commentå¢åŠ widthå’Œheightä¸¤å±æ€§ï¼Œç”¨äºè°ƒæ•´æ‰¹æ³¨å¤§å°   - BIFF8Sheetæ”¯æŒreseté‡ç½®æµç”¨äºåå¤è¯»å–   - ä¿®å¤éƒ¨åˆ†BUG(#282,#285) | |
| [0.5.3](https://github.com/wangguanquan/eec/releases/tag/v0.5.3) | 2022-07-25   - ä¿®å¤å¯¼å‡ºæ—¶æ—¥æœŸå°‘6å¤©çš„é—®é¢˜(#269)   - æ”¯æŒå¤šä¸ªExcelColumnæ³¨è§£ï¼Œå¯ä»¥å®ç°å¤šè¡Œè¡¨å¤´(#210)   - å¾®è°ƒè¡¨æ ¼æ ·å¼ä½¿å…¶æ›´çªå‡ºå†…å®¹   - ä¼˜åŒ–è‡ªåŠ¨è®¡ç®—åˆ—å®½çš„ç®—æ³•ä½¿å…¶æ›´ç²¾å‡†   - ä¿®å¤éƒ¨åˆ†BUG(#264,#265) | 0.5.0 |
| [0.5.2](https://github.com/wangguanquan/eec/releases/tag/v0.5.2) | 2022-07-16   - (ä¸¥é‡)ä¿®å¤å•å…ƒæ ¼å­—èŠ‚è¶…è¿‡1kæ—¶å¯¼è‡´SSTç´¢å¼•è¯»å–æ­»å¾ªç¯é—®é¢˜(#258)   - StatementSheet&ResultSetSheetæ·»åŠ StyleProcessor   å®ç°æ•´è¡Œæ ·å¼è°ƒæ•´(#235)   - ä¿®å¤éƒ¨åˆ†BUG(#257, #260) | |
| [0.5.1](https://github.com/wangguanquan/eec/releases/tag/v0.5.1) | 2022-07-10   - æå‡å¯¹éæ ‡å‡†Office OpenXMLç”Ÿæˆçš„excelè¯»å–å…¼å®¹æ€§(#245, #247)   - æå‡è¯»å–Excelæ—¶Rowè½¬Javaå¯¹è±¡çš„å…¼å®¹æ€§(#254)   - ä¿®å¤éƒ¨åˆ†BUG(#249, #252) | |
| [0.5.0](https://github.com/wangguanquan/eec/releases/tag/v0.5.0) | 2022-05-22   - å¢åŠ StyleDesignç”¨äºæ ·å¼å¤„ç†ï¼ˆå•å…ƒæ ¼æˆ–è€…æ•´è¡Œæ ·å¼å¤„ç†ï¼‰   - å¢åŠ FreezePanesç”¨äºå†»ç»“ç½‘æ ¼   - ä¿®æ”¹éƒ¨åˆ†BUG(#227,#232,#238,#243)   - è¯»å–æ–‡ä»¶æ”¯æŒè‡ªå®šä¹‰æ³¨è§£è½¬å¯¹è±¡(#237) | |
| [0.4.14](https://github.com/wangguanquan/eec/releases/tag/v0.4.14) | 2021-12-19   - æé«˜å¯¹Numbersè½¬xlsxçš„å…¼å®¹æ€§   - å€¼è½¬æ¢ä»åŸæ¥çš„intç±»å‹æ‰©å¤§ä¸ºObject   - å¢åŠ @RowNumæ³¨è§£ï¼Œç”¨äºæ³¨å…¥è¡Œå·   - ä¿®æ”¹ListSheet.EntryColumnçš„è®¿é—®æƒé™ï¼Œæ–¹ä¾¿å®ç°æ›´å¤šé«˜çº§ç‰¹æ€§   - æ”¯æŒå•åˆ—æ•°å­—æ— è¡¨å¤´å¯¼å‡ºï¼Œç°åœ¨å¯ä»¥ç®€å•çš„å¯¼å‡º`List`æ•°æ®   - ä¿®å¤å·²çŸ¥BUG(#197,#202ï¼Œ#205,#219)   - å°†com.google.commonåŒ…é‡å‘½åä¸º   org.ttzero.excel.commonè§£å†³å†…åµŒå¼•èµ·çš„åŒ…å†²çª(#200) | 0.4.13 |
| [0.4.13](https://github.com/wangguanquan/eec/releases/tag/v0.4.13) | 2021-08-09   - æ”¯æŒxlsè·å–å›¾ç‰‡   - `@ExcelColumn`æ³¨è§£å¢åŠ `colIndex`å±æ€§ï¼Œç”¨äºæŒ‡å®šåˆ—é¡ºåº(#188)   - è¯»å–æ–‡ä»¶æ—¶`Worksheet#getIndex()`è¿”å›Sheetåœ¨æ–‡ä»¶ä¸­çš„ä¸‹æ ‡è€Œéid(#193)   - ä¿®å¤éƒ¨åˆ†BUG(#182,#190) | |
| [0.4.12.1](https://github.com/wangguanquan/eec/releases/tag/v0.4.12.1) | 2021-05-20   - Hotfixï¼šHeaderStyleæ³¨è§£è®¾ç½®æŸåˆ—cellé¢œè‰²ä¼šå½±å“æ‰€æœ‰è¡¨å¤´æ ·å¼ | 0.4.11 |
| [0.4.12](https://github.com/wangguanquan/eec/releases/tag/v0.4.12) | 2021-05-18   - å¢åŠ è·å–å›¾ç‰‡åŠŸèƒ½(#168)   - æ”¯æŒrow()æ–¹æ³•è½¬å¯¹è±¡(#175)   - è¯»å–æ–‡ä»¶é»˜è®¤ä½¿ç”¨åŒ…è£…ç±»è€ŒéåŸºæœ¬ç±»å‹ï¼Œä¸ºäº†æ–¹ä¾¿å¤„ç†Nullç±»å‹(#177)   - å¢åŠ `@HeaderStyle`æ³¨è§£è‡ªå®šä¹‰å¤´éƒ¨æ ·å¼ | |
| [0.4.11](https://github.com/wangguanquan/eec/releases/tag/v0.4.11) | 2021-03-28   - ä¿®å¤å¯¼å‡ºæ—¶åˆ é™¤ç‰¹æ®Šå­—ç¬¦çš„é—®é¢˜   - å¢åŠ wrapTextå±æ€§æ§åˆ¶å•å…ƒæ ¼è‡ªåŠ¨æ¢è¡Œ   - å¢åŠ forceExportå±æ€§æ¥å¼ºåˆ¶æ²¡æœ‰@ExcelColumnæ³¨è§£çš„å±æ€§   - å…¼å®¹éæ ‡å‡†åŒ–BOFè®°å½•è§£æ   - ä¼˜åŒ–short-sectorè§£æ   - æå¤§æå‡è¯»å–xlså…¼å®¹æ€§   - å¢åŠ å¯¹EXTSSTçš„è§£æ | |
| [0.4.10](https://github.com/wangguanquan/eec/releases/tag/v0.4.10) | 2021-01-07   - å¢åŠ å…¼å®¹æ€§ï¼ˆOffice for Macï¼‰   - ä¿®å¤éƒ¨åˆ†BUG(#147,#148,#159,#161) | 0.4.10 |
| [0.4.9](https://github.com/wangguanquan/eec/releases/tag/v0.4.9) | 2020-11-15   - ä¿®å¤è¯»å–æ–‡ä»¶æ—¶çš„BUG(#146)   - å¢åŠ è¯»å–é«˜ç‰ˆæœ¬Officeå¯¼å‡ºçš„xlsæ–‡ä»¶æ ¼å¼çš„å…¼å®¹æ€§ | 0.4.9 |
| [0.4.8](https://github.com/wangguanquan/eec/releases/tag/v0.4.8) | 2020-10-09   - ExcelColumnæ³¨è§£å¢åŠ formatå±æ€§æ¥æ”¯æŒè‡ªå®šä¹‰å•å…ƒæ ¼æ ¼å¼åŒ–   - ä¸ºå‡å°‘æ•°æ®æ³„éœ²é£é™©ï¼Œç°åœ¨å¯¹è±¡å±æ€§å¿…é¡»æ˜ç¡®æŒ‡å®š   ExcelColumnæ³¨è§£æ‰ä¼šè¢«å¯¼å‡º | 0.4.6 |
| [0.4.7](https://github.com/wangguanquan/eec/releases/tag/v0.4.7) | 2020-08-14   - å®‰å…¨æ›´æ–°ï¼Œä¿®å¤dom4jå°äº2.1.3ç‰ˆæœ¬å¯èƒ½å¯ç”¨XXEæ”»å‡»ã€‚   - ExcelColumnæ³¨è§£å¢åŠ commentå±æ€§ï¼Œå…è®¸åœ¨Excelåˆ—å¤´æ·»åŠ â€œæ‰¹æ³¨â€åŠŸèƒ½   - ä¿®å¤ä¸€äº›å·²çŸ¥BUG | |
| [0.4.6](https://github.com/wangguanquan/eec/releases/tag/v0.4.4) | 2020-04-20   - ä¼˜åŒ–SharedStringTable   - æ”¯æŒè¯»å–Excel97~2003æ–‡ä»¶(éœ€è¦ä¾æ‡’eec-e3-support)   - ä¿®å¤ä¸€äº›å·²çŸ¥BUG | |
